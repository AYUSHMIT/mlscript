<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="index.css">
    <title>MLscript demonstration</title>
  </head>
  <body>
  <h1>MLscript demonstration</h1>
  <div id="content">
    <textarea id="mlscript-input" class="panel" spellcheck="false">
class Add[E](lhs: E, rhs: E)
class Lit(n: int)
class Neg[E](expr: E)

let add11 = Add(Lit(1), Lit(2))
let add2negadd11 = Add(Lit(2), Neg(add11))

mixin EvalNothing {
  fun eval(e: nothing) = e
}
mixin EvalAddLit {
  fun eval(e) =
    if e is
      Lit(n) then n
      Add(l, r) then this.eval(l) + this.eval(r)
    else super.eval(e)
}
mixin EvalNeg {
  fun eval(e) =
    if e is Neg(d) then 0 - this.eval(d)
    else super.eval(e)
}

module TestLang: EvalNothing, EvalAddLit, EvalNeg

let res = TestLang.eval(add2negadd11)
</textarea>
    <div id="mlscript-output" class="panel"></div>
  </div>
  <script type="text/javascript" src="js/target/scala-2.13/mlscript-fastopt/main.js"></script>
  <br/>
  <!-- <p>The code is available TODO.</p> -->
  <br/>

  <h3>Tip: additional definitions from the paper â€“ copy and paste to try them out:</h3>
  <div class="panel">
mixin EvalMul {<br/>
&nbsp;&nbsp;fun eval(e) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if e is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mul(l, r) then this.eval(l) * this.eval(r)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;else super.eval(e)<br/>
}<br/>
mixin EvalNegNeg {<br/>
&nbsp;&nbsp;fun eval(e) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if e is Neg(Neg(d)) then this.eval(d)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;else super.eval(e)<br/>
}<br/>
<br/>
module TestLang2: EvalNothing, EvalAddLit, EvalNeg, EvalMul, EvalNegNeg<br/>
<br/>
let res2 = TestLang2.eval(add2negadd11)
  </div>


</html>
