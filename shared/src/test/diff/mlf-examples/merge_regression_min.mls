:DontGeneralizeCurriedFunctions


def choose: 'a -> 'a -> 'a
//│ choose: 'a -> 'a -> 'a
//│       = <missing implementation>

rec def id1 x = choose x (id1 id1 x)
//│ id1: 'id1
//│   where
//│     'id1 :> 'a -> 'b
//│     'a :> 'id1
//│        <: 'b
//│     'b :> 'id1
//│        <: 'a -> 'b
//│    = <no result>
//│      choose is not implemented

id1 id
//│ res: ('a & 'b) -> 'b | 'c
//│   where
//│     'a :> ('a & 'b) -> 'b
//│        <: 'b
//│     'b :> ('a & 'b) -> 'b
//│        <: 'a -> 'b & 'c
//│    = <no result>
//│      id1 and choose are not implemented


:GeneralizeCurriedFunctions

id1 id
//│ res: ('a & 'b) -> 'b | 'c
//│   where
//│     'a :> ('a & 'b) -> 'b
//│        <: 'b
//│     'b :> ('a & 'b) -> 'b
//│        <: 'a -> 'b & 'c
//│    = <no result>
//│      id1 and choose are not implemented

rec def id1 x = choose x (id1 id1 x)
//│ id1: 'id1
//│   where
//│     'id1 :> forall 'a. ('a & 'b) -> 'a
//│     'a :> 'c
//│     'c :> 'id1
//│        <: 'b -> 'c
//│     'b :> 'id1
//│        <: 'c
//│    = <no result>
//│      choose is not implemented

:e
id1 id
//│ ╔══[ERROR] Cyclic-looking constraint while typing application; a type annotation may be required
//│ ║  l.55: 	id1 id
//│ ║        	^^^^^^
//│ ╙── Note: use flag `:ex` to see internal error info.
//│ res: ('a & 'b) -> 'a | error | 'c
//│   where
//│     'a :> 'd
//│     'd :> forall 'a 'b. ('a & 'b) -> 'a
//│        <: 'e -> 'd & 'c
//│     'b <: 'a & 'e
//│     'e :> forall 'a 'b. ('a & 'b) -> 'a
//│        <: 'd
//│    = <no result>
//│      id1 and choose are not implemented

