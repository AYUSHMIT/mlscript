:GeneralizeCurriedFunctions

// ============ Dummy classes to represent the types in the examples ============

class List[a]
  method Head: a
  method Tail: List[a]
//│ Defined class List[+a]
//│ Declared List.Head: List['a] -> 'a
//│ Declared List.Tail: List['a] -> List['a]

class Cons[a]: List[a] & { head: a; tail: List[a] }
  method Head = this.head
  method Tail = this.tail
def cons[a]: a -> List[a] -> List[a]
def cons head tail = Cons { head; tail }
//│ Defined class Cons[+a]
//│ Defined Cons.Head: Cons['a] -> 'a
//│ Defined Cons.Tail: Cons['a] -> List['a]
//│ cons: 'a -> List['a] -> List['a]
//│     = <missing implementation>
//│ 'b -> (forall 'a, 'tail. (List['a] & 'tail) -> (Cons['a | 'b] with {head: 'b, tail: 'tail}))
//│   <:  cons:
//│ 'a -> List['a] -> List['a]
//│     = [Function: cons]

class Nil[a]: List[a]
  method Head = error
  method Tail = this
def nil: List['a]
def nil = Nil {}
//│ Defined class Nil[+a]
//│ Defined Nil.Head: Nil[?] -> nothing
//│ Defined Nil.Tail: (Nil['a] & 'this) -> (Nil['a] & 'this)
//│ nil: List[nothing]
//│    = <missing implementation>
//│ Nil[nothing]
//│   <:  nil:
//│ List[nothing]
//│    = Nil {}

// ============ Type signatures for functions used in the examples ============

def head: forall 'a. List['a] -> 'a
def head l = l.Head
//│ head: List['a] -> 'a
//│     = <missing implementation>
//│ List['a] -> 'a
//│   <:  head:
//│ List['a] -> 'a
//│     = [Function: head]

def tail: forall 'a. List['a] -> List['a]
def tail l = l.Tail
//│ tail: List['a] -> List['a]
//│     = <missing implementation>
//│ List['a] -> List['a]
//│   <:  tail:
//│ List['a] -> List['a]
//│     = [Function: tail]

def is_empty: forall 'a. List['a] -> bool
def is_empty l = eq l nil
//│ is_empty: List[?] -> bool
//│         = <missing implementation>
//│ anything -> bool
//│   <:  is_empty:
//│ List[?] -> bool
//│         = [Function: is_empty]



// (* Use the value restriction ! *)

// type option ('a) = None | Some of 'a
class None
class Some[a]: { val: a }
type Option[a] = None | Some[a]
def None = None {}
def Some val = Some { val }
//│ Defined class None
//│ Defined class Some[+a]
//│ Defined type alias Option[+a]
//│ None: None
//│     = None {}
//│ Some: 'val -> Some['val]
//│     = [Function: Some1]

// let create_hashtbl () = []
def create_hashtbl _ = nil
//│ create_hashtbl: anything -> List[nothing]
//│               = [Function: create_hashtbl]

// let hashtbl_add table key element = (key, element) :: table
def hashtbl_add table key element = cons ((key, element)) table
//│ hashtbl_add: 'a -> (forall 'b. 'b -> (forall 'b, 'c, 'd. ('d -> List[('b, 'd,) | 'c]
//│   where
//│     'a <: List['c])))
//│            = [Function: hashtbl_add]

// let rec find table key = 
//   if nil table then None
//   else if fst (car table) = key then Some (snd (car table))
//   else find (cdr table) key
rec def find table key =
  if is_empty table then None
  else if eq (head table)._1 key then Some (head table)._2
  else find (tail table) key
//│ find: 'a -> (forall 'a, 'val, 'b, 'c. ('b -> (None | Some['val] | 'c)
//│   where
//│     'a <: List['a] & List[{_1: 'a}] & List[{_2: 'val}]
//│     'd <: 'b -> 'c))
//│     = [Function: find]


// let nfind table key =
//   begin match find table key with
//   | None -> fun f x -> x
//   | Some n -> n
//   end
def nfind table key =
  let opt = find table key in
  case opt of
  { None -> fun f -> fun x -> x
  | Some -> opt.val
  }
//│ ╔══[ERROR] Subtyping constraint of the form `?a <: ?b -> ?c` exceeded recursion depth limit (400)
//│ ║  l.122: 	  let opt = find table key in
//│ ║         	            ^^^^^^^^^^^^^^
//│ ╟── while constraining:  {(α2926'''' -> α2931'''') where: α280'' <: List['a2913''''], α280'' <: List['a2914''''], α280'' <: List['a2918''''], α280'' <: List['a2924''''], α2912'''' <: ((α2926'''',) -> α2927'''')}  <!<  ((α2893'''',) -> α2894'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2893'''',) -> α2894'''')
//│ ╟── while constraining:  α2879''''  <!<  ((α2893'''',) -> α2894'''')
//│ ╟── while constraining:  {(α2893'''' -> α2898'''') where: α280'' <: List['a2880''''], α280'' <: List['a2881''''], α280'' <: List['a2885''''], α280'' <: List['a2891''''], α2879'''' <: ((α2893'''',) -> α2894'''')}  <!<  ((α2860'''',) -> α2861'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2860'''',) -> α2861'''')
//│ ╟── while constraining:  α2846''''  <!<  ((α2860'''',) -> α2861'''')
//│ ╟── while constraining:  {(α2860'''' -> α2865'''') where: α280'' <: List['a2847''''], α280'' <: List['a2848''''], α280'' <: List['a2852''''], α280'' <: List['a2858''''], α2846'''' <: ((α2860'''',) -> α2861'''')}  <!<  ((α2827'''',) -> α2828'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2827'''',) -> α2828'''')
//│ ╟── while constraining:  α2813''''  <!<  ((α2827'''',) -> α2828'''')
//│ ╟── while constraining:  {(α2827'''' -> α2832'''') where: α280'' <: List['a2814''''], α280'' <: List['a2815''''], α280'' <: List['a2819''''], α280'' <: List['a2825''''], α2813'''' <: ((α2827'''',) -> α2828'''')}  <!<  ((α2794'''',) -> α2795'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2794'''',) -> α2795'''')
//│ ╟── while constraining:  α2780''''  <!<  ((α2794'''',) -> α2795'''')
//│ ╟── while constraining:  {(α2794'''' -> α2799'''') where: α280'' <: List['a2781''''], α280'' <: List['a2782''''], α280'' <: List['a2786''''], α280'' <: List['a2792''''], α2780'''' <: ((α2794'''',) -> α2795'''')}  <!<  ((α2761'''',) -> α2762'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2761'''',) -> α2762'''')
//│ ╟── while constraining:  α2747''''  <!<  ((α2761'''',) -> α2762'''')
//│ ╟── while constraining:  {(α2761'''' -> α2766'''') where: α280'' <: List['a2748''''], α280'' <: List['a2749''''], α280'' <: List['a2753''''], α280'' <: List['a2759''''], α2747'''' <: ((α2761'''',) -> α2762'''')}  <!<  ((α2728'''',) -> α2729'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2728'''',) -> α2729'''')
//│ ╟── while constraining:  α2714''''  <!<  ((α2728'''',) -> α2729'''')
//│ ╟── while constraining:  {(α2728'''' -> α2733'''') where: α280'' <: List['a2715''''], α280'' <: List['a2716''''], α280'' <: List['a2720''''], α280'' <: List['a2726''''], α2714'''' <: ((α2728'''',) -> α2729'''')}  <!<  ((α2695'''',) -> α2696'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2695'''',) -> α2696'''')
//│ ╟── while constraining:  α2681''''  <!<  ((α2695'''',) -> α2696'''')
//│ ╟── while constraining:  {(α2695'''' -> α2700'''') where: α280'' <: List['a2682''''], α280'' <: List['a2683''''], α280'' <: List['a2687''''], α280'' <: List['a2693''''], α2681'''' <: ((α2695'''',) -> α2696'''')}  <!<  ((α2662'''',) -> α2663'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2662'''',) -> α2663'''')
//│ ╟── while constraining:  α2648''''  <!<  ((α2662'''',) -> α2663'''')
//│ ╟── while constraining:  {(α2662'''' -> α2667'''') where: α280'' <: List['a2649''''], α280'' <: List['a2650''''], α280'' <: List['a2654''''], α280'' <: List['a2660''''], α2648'''' <: ((α2662'''',) -> α2663'''')}  <!<  ((α2629'''',) -> α2630'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2629'''',) -> α2630'''')
//│ ╟── while constraining:  α2615''''  <!<  ((α2629'''',) -> α2630'''')
//│ ╟── while constraining:  {(α2629'''' -> α2634'''') where: α280'' <: List['a2616''''], α280'' <: List['a2617''''], α280'' <: List['a2621''''], α280'' <: List['a2627''''], α2615'''' <: ((α2629'''',) -> α2630'''')}  <!<  ((α2596'''',) -> α2597'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2596'''',) -> α2597'''')
//│ ╟── while constraining:  α2582''''  <!<  ((α2596'''',) -> α2597'''')
//│ ╟── while constraining:  {(α2596'''' -> α2601'''') where: α280'' <: List['a2583''''], α280'' <: List['a2584''''], α280'' <: List['a2588''''], α280'' <: List['a2594''''], α2582'''' <: ((α2596'''',) -> α2597'''')}  <!<  ((α2563'''',) -> α2564'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2563'''',) -> α2564'''')
//│ ╟── while constraining:  α2549''''  <!<  ((α2563'''',) -> α2564'''')
//│ ╟── while constraining:  {(α2563'''' -> α2568'''') where: α280'' <: List['a2550''''], α280'' <: List['a2551''''], α280'' <: List['a2555''''], α280'' <: List['a2561''''], α2549'''' <: ((α2563'''',) -> α2564'''')}  <!<  ((α2530'''',) -> α2531'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2530'''',) -> α2531'''')
//│ ╟── while constraining:  α2516''''  <!<  ((α2530'''',) -> α2531'''')
//│ ╟── while constraining:  {(α2530'''' -> α2535'''') where: α280'' <: List['a2517''''], α280'' <: List['a2518''''], α280'' <: List['a2522''''], α280'' <: List['a2528''''], α2516'''' <: ((α2530'''',) -> α2531'''')}  <!<  ((α2497'''',) -> α2498'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2497'''',) -> α2498'''')
//│ ╟── while constraining:  α2483''''  <!<  ((α2497'''',) -> α2498'''')
//│ ╟── while constraining:  {(α2497'''' -> α2502'''') where: α280'' <: List['a2484''''], α280'' <: List['a2485''''], α280'' <: List['a2489''''], α280'' <: List['a2495''''], α2483'''' <: ((α2497'''',) -> α2498'''')}  <!<  ((α2464'''',) -> α2465'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2464'''',) -> α2465'''')
//│ ╟── while constraining:  α2450''''  <!<  ((α2464'''',) -> α2465'''')
//│ ╟── while constraining:  {(α2464'''' -> α2469'''') where: α280'' <: List['a2451''''], α280'' <: List['a2452''''], α280'' <: List['a2456''''], α280'' <: List['a2462''''], α2450'''' <: ((α2464'''',) -> α2465'''')}  <!<  ((α2431'''',) -> α2432'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2431'''',) -> α2432'''')
//│ ╟── while constraining:  α2417''''  <!<  ((α2431'''',) -> α2432'''')
//│ ╟── while constraining:  {(α2431'''' -> α2436'''') where: α280'' <: List['a2418''''], α280'' <: List['a2419''''], α280'' <: List['a2423''''], α280'' <: List['a2429''''], α2417'''' <: ((α2431'''',) -> α2432'''')}  <!<  ((α2398'''',) -> α2399'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2398'''',) -> α2399'''')
//│ ╟── while constraining:  α2384''''  <!<  ((α2398'''',) -> α2399'''')
//│ ╟── while constraining:  {(α2398'''' -> α2403'''') where: α280'' <: List['a2385''''], α280'' <: List['a2386''''], α280'' <: List['a2390''''], α280'' <: List['a2396''''], α2384'''' <: ((α2398'''',) -> α2399'''')}  <!<  ((α2365'''',) -> α2366'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2365'''',) -> α2366'''')
//│ ╟── while constraining:  α2351''''  <!<  ((α2365'''',) -> α2366'''')
//│ ╟── while constraining:  {(α2365'''' -> α2370'''') where: α280'' <: List['a2352''''], α280'' <: List['a2353''''], α280'' <: List['a2357''''], α280'' <: List['a2363''''], α2351'''' <: ((α2365'''',) -> α2366'''')}  <!<  ((α2332'''',) -> α2333'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2332'''',) -> α2333'''')
//│ ╟── while constraining:  α2318''''  <!<  ((α2332'''',) -> α2333'''')
//│ ╟── while constraining:  {(α2332'''' -> α2337'''') where: α280'' <: List['a2319''''], α280'' <: List['a2320''''], α280'' <: List['a2324''''], α280'' <: List['a2330''''], α2318'''' <: ((α2332'''',) -> α2333'''')}  <!<  ((α2299'''',) -> α2300'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2299'''',) -> α2300'''')
//│ ╟── while constraining:  α2285''''  <!<  ((α2299'''',) -> α2300'''')
//│ ╟── while constraining:  {(α2299'''' -> α2304'''') where: α280'' <: List['a2286''''], α280'' <: List['a2287''''], α280'' <: List['a2291''''], α280'' <: List['a2297''''], α2285'''' <: ((α2299'''',) -> α2300'''')}  <!<  ((α2266'''',) -> α2267'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2266'''',) -> α2267'''')
//│ ╟── while constraining:  α2252''''  <!<  ((α2266'''',) -> α2267'''')
//│ ╟── while constraining:  {(α2266'''' -> α2271'''') where: α280'' <: List['a2253''''], α280'' <: List['a2254''''], α280'' <: List['a2258''''], α280'' <: List['a2264''''], α2252'''' <: ((α2266'''',) -> α2267'''')}  <!<  ((α2233'''',) -> α2234'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2233'''',) -> α2234'''')
//│ ╟── while constraining:  α2219''''  <!<  ((α2233'''',) -> α2234'''')
//│ ╟── while constraining:  {(α2233'''' -> α2238'''') where: α280'' <: List['a2220''''], α280'' <: List['a2221''''], α280'' <: List['a2225''''], α280'' <: List['a2231''''], α2219'''' <: ((α2233'''',) -> α2234'''')}  <!<  ((α2200'''',) -> α2201'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2200'''',) -> α2201'''')
//│ ╟── while constraining:  α2186''''  <!<  ((α2200'''',) -> α2201'''')
//│ ╟── while constraining:  {(α2200'''' -> α2205'''') where: α280'' <: List['a2187''''], α280'' <: List['a2188''''], α280'' <: List['a2192''''], α280'' <: List['a2198''''], α2186'''' <: ((α2200'''',) -> α2201'''')}  <!<  ((α2167'''',) -> α2168'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2167'''',) -> α2168'''')
//│ ╟── while constraining:  α2153''''  <!<  ((α2167'''',) -> α2168'''')
//│ ╟── while constraining:  {(α2167'''' -> α2172'''') where: α280'' <: List['a2154''''], α280'' <: List['a2155''''], α280'' <: List['a2159''''], α280'' <: List['a2165''''], α2153'''' <: ((α2167'''',) -> α2168'''')}  <!<  ((α2134'''',) -> α2135'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2134'''',) -> α2135'''')
//│ ╟── while constraining:  α2120''''  <!<  ((α2134'''',) -> α2135'''')
//│ ╟── while constraining:  {(α2134'''' -> α2139'''') where: α280'' <: List['a2121''''], α280'' <: List['a2122''''], α280'' <: List['a2126''''], α280'' <: List['a2132''''], α2120'''' <: ((α2134'''',) -> α2135'''')}  <!<  ((α2101'''',) -> α2102'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2101'''',) -> α2102'''')
//│ ╟── while constraining:  α2087''''  <!<  ((α2101'''',) -> α2102'''')
//│ ╟── while constraining:  {(α2101'''' -> α2106'''') where: α280'' <: List['a2088''''], α280'' <: List['a2089''''], α280'' <: List['a2093''''], α280'' <: List['a2099''''], α2087'''' <: ((α2101'''',) -> α2102'''')}  <!<  ((α2068'''',) -> α2069'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2068'''',) -> α2069'''')
//│ ╟── while constraining:  α2054''''  <!<  ((α2068'''',) -> α2069'''')
//│ ╟── while constraining:  {(α2068'''' -> α2073'''') where: α280'' <: List['a2055''''], α280'' <: List['a2056''''], α280'' <: List['a2060''''], α280'' <: List['a2066''''], α2054'''' <: ((α2068'''',) -> α2069'''')}  <!<  ((α2035'''',) -> α2036'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2035'''',) -> α2036'''')
//│ ╟── while constraining:  α2021''''  <!<  ((α2035'''',) -> α2036'''')
//│ ╟── while constraining:  {(α2035'''' -> α2040'''') where: α280'' <: List['a2022''''], α280'' <: List['a2023''''], α280'' <: List['a2027''''], α280'' <: List['a2033''''], α2021'''' <: ((α2035'''',) -> α2036'''')}  <!<  ((α2002'''',) -> α2003'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α2002'''',) -> α2003'''')
//│ ╟── while constraining:  α1988''''  <!<  ((α2002'''',) -> α2003'''')
//│ ╟── while constraining:  {(α2002'''' -> α2007'''') where: α280'' <: List['a1989''''], α280'' <: List['a1990''''], α280'' <: List['a1994''''], α280'' <: List['a2000''''], α1988'''' <: ((α2002'''',) -> α2003'''')}  <!<  ((α1969'''',) -> α1970'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1969'''',) -> α1970'''')
//│ ╟── while constraining:  α1955''''  <!<  ((α1969'''',) -> α1970'''')
//│ ╟── while constraining:  {(α1969'''' -> α1974'''') where: α280'' <: List['a1956''''], α280'' <: List['a1957''''], α280'' <: List['a1961''''], α280'' <: List['a1967''''], α1955'''' <: ((α1969'''',) -> α1970'''')}  <!<  ((α1936'''',) -> α1937'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1936'''',) -> α1937'''')
//│ ╟── while constraining:  α1922''''  <!<  ((α1936'''',) -> α1937'''')
//│ ╟── while constraining:  {(α1936'''' -> α1941'''') where: α280'' <: List['a1923''''], α280'' <: List['a1924''''], α280'' <: List['a1928''''], α280'' <: List['a1934''''], α1922'''' <: ((α1936'''',) -> α1937'''')}  <!<  ((α1903'''',) -> α1904'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1903'''',) -> α1904'''')
//│ ╟── while constraining:  α1889''''  <!<  ((α1903'''',) -> α1904'''')
//│ ╟── while constraining:  {(α1903'''' -> α1908'''') where: α280'' <: List['a1890''''], α280'' <: List['a1891''''], α280'' <: List['a1895''''], α280'' <: List['a1901''''], α1889'''' <: ((α1903'''',) -> α1904'''')}  <!<  ((α1870'''',) -> α1871'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1870'''',) -> α1871'''')
//│ ╟── while constraining:  α1856''''  <!<  ((α1870'''',) -> α1871'''')
//│ ╟── while constraining:  {(α1870'''' -> α1875'''') where: α280'' <: List['a1857''''], α280'' <: List['a1858''''], α280'' <: List['a1862''''], α280'' <: List['a1868''''], α1856'''' <: ((α1870'''',) -> α1871'''')}  <!<  ((α1837'''',) -> α1838'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1837'''',) -> α1838'''')
//│ ╟── while constraining:  α1823''''  <!<  ((α1837'''',) -> α1838'''')
//│ ╟── while constraining:  {(α1837'''' -> α1842'''') where: α280'' <: List['a1824''''], α280'' <: List['a1825''''], α280'' <: List['a1829''''], α280'' <: List['a1835''''], α1823'''' <: ((α1837'''',) -> α1838'''')}  <!<  ((α1804'''',) -> α1805'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1804'''',) -> α1805'''')
//│ ╟── while constraining:  α1790''''  <!<  ((α1804'''',) -> α1805'''')
//│ ╟── while constraining:  {(α1804'''' -> α1809'''') where: α280'' <: List['a1791''''], α280'' <: List['a1792''''], α280'' <: List['a1796''''], α280'' <: List['a1802''''], α1790'''' <: ((α1804'''',) -> α1805'''')}  <!<  ((α1771'''',) -> α1772'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1771'''',) -> α1772'''')
//│ ╟── while constraining:  α1757''''  <!<  ((α1771'''',) -> α1772'''')
//│ ╟── while constraining:  {(α1771'''' -> α1776'''') where: α280'' <: List['a1758''''], α280'' <: List['a1759''''], α280'' <: List['a1763''''], α280'' <: List['a1769''''], α1757'''' <: ((α1771'''',) -> α1772'''')}  <!<  ((α1738'''',) -> α1739'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1738'''',) -> α1739'''')
//│ ╟── while constraining:  α1724''''  <!<  ((α1738'''',) -> α1739'''')
//│ ╟── while constraining:  {(α1738'''' -> α1743'''') where: α280'' <: List['a1725''''], α280'' <: List['a1726''''], α280'' <: List['a1730''''], α280'' <: List['a1736''''], α1724'''' <: ((α1738'''',) -> α1739'''')}  <!<  ((α1705'''',) -> α1706'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1705'''',) -> α1706'''')
//│ ╟── while constraining:  α1691''''  <!<  ((α1705'''',) -> α1706'''')
//│ ╟── while constraining:  {(α1705'''' -> α1710'''') where: α280'' <: List['a1692''''], α280'' <: List['a1693''''], α280'' <: List['a1697''''], α280'' <: List['a1703''''], α1691'''' <: ((α1705'''',) -> α1706'''')}  <!<  ((α1672'''',) -> α1673'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1672'''',) -> α1673'''')
//│ ╟── while constraining:  α1658''''  <!<  ((α1672'''',) -> α1673'''')
//│ ╟── while constraining:  {(α1672'''' -> α1677'''') where: α280'' <: List['a1659''''], α280'' <: List['a1660''''], α280'' <: List['a1664''''], α280'' <: List['a1670''''], α1658'''' <: ((α1672'''',) -> α1673'''')}  <!<  ((α1639'''',) -> α1640'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1639'''',) -> α1640'''')
//│ ╟── while constraining:  α1625''''  <!<  ((α1639'''',) -> α1640'''')
//│ ╟── while constraining:  {(α1639'''' -> α1644'''') where: α280'' <: List['a1626''''], α280'' <: List['a1627''''], α280'' <: List['a1631''''], α280'' <: List['a1637''''], α1625'''' <: ((α1639'''',) -> α1640'''')}  <!<  ((α1606'''',) -> α1607'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1606'''',) -> α1607'''')
//│ ╟── while constraining:  α1592''''  <!<  ((α1606'''',) -> α1607'''')
//│ ╟── while constraining:  {(α1606'''' -> α1611'''') where: α280'' <: List['a1593''''], α280'' <: List['a1594''''], α280'' <: List['a1598''''], α280'' <: List['a1604''''], α1592'''' <: ((α1606'''',) -> α1607'''')}  <!<  ((α1573'''',) -> α1574'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1573'''',) -> α1574'''')
//│ ╟── while constraining:  α1559''''  <!<  ((α1573'''',) -> α1574'''')
//│ ╟── while constraining:  {(α1573'''' -> α1578'''') where: α280'' <: List['a1560''''], α280'' <: List['a1561''''], α280'' <: List['a1565''''], α280'' <: List['a1571''''], α1559'''' <: ((α1573'''',) -> α1574'''')}  <!<  ((α1540'''',) -> α1541'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1540'''',) -> α1541'''')
//│ ╟── while constraining:  α1526''''  <!<  ((α1540'''',) -> α1541'''')
//│ ╟── while constraining:  {(α1540'''' -> α1545'''') where: α280'' <: List['a1527''''], α280'' <: List['a1528''''], α280'' <: List['a1532''''], α280'' <: List['a1538''''], α1526'''' <: ((α1540'''',) -> α1541'''')}  <!<  ((α1507'''',) -> α1508'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1507'''',) -> α1508'''')
//│ ╟── while constraining:  α1493''''  <!<  ((α1507'''',) -> α1508'''')
//│ ╟── while constraining:  {(α1507'''' -> α1512'''') where: α280'' <: List['a1494''''], α280'' <: List['a1495''''], α280'' <: List['a1499''''], α280'' <: List['a1505''''], α1493'''' <: ((α1507'''',) -> α1508'''')}  <!<  ((α1474'''',) -> α1475'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1474'''',) -> α1475'''')
//│ ╟── while constraining:  α1460''''  <!<  ((α1474'''',) -> α1475'''')
//│ ╟── while constraining:  {(α1474'''' -> α1479'''') where: α280'' <: List['a1461''''], α280'' <: List['a1462''''], α280'' <: List['a1466''''], α280'' <: List['a1472''''], α1460'''' <: ((α1474'''',) -> α1475'''')}  <!<  ((α1441'''',) -> α1442'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1441'''',) -> α1442'''')
//│ ╟── while constraining:  α1427''''  <!<  ((α1441'''',) -> α1442'''')
//│ ╟── while constraining:  {(α1441'''' -> α1446'''') where: α280'' <: List['a1428''''], α280'' <: List['a1429''''], α280'' <: List['a1433''''], α280'' <: List['a1439''''], α1427'''' <: ((α1441'''',) -> α1442'''')}  <!<  ((α1408'''',) -> α1409'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1408'''',) -> α1409'''')
//│ ╟── while constraining:  α1394''''  <!<  ((α1408'''',) -> α1409'''')
//│ ╟── while constraining:  {(α1408'''' -> α1413'''') where: α280'' <: List['a1395''''], α280'' <: List['a1396''''], α280'' <: List['a1400''''], α280'' <: List['a1406''''], α1394'''' <: ((α1408'''',) -> α1409'''')}  <!<  ((α1375'''',) -> α1376'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1375'''',) -> α1376'''')
//│ ╟── while constraining:  α1361''''  <!<  ((α1375'''',) -> α1376'''')
//│ ╟── while constraining:  {(α1375'''' -> α1380'''') where: α280'' <: List['a1362''''], α280'' <: List['a1363''''], α280'' <: List['a1367''''], α280'' <: List['a1373''''], α1361'''' <: ((α1375'''',) -> α1376'''')}  <!<  ((α1342'''',) -> α1343'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1342'''',) -> α1343'''')
//│ ╟── while constraining:  α1328''''  <!<  ((α1342'''',) -> α1343'''')
//│ ╟── while constraining:  {(α1342'''' -> α1347'''') where: α280'' <: List['a1329''''], α280'' <: List['a1330''''], α280'' <: List['a1334''''], α280'' <: List['a1340''''], α1328'''' <: ((α1342'''',) -> α1343'''')}  <!<  ((α1309'''',) -> α1310'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1309'''',) -> α1310'''')
//│ ╟── while constraining:  α1295''''  <!<  ((α1309'''',) -> α1310'''')
//│ ╟── while constraining:  {(α1309'''' -> α1314'''') where: α280'' <: List['a1296''''], α280'' <: List['a1297''''], α280'' <: List['a1301''''], α280'' <: List['a1307''''], α1295'''' <: ((α1309'''',) -> α1310'''')}  <!<  ((α1276'''',) -> α1277'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1276'''',) -> α1277'''')
//│ ╟── while constraining:  α1262''''  <!<  ((α1276'''',) -> α1277'''')
//│ ╟── while constraining:  {(α1276'''' -> α1281'''') where: α280'' <: List['a1263''''], α280'' <: List['a1264''''], α280'' <: List['a1268''''], α280'' <: List['a1274''''], α1262'''' <: ((α1276'''',) -> α1277'''')}  <!<  ((α1243'''',) -> α1244'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1243'''',) -> α1244'''')
//│ ╟── while constraining:  α1229''''  <!<  ((α1243'''',) -> α1244'''')
//│ ╟── while constraining:  {(α1243'''' -> α1248'''') where: α280'' <: List['a1230''''], α280'' <: List['a1231''''], α280'' <: List['a1235''''], α280'' <: List['a1241''''], α1229'''' <: ((α1243'''',) -> α1244'''')}  <!<  ((α1210'''',) -> α1211'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1210'''',) -> α1211'''')
//│ ╟── while constraining:  α1196''''  <!<  ((α1210'''',) -> α1211'''')
//│ ╟── while constraining:  {(α1210'''' -> α1215'''') where: α280'' <: List['a1197''''], α280'' <: List['a1198''''], α280'' <: List['a1202''''], α280'' <: List['a1208''''], α1196'''' <: ((α1210'''',) -> α1211'''')}  <!<  ((α1177'''',) -> α1178'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1177'''',) -> α1178'''')
//│ ╟── while constraining:  α1163''''  <!<  ((α1177'''',) -> α1178'''')
//│ ╟── while constraining:  {(α1177'''' -> α1182'''') where: α280'' <: List['a1164''''], α280'' <: List['a1165''''], α280'' <: List['a1169''''], α280'' <: List['a1175''''], α1163'''' <: ((α1177'''',) -> α1178'''')}  <!<  ((α1144'''',) -> α1145'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1144'''',) -> α1145'''')
//│ ╟── while constraining:  α1130''''  <!<  ((α1144'''',) -> α1145'''')
//│ ╟── while constraining:  {(α1144'''' -> α1149'''') where: α280'' <: List['a1131''''], α280'' <: List['a1132''''], α280'' <: List['a1136''''], α280'' <: List['a1142''''], α1130'''' <: ((α1144'''',) -> α1145'''')}  <!<  ((α1111'''',) -> α1112'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1111'''',) -> α1112'''')
//│ ╟── while constraining:  α1097''''  <!<  ((α1111'''',) -> α1112'''')
//│ ╟── while constraining:  {(α1111'''' -> α1116'''') where: α280'' <: List['a1098''''], α280'' <: List['a1099''''], α280'' <: List['a1103''''], α280'' <: List['a1109''''], α1097'''' <: ((α1111'''',) -> α1112'''')}  <!<  ((α1078'''',) -> α1079'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1078'''',) -> α1079'''')
//│ ╟── while constraining:  α1064''''  <!<  ((α1078'''',) -> α1079'''')
//│ ╟── while constraining:  {(α1078'''' -> α1083'''') where: α280'' <: List['a1065''''], α280'' <: List['a1066''''], α280'' <: List['a1070''''], α280'' <: List['a1076''''], α1064'''' <: ((α1078'''',) -> α1079'''')}  <!<  ((α1045'''',) -> α1046'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1045'''',) -> α1046'''')
//│ ╟── while constraining:  α1031''''  <!<  ((α1045'''',) -> α1046'''')
//│ ╟── while constraining:  {(α1045'''' -> α1050'''') where: α280'' <: List['a1032''''], α280'' <: List['a1033''''], α280'' <: List['a1037''''], α280'' <: List['a1043''''], α1031'''' <: ((α1045'''',) -> α1046'''')}  <!<  ((α1012'''',) -> α1013'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α1012'''',) -> α1013'''')
//│ ╟── while constraining:  α998''''  <!<  ((α1012'''',) -> α1013'''')
//│ ╟── while constraining:  {(α1012'''' -> α1017'''') where: α280'' <: List['a999''''], α280'' <: List['a1000''''], α280'' <: List['a1004''''], α280'' <: List['a1010''''], α998'''' <: ((α1012'''',) -> α1013'''')}  <!<  ((α979'''',) -> α980'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α979'''',) -> α980'''')
//│ ╟── while constraining:  α965''''  <!<  ((α979'''',) -> α980'''')
//│ ╟── while constraining:  {(α979'''' -> α984'''') where: α280'' <: List['a966''''], α280'' <: List['a967''''], α280'' <: List['a971''''], α280'' <: List['a977''''], α965'''' <: ((α979'''',) -> α980'''')}  <!<  ((α946'''',) -> α947'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α946'''',) -> α947'''')
//│ ╟── while constraining:  α932''''  <!<  ((α946'''',) -> α947'''')
//│ ╟── while constraining:  {(α946'''' -> α951'''') where: α280'' <: List['a933''''], α280'' <: List['a934''''], α280'' <: List['a938''''], α280'' <: List['a944''''], α932'''' <: ((α946'''',) -> α947'''')}  <!<  ((α913'''',) -> α914'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α913'''',) -> α914'''')
//│ ╟── while constraining:  α899''''  <!<  ((α913'''',) -> α914'''')
//│ ╟── while constraining:  {(α913'''' -> α918'''') where: α280'' <: List['a900''''], α280'' <: List['a901''''], α280'' <: List['a905''''], α280'' <: List['a911''''], α899'''' <: ((α913'''',) -> α914'''')}  <!<  ((α880'''',) -> α881'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α880'''',) -> α881'''')
//│ ╟── while constraining:  α866''''  <!<  ((α880'''',) -> α881'''')
//│ ╟── while constraining:  {(α880'''' -> α885'''') where: α280'' <: List['a867''''], α280'' <: List['a868''''], α280'' <: List['a872''''], α280'' <: List['a878''''], α866'''' <: ((α880'''',) -> α881'''')}  <!<  ((α847'''',) -> α848'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α847'''',) -> α848'''')
//│ ╟── while constraining:  α833''''  <!<  ((α847'''',) -> α848'''')
//│ ╟── while constraining:  {(α847'''' -> α852'''') where: α280'' <: List['a834''''], α280'' <: List['a835''''], α280'' <: List['a839''''], α280'' <: List['a845''''], α833'''' <: ((α847'''',) -> α848'''')}  <!<  ((α814'''',) -> α815'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α814'''',) -> α815'''')
//│ ╟── while constraining:  α800''''  <!<  ((α814'''',) -> α815'''')
//│ ╟── while constraining:  {(α814'''' -> α819'''') where: α280'' <: List['a801''''], α280'' <: List['a802''''], α280'' <: List['a806''''], α280'' <: List['a812''''], α800'''' <: ((α814'''',) -> α815'''')}  <!<  ((α781'''',) -> α782'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α781'''',) -> α782'''')
//│ ╟── while constraining:  α767''''  <!<  ((α781'''',) -> α782'''')
//│ ╟── while constraining:  {(α781'''' -> α786'''') where: α280'' <: List['a768''''], α280'' <: List['a769''''], α280'' <: List['a773''''], α280'' <: List['a779''''], α767'''' <: ((α781'''',) -> α782'''')}  <!<  ((α748'''',) -> α749'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α748'''',) -> α749'''')
//│ ╟── while constraining:  α734''''  <!<  ((α748'''',) -> α749'''')
//│ ╟── while constraining:  {(α748'''' -> α753'''') where: α280'' <: List['a735''''], α280'' <: List['a736''''], α280'' <: List['a740''''], α280'' <: List['a746''''], α734'''' <: ((α748'''',) -> α749'''')}  <!<  ((α715'''',) -> α716'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α715'''',) -> α716'''')
//│ ╟── while constraining:  α701''''  <!<  ((α715'''',) -> α716'''')
//│ ╟── while constraining:  {(α715'''' -> α720'''') where: α280'' <: List['a702''''], α280'' <: List['a703''''], α280'' <: List['a707''''], α280'' <: List['a713''''], α701'''' <: ((α715'''',) -> α716'''')}  <!<  ((α682'''',) -> α683'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α682'''',) -> α683'''')
//│ ╟── while constraining:  α668''''  <!<  ((α682'''',) -> α683'''')
//│ ╟── while constraining:  {(α682'''' -> α687'''') where: α280'' <: List['a669''''], α280'' <: List['a670''''], α280'' <: List['a674''''], α280'' <: List['a680''''], α668'''' <: ((α682'''',) -> α683'''')}  <!<  ((α649'''',) -> α650'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α649'''',) -> α650'''')
//│ ╟── while constraining:  α635''''  <!<  ((α649'''',) -> α650'''')
//│ ╟── while constraining:  {(α649'''' -> α654'''') where: α280'' <: List['a636''''], α280'' <: List['a637''''], α280'' <: List['a641''''], α280'' <: List['a647''''], α635'''' <: ((α649'''',) -> α650'''')}  <!<  ((α616'''',) -> α617'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α616'''',) -> α617'''')
//│ ╟── while constraining:  α602''''  <!<  ((α616'''',) -> α617'''')
//│ ╟── while constraining:  {(α616'''' -> α621'''') where: α280'' <: List['a603''''], α280'' <: List['a604''''], α280'' <: List['a608''''], α280'' <: List['a614''''], α602'''' <: ((α616'''',) -> α617'''')}  <!<  ((α583'''',) -> α584'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α583'''',) -> α584'''')
//│ ╟── while constraining:  α569''''  <!<  ((α583'''',) -> α584'''')
//│ ╟── while constraining:  {(α583'''' -> α588'''') where: α280'' <: List['a570''''], α280'' <: List['a571''''], α280'' <: List['a575''''], α280'' <: List['a581''''], α569'''' <: ((α583'''',) -> α584'''')}  <!<  ((α550'''',) -> α551'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α550'''',) -> α551'''')
//│ ╟── while constraining:  α536''''  <!<  ((α550'''',) -> α551'''')
//│ ╟── while constraining:  {(α550'''' -> α555'''') where: α280'' <: List['a537''''], α280'' <: List['a538''''], α280'' <: List['a542''''], α280'' <: List['a548''''], α536'''' <: ((α550'''',) -> α551'''')}  <!<  ((α517'''',) -> α518'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α517'''',) -> α518'''')
//│ ╟── while constraining:  α503''''  <!<  ((α517'''',) -> α518'''')
//│ ╟── while constraining:  {(α517'''' -> α522'''') where: α280'' <: List['a504''''], α280'' <: List['a505''''], α280'' <: List['a509''''], α280'' <: List['a515''''], α503'''' <: ((α517'''',) -> α518'''')}  <!<  ((α484'''',) -> α485'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α484'''',) -> α485'''')
//│ ╟── while constraining:  α470''''  <!<  ((α484'''',) -> α485'''')
//│ ╟── while constraining:  {(α484'''' -> α489'''') where: α280'' <: List['a471''''], α280'' <: List['a472''''], α280'' <: List['a476''''], α280'' <: List['a482''''], α470'''' <: ((α484'''',) -> α485'''')}  <!<  ((α451'''',) -> α452'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α451'''',) -> α452'''')
//│ ╟── while constraining:  α437''''  <!<  ((α451'''',) -> α452'''')
//│ ╟── while constraining:  {(α451'''' -> α456'''') where: α280'' <: List['a438''''], α280'' <: List['a439''''], α280'' <: List['a443''''], α280'' <: List['a449''''], α437'''' <: ((α451'''',) -> α452'''')}  <!<  ((α418'''',) -> α419'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α418'''',) -> α419'''')
//│ ╟── while constraining:  α404''''  <!<  ((α418'''',) -> α419'''')
//│ ╟── while constraining:  {(α418'''' -> α423'''') where: α280'' <: List['a405''''], α280'' <: List['a406''''], α280'' <: List['a410''''], α280'' <: List['a416''''], α404'''' <: ((α418'''',) -> α419'''')}  <!<  ((α385'''',) -> α386'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α385'''',) -> α386'''')
//│ ╟── while constraining:  α371''''  <!<  ((α385'''',) -> α386'''')
//│ ╟── while constraining:  {(α385'''' -> α390'''') where: α280'' <: List['a372''''], α280'' <: List['a373''''], α280'' <: List['a377''''], α280'' <: List['a383''''], α371'''' <: ((α385'''',) -> α386'''')}  <!<  ((α352'''',) -> α353'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α352'''',) -> α353'''')
//│ ╟── while constraining:  α338''''  <!<  ((α352'''',) -> α353'''')
//│ ╟── while constraining:  {(α352'''' -> α357'''') where: α280'' <: List['a339''''], α280'' <: List['a340''''], α280'' <: List['a344''''], α280'' <: List['a350''''], α338'''' <: ((α352'''',) -> α353'''')}  <!<  ((α319'''',) -> α320'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α319'''',) -> α320'''')
//│ ╟── while constraining:  α305''''  <!<  ((α319'''',) -> α320'''')
//│ ╟── while constraining:  {(α319'''' -> α324'''') where: α280'' <: List['a306''''], α280'' <: List['a307''''], α280'' <: List['a311''''], α280'' <: List['a317''''], α305'''' <: ((α319'''',) -> α320'''')}  <!<  ((α277''',) -> α304'''')
//│ ╟── while constraining:  ‹∀ 2. {(α295''' -> α300''') where: α280'' <: List['a282'''], α280'' <: List['a283'''], α280'' <: List['a287'''], α280'' <: List['a293'''], α281'''' <: ((α295''',) -> α296''')}›  <!<  ((α277''',) -> α304'''')
//│ ╙── while constraining:  α278''''  <!<  ((α277''',) -> α304'''')
//│ nfind: anything -> anything -> anything -> (forall 'a. 'a -> 'a)
//│      = [Function: nfind]

// type Int = ['a] ('a -> 'a) -> ('a -> 'a)
type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ Defined type alias ChurchInt

// let succ (n:Int) = fun f x -> f (n f x)
def succ (n: ChurchInt) = fun f -> fun x -> f (n f x)
def succ' n = fun f -> fun x -> f (n f x)
//│ succ: ChurchInt -> (forall 'a. 'a -> (forall 'a, 'b, 'c, 'd. ('b -> 'd
//│   where
//│     'e <: 'a -> 'b -> 'c
//│     'a <: 'c -> 'd)))
//│     = [Function: succ]
//│ succ': 'a -> (forall 'b. 'b -> (forall 'b, 'c, 'd, 'e. ('c -> 'e
//│   where
//│     'a <: 'b -> 'c -> 'd
//│     'b <: 'd -> 'e)))
//│      = [Function: succ]

// let add (n:Int) (m:Int) = n succ m
def add (n: ChurchInt) (m: ChurchInt) = n succ m
def add' n m = n succ' m
//│ add: ChurchInt -> (ChurchInt -> 'a
//│   where
//│     'b <: (ChurchInt -> (forall 'c. 'c -> (forall 'c, 'd, 'e, 'f. ('d -> 'f
//│   where
//│     'g <: 'c -> 'd -> 'e
//│     'c <: 'e -> 'f)))) -> ChurchInt -> 'a)
//│    = [Function: add]
//│ add': 'a -> ('b -> 'c
//│   where
//│     'a <: (forall 'd. 'd -> (forall 'e. 'e -> (forall 'e, 'f, 'g, 'h. ('f -> 'h
//│   where
//│     'd <: 'e -> 'f -> 'g
//│     'e <: 'g -> 'h)))) -> 'b -> 'c)
//│     = [Function: add]

// let printInt (n:Int) = print (n (fun x -> x+1) 0)
def printInt (n: ChurchInt) = toString (n (fun x -> x + 1) 0)
def printInt' n = toString (n (fun x -> x + 1) 0)
//│ printInt: ChurchInt -> string
//│         = [Function: printInt]
//│ printInt': ((int -> int) -> 0 -> anything) -> string
//│          = [Function: printInt]

// let table = create_hashtbl ()
// let table = hashtbl_add table "one" (fun f x -> f x)
// let table = hashtbl_add table "two" (fun f x -> f (f x))
table = create_hashtbl null
table = hashtbl_add table "one" (fun f -> fun x -> f x)
table = hashtbl_add table "two" (fun f -> fun x -> f (f x))
//│ table: List[nothing]
//│      = Nil {}
//│ table: List[("one", forall 'a. 'a -> (forall 'b, 'c. ('b -> 'c
//│   where
//│     'a <: 'b -> 'c)),)]
//│      = Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│ table: List[("two", forall 'a. 'a -> (forall 'b, 'c, 'd. ('b -> 'd
//│   where
//│     'a <: 'b -> 'c & 'c -> 'd)),)]
//│      = Cons {
//│          head: [ 'two', [Function (anonymous)] ],
//│          tail: Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│        }

// let zog =
//   printInt (add (nfind table "one") (nfind table "two"))
zog = printInt (add (nfind table "one") (nfind table "two"))
zog' = printInt' (add' (nfind table "one") (nfind table "two"))
//│ zog: string
//│    = '0'
//│ zog': string
//│     = '0'
