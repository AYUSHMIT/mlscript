:GeneralizeCurriedFunctions

// ============ Dummy classes to represent the types in the examples ============

class List[a]
  method Head: a
  method Tail: List[a]
//│ Defined class List[+a]
//│ Declared List.Head: List['a] -> 'a
//│ Declared List.Tail: List['a] -> List['a]

class Cons[a]: List[a] & { head: a; tail: List[a] }
  method Head = this.head
  method Tail = this.tail
def cons[a]: a -> List[a] -> List[a]
def cons head tail = Cons { head; tail }
//│ Defined class Cons[+a]
//│ Defined Cons.Head: Cons['a] -> 'a
//│ Defined Cons.Tail: Cons['a] -> List['a]
//│ cons: 'a -> List['a] -> List['a]
//│     = <missing implementation>
//│ 'b -> (forall 'a, 'tail. (List['a] & 'tail) -> (Cons['a | 'b] with {head: 'b, tail: 'tail}))
//│   <:  cons:
//│ 'a -> List['a] -> List['a]
//│     = [Function: cons]

class Nil[a]: List[a]
  method Head = error
  method Tail = this
def nil: List['a]
def nil = Nil {}
//│ Defined class Nil[+a]
//│ Defined Nil.Head: Nil[?] -> nothing
//│ Defined Nil.Tail: (Nil['a] & 'this) -> (Nil['a] & 'this)
//│ nil: List[nothing]
//│    = <missing implementation>
//│ Nil[nothing]
//│   <:  nil:
//│ List[nothing]
//│    = Nil {}

// ============ Type signatures for functions used in the examples ============

def head: forall 'a. List['a] -> 'a
def head l = l.Head
//│ head: List['a] -> 'a
//│     = <missing implementation>
//│ List['a] -> 'a
//│   <:  head:
//│ List['a] -> 'a
//│     = [Function: head]

def tail: forall 'a. List['a] -> List['a]
def tail l = l.Tail
//│ tail: List['a] -> List['a]
//│     = <missing implementation>
//│ List['a] -> List['a]
//│   <:  tail:
//│ List['a] -> List['a]
//│     = [Function: tail]

def is_empty: forall 'a. List['a] -> bool
def is_empty l = eq l nil
//│ is_empty: List[?] -> bool
//│         = <missing implementation>
//│ anything -> bool
//│   <:  is_empty:
//│ List[?] -> bool
//│         = [Function: is_empty]



// (* Use the value restriction ! *)

// type option ('a) = None | Some of 'a
class None
class Some[a]: { val: a }
type Option[a] = None | Some[a]
def None = None {}
def Some val = Some { val }
//│ Defined class None
//│ Defined class Some[+a]
//│ Defined type alias Option[+a]
//│ None: None
//│     = None {}
//│ Some: 'val -> Some['val]
//│     = [Function: Some1]

// let create_hashtbl () = []
def create_hashtbl _ = nil
//│ create_hashtbl: anything -> List[nothing]
//│               = [Function: create_hashtbl]

// let hashtbl_add table key element = (key, element) :: table
def hashtbl_add table key element = cons ((key, element)) table
//│ hashtbl_add: 'a -> (forall 'b. 'b -> (forall 'b, 'c, 'd. ('d -> List[('b, 'd,) | 'c]
//│   where
//│     'a <: List['c])))
//│            = [Function: hashtbl_add]

// let rec find table key = 
//   if nil table then None
//   else if fst (car table) = key then Some (snd (car table))
//   else find (cdr table) key
rec def find table key =
  if is_empty table then None
  else if eq (head table)._1 key then Some (head table)._2
  else find (tail table) key
//│ find: 'a -> (forall 'a, 'val, 'b, 'c. ('b -> (None | Some['val] | 'c)
//│   where
//│     'a <: List['a] & List[{_1: 'a}] & List[{_2: 'val}]
//│     'd <: 'b -> 'c))
//│     = [Function: find]


// let nfind table key =
//   begin match find table key with
//   | None -> fun f x -> x
//   | Some n -> n
//   end
def nfind table key =
  let opt = find table key in
  case opt of
  { None -> fun f -> fun x -> x
  | Some -> opt.val
  }
//│ ╔══[ERROR] Subtyping constraint of the form `?a <: ?b -> ?c` exceeded recursion depth limit (400)
//│ ║  l.122: 	  let opt = find table key in
//│ ║         	            ^^^^^^^^^^^^^^
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2677',) -> α2678')
//│ ╟── while constraining:  α238'  <!<  ((α2677',) -> α2678')
//│ ╟── while constraining:  α238'  <!<  ((α2659'''',) -> α2660'''')
//│ ╟── while constraining:  (α209'' <: List['a2647''''], α209'' <: List['a2648''''], α209'' <: List['a2652''''], α209'' <: List['a2658''''], α238' <: ((α2659'''',) -> α2660'''') => (α2659'''' -> α2664''''))  <!<  ((α2641',) -> α2642')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2641',) -> α2642')
//│ ╟── while constraining:  α238'  <!<  ((α2641',) -> α2642')
//│ ╟── while constraining:  α238'  <!<  ((α2623'''',) -> α2624'''')
//│ ╟── while constraining:  (α209'' <: List['a2611''''], α209'' <: List['a2612''''], α209'' <: List['a2616''''], α209'' <: List['a2622''''], α238' <: ((α2623'''',) -> α2624'''') => (α2623'''' -> α2628''''))  <!<  ((α2605',) -> α2606')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2605',) -> α2606')
//│ ╟── while constraining:  α238'  <!<  ((α2605',) -> α2606')
//│ ╟── while constraining:  α238'  <!<  ((α2587'''',) -> α2588'''')
//│ ╟── while constraining:  (α209'' <: List['a2575''''], α209'' <: List['a2576''''], α209'' <: List['a2580''''], α209'' <: List['a2586''''], α238' <: ((α2587'''',) -> α2588'''') => (α2587'''' -> α2592''''))  <!<  ((α2569',) -> α2570')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2569',) -> α2570')
//│ ╟── while constraining:  α238'  <!<  ((α2569',) -> α2570')
//│ ╟── while constraining:  α238'  <!<  ((α2551'''',) -> α2552'''')
//│ ╟── while constraining:  (α209'' <: List['a2539''''], α209'' <: List['a2540''''], α209'' <: List['a2544''''], α209'' <: List['a2550''''], α238' <: ((α2551'''',) -> α2552'''') => (α2551'''' -> α2556''''))  <!<  ((α2533',) -> α2534')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2533',) -> α2534')
//│ ╟── while constraining:  α238'  <!<  ((α2533',) -> α2534')
//│ ╟── while constraining:  α238'  <!<  ((α2515'''',) -> α2516'''')
//│ ╟── while constraining:  (α209'' <: List['a2503''''], α209'' <: List['a2504''''], α209'' <: List['a2508''''], α209'' <: List['a2514''''], α238' <: ((α2515'''',) -> α2516'''') => (α2515'''' -> α2520''''))  <!<  ((α2497',) -> α2498')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2497',) -> α2498')
//│ ╟── while constraining:  α238'  <!<  ((α2497',) -> α2498')
//│ ╟── while constraining:  α238'  <!<  ((α2479'''',) -> α2480'''')
//│ ╟── while constraining:  (α209'' <: List['a2467''''], α209'' <: List['a2468''''], α209'' <: List['a2472''''], α209'' <: List['a2478''''], α238' <: ((α2479'''',) -> α2480'''') => (α2479'''' -> α2484''''))  <!<  ((α2461',) -> α2462')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2461',) -> α2462')
//│ ╟── while constraining:  α238'  <!<  ((α2461',) -> α2462')
//│ ╟── while constraining:  α238'  <!<  ((α2443'''',) -> α2444'''')
//│ ╟── while constraining:  (α209'' <: List['a2431''''], α209'' <: List['a2432''''], α209'' <: List['a2436''''], α209'' <: List['a2442''''], α238' <: ((α2443'''',) -> α2444'''') => (α2443'''' -> α2448''''))  <!<  ((α2425',) -> α2426')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2425',) -> α2426')
//│ ╟── while constraining:  α238'  <!<  ((α2425',) -> α2426')
//│ ╟── while constraining:  α238'  <!<  ((α2407'''',) -> α2408'''')
//│ ╟── while constraining:  (α209'' <: List['a2395''''], α209'' <: List['a2396''''], α209'' <: List['a2400''''], α209'' <: List['a2406''''], α238' <: ((α2407'''',) -> α2408'''') => (α2407'''' -> α2412''''))  <!<  ((α2389',) -> α2390')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2389',) -> α2390')
//│ ╟── while constraining:  α238'  <!<  ((α2389',) -> α2390')
//│ ╟── while constraining:  α238'  <!<  ((α2371'''',) -> α2372'''')
//│ ╟── while constraining:  (α209'' <: List['a2359''''], α209'' <: List['a2360''''], α209'' <: List['a2364''''], α209'' <: List['a2370''''], α238' <: ((α2371'''',) -> α2372'''') => (α2371'''' -> α2376''''))  <!<  ((α2353',) -> α2354')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2353',) -> α2354')
//│ ╟── while constraining:  α238'  <!<  ((α2353',) -> α2354')
//│ ╟── while constraining:  α238'  <!<  ((α2335'''',) -> α2336'''')
//│ ╟── while constraining:  (α209'' <: List['a2323''''], α209'' <: List['a2324''''], α209'' <: List['a2328''''], α209'' <: List['a2334''''], α238' <: ((α2335'''',) -> α2336'''') => (α2335'''' -> α2340''''))  <!<  ((α2317',) -> α2318')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2317',) -> α2318')
//│ ╟── while constraining:  α238'  <!<  ((α2317',) -> α2318')
//│ ╟── while constraining:  α238'  <!<  ((α2299'''',) -> α2300'''')
//│ ╟── while constraining:  (α209'' <: List['a2287''''], α209'' <: List['a2288''''], α209'' <: List['a2292''''], α209'' <: List['a2298''''], α238' <: ((α2299'''',) -> α2300'''') => (α2299'''' -> α2304''''))  <!<  ((α2281',) -> α2282')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2281',) -> α2282')
//│ ╟── while constraining:  α238'  <!<  ((α2281',) -> α2282')
//│ ╟── while constraining:  α238'  <!<  ((α2263'''',) -> α2264'''')
//│ ╟── while constraining:  (α209'' <: List['a2251''''], α209'' <: List['a2252''''], α209'' <: List['a2256''''], α209'' <: List['a2262''''], α238' <: ((α2263'''',) -> α2264'''') => (α2263'''' -> α2268''''))  <!<  ((α2245',) -> α2246')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2245',) -> α2246')
//│ ╟── while constraining:  α238'  <!<  ((α2245',) -> α2246')
//│ ╟── while constraining:  α238'  <!<  ((α2227'''',) -> α2228'''')
//│ ╟── while constraining:  (α209'' <: List['a2215''''], α209'' <: List['a2216''''], α209'' <: List['a2220''''], α209'' <: List['a2226''''], α238' <: ((α2227'''',) -> α2228'''') => (α2227'''' -> α2232''''))  <!<  ((α2209',) -> α2210')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2209',) -> α2210')
//│ ╟── while constraining:  α238'  <!<  ((α2209',) -> α2210')
//│ ╟── while constraining:  α238'  <!<  ((α2191'''',) -> α2192'''')
//│ ╟── while constraining:  (α209'' <: List['a2179''''], α209'' <: List['a2180''''], α209'' <: List['a2184''''], α209'' <: List['a2190''''], α238' <: ((α2191'''',) -> α2192'''') => (α2191'''' -> α2196''''))  <!<  ((α2173',) -> α2174')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2173',) -> α2174')
//│ ╟── while constraining:  α238'  <!<  ((α2173',) -> α2174')
//│ ╟── while constraining:  α238'  <!<  ((α2155'''',) -> α2156'''')
//│ ╟── while constraining:  (α209'' <: List['a2143''''], α209'' <: List['a2144''''], α209'' <: List['a2148''''], α209'' <: List['a2154''''], α238' <: ((α2155'''',) -> α2156'''') => (α2155'''' -> α2160''''))  <!<  ((α2137',) -> α2138')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2137',) -> α2138')
//│ ╟── while constraining:  α238'  <!<  ((α2137',) -> α2138')
//│ ╟── while constraining:  α238'  <!<  ((α2119'''',) -> α2120'''')
//│ ╟── while constraining:  (α209'' <: List['a2107''''], α209'' <: List['a2108''''], α209'' <: List['a2112''''], α209'' <: List['a2118''''], α238' <: ((α2119'''',) -> α2120'''') => (α2119'''' -> α2124''''))  <!<  ((α2101',) -> α2102')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2101',) -> α2102')
//│ ╟── while constraining:  α238'  <!<  ((α2101',) -> α2102')
//│ ╟── while constraining:  α238'  <!<  ((α2083'''',) -> α2084'''')
//│ ╟── while constraining:  (α209'' <: List['a2071''''], α209'' <: List['a2072''''], α209'' <: List['a2076''''], α209'' <: List['a2082''''], α238' <: ((α2083'''',) -> α2084'''') => (α2083'''' -> α2088''''))  <!<  ((α2065',) -> α2066')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2065',) -> α2066')
//│ ╟── while constraining:  α238'  <!<  ((α2065',) -> α2066')
//│ ╟── while constraining:  α238'  <!<  ((α2047'''',) -> α2048'''')
//│ ╟── while constraining:  (α209'' <: List['a2035''''], α209'' <: List['a2036''''], α209'' <: List['a2040''''], α209'' <: List['a2046''''], α238' <: ((α2047'''',) -> α2048'''') => (α2047'''' -> α2052''''))  <!<  ((α2029',) -> α2030')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α2029',) -> α2030')
//│ ╟── while constraining:  α238'  <!<  ((α2029',) -> α2030')
//│ ╟── while constraining:  α238'  <!<  ((α2011'''',) -> α2012'''')
//│ ╟── while constraining:  (α209'' <: List['a1999''''], α209'' <: List['a2000''''], α209'' <: List['a2004''''], α209'' <: List['a2010''''], α238' <: ((α2011'''',) -> α2012'''') => (α2011'''' -> α2016''''))  <!<  ((α1993',) -> α1994')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1993',) -> α1994')
//│ ╟── while constraining:  α238'  <!<  ((α1993',) -> α1994')
//│ ╟── while constraining:  α238'  <!<  ((α1975'''',) -> α1976'''')
//│ ╟── while constraining:  (α209'' <: List['a1963''''], α209'' <: List['a1964''''], α209'' <: List['a1968''''], α209'' <: List['a1974''''], α238' <: ((α1975'''',) -> α1976'''') => (α1975'''' -> α1980''''))  <!<  ((α1957',) -> α1958')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1957',) -> α1958')
//│ ╟── while constraining:  α238'  <!<  ((α1957',) -> α1958')
//│ ╟── while constraining:  α238'  <!<  ((α1939'''',) -> α1940'''')
//│ ╟── while constraining:  (α209'' <: List['a1927''''], α209'' <: List['a1928''''], α209'' <: List['a1932''''], α209'' <: List['a1938''''], α238' <: ((α1939'''',) -> α1940'''') => (α1939'''' -> α1944''''))  <!<  ((α1921',) -> α1922')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1921',) -> α1922')
//│ ╟── while constraining:  α238'  <!<  ((α1921',) -> α1922')
//│ ╟── while constraining:  α238'  <!<  ((α1903'''',) -> α1904'''')
//│ ╟── while constraining:  (α209'' <: List['a1891''''], α209'' <: List['a1892''''], α209'' <: List['a1896''''], α209'' <: List['a1902''''], α238' <: ((α1903'''',) -> α1904'''') => (α1903'''' -> α1908''''))  <!<  ((α1885',) -> α1886')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1885',) -> α1886')
//│ ╟── while constraining:  α238'  <!<  ((α1885',) -> α1886')
//│ ╟── while constraining:  α238'  <!<  ((α1867'''',) -> α1868'''')
//│ ╟── while constraining:  (α209'' <: List['a1855''''], α209'' <: List['a1856''''], α209'' <: List['a1860''''], α209'' <: List['a1866''''], α238' <: ((α1867'''',) -> α1868'''') => (α1867'''' -> α1872''''))  <!<  ((α1849',) -> α1850')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1849',) -> α1850')
//│ ╟── while constraining:  α238'  <!<  ((α1849',) -> α1850')
//│ ╟── while constraining:  α238'  <!<  ((α1831'''',) -> α1832'''')
//│ ╟── while constraining:  (α209'' <: List['a1819''''], α209'' <: List['a1820''''], α209'' <: List['a1824''''], α209'' <: List['a1830''''], α238' <: ((α1831'''',) -> α1832'''') => (α1831'''' -> α1836''''))  <!<  ((α1813',) -> α1814')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1813',) -> α1814')
//│ ╟── while constraining:  α238'  <!<  ((α1813',) -> α1814')
//│ ╟── while constraining:  α238'  <!<  ((α1795'''',) -> α1796'''')
//│ ╟── while constraining:  (α209'' <: List['a1783''''], α209'' <: List['a1784''''], α209'' <: List['a1788''''], α209'' <: List['a1794''''], α238' <: ((α1795'''',) -> α1796'''') => (α1795'''' -> α1800''''))  <!<  ((α1777',) -> α1778')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1777',) -> α1778')
//│ ╟── while constraining:  α238'  <!<  ((α1777',) -> α1778')
//│ ╟── while constraining:  α238'  <!<  ((α1759'''',) -> α1760'''')
//│ ╟── while constraining:  (α209'' <: List['a1747''''], α209'' <: List['a1748''''], α209'' <: List['a1752''''], α209'' <: List['a1758''''], α238' <: ((α1759'''',) -> α1760'''') => (α1759'''' -> α1764''''))  <!<  ((α1741',) -> α1742')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1741',) -> α1742')
//│ ╟── while constraining:  α238'  <!<  ((α1741',) -> α1742')
//│ ╟── while constraining:  α238'  <!<  ((α1723'''',) -> α1724'''')
//│ ╟── while constraining:  (α209'' <: List['a1711''''], α209'' <: List['a1712''''], α209'' <: List['a1716''''], α209'' <: List['a1722''''], α238' <: ((α1723'''',) -> α1724'''') => (α1723'''' -> α1728''''))  <!<  ((α1705',) -> α1706')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1705',) -> α1706')
//│ ╟── while constraining:  α238'  <!<  ((α1705',) -> α1706')
//│ ╟── while constraining:  α238'  <!<  ((α1687'''',) -> α1688'''')
//│ ╟── while constraining:  (α209'' <: List['a1675''''], α209'' <: List['a1676''''], α209'' <: List['a1680''''], α209'' <: List['a1686''''], α238' <: ((α1687'''',) -> α1688'''') => (α1687'''' -> α1692''''))  <!<  ((α1669',) -> α1670')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1669',) -> α1670')
//│ ╟── while constraining:  α238'  <!<  ((α1669',) -> α1670')
//│ ╟── while constraining:  α238'  <!<  ((α1651'''',) -> α1652'''')
//│ ╟── while constraining:  (α209'' <: List['a1639''''], α209'' <: List['a1640''''], α209'' <: List['a1644''''], α209'' <: List['a1650''''], α238' <: ((α1651'''',) -> α1652'''') => (α1651'''' -> α1656''''))  <!<  ((α1633',) -> α1634')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1633',) -> α1634')
//│ ╟── while constraining:  α238'  <!<  ((α1633',) -> α1634')
//│ ╟── while constraining:  α238'  <!<  ((α1615'''',) -> α1616'''')
//│ ╟── while constraining:  (α209'' <: List['a1603''''], α209'' <: List['a1604''''], α209'' <: List['a1608''''], α209'' <: List['a1614''''], α238' <: ((α1615'''',) -> α1616'''') => (α1615'''' -> α1620''''))  <!<  ((α1597',) -> α1598')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1597',) -> α1598')
//│ ╟── while constraining:  α238'  <!<  ((α1597',) -> α1598')
//│ ╟── while constraining:  α238'  <!<  ((α1579'''',) -> α1580'''')
//│ ╟── while constraining:  (α209'' <: List['a1567''''], α209'' <: List['a1568''''], α209'' <: List['a1572''''], α209'' <: List['a1578''''], α238' <: ((α1579'''',) -> α1580'''') => (α1579'''' -> α1584''''))  <!<  ((α1561',) -> α1562')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1561',) -> α1562')
//│ ╟── while constraining:  α238'  <!<  ((α1561',) -> α1562')
//│ ╟── while constraining:  α238'  <!<  ((α1543'''',) -> α1544'''')
//│ ╟── while constraining:  (α209'' <: List['a1531''''], α209'' <: List['a1532''''], α209'' <: List['a1536''''], α209'' <: List['a1542''''], α238' <: ((α1543'''',) -> α1544'''') => (α1543'''' -> α1548''''))  <!<  ((α1525',) -> α1526')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1525',) -> α1526')
//│ ╟── while constraining:  α238'  <!<  ((α1525',) -> α1526')
//│ ╟── while constraining:  α238'  <!<  ((α1507'''',) -> α1508'''')
//│ ╟── while constraining:  (α209'' <: List['a1495''''], α209'' <: List['a1496''''], α209'' <: List['a1500''''], α209'' <: List['a1506''''], α238' <: ((α1507'''',) -> α1508'''') => (α1507'''' -> α1512''''))  <!<  ((α1489',) -> α1490')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1489',) -> α1490')
//│ ╟── while constraining:  α238'  <!<  ((α1489',) -> α1490')
//│ ╟── while constraining:  α238'  <!<  ((α1471'''',) -> α1472'''')
//│ ╟── while constraining:  (α209'' <: List['a1459''''], α209'' <: List['a1460''''], α209'' <: List['a1464''''], α209'' <: List['a1470''''], α238' <: ((α1471'''',) -> α1472'''') => (α1471'''' -> α1476''''))  <!<  ((α1453',) -> α1454')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1453',) -> α1454')
//│ ╟── while constraining:  α238'  <!<  ((α1453',) -> α1454')
//│ ╟── while constraining:  α238'  <!<  ((α1435'''',) -> α1436'''')
//│ ╟── while constraining:  (α209'' <: List['a1423''''], α209'' <: List['a1424''''], α209'' <: List['a1428''''], α209'' <: List['a1434''''], α238' <: ((α1435'''',) -> α1436'''') => (α1435'''' -> α1440''''))  <!<  ((α1417',) -> α1418')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1417',) -> α1418')
//│ ╟── while constraining:  α238'  <!<  ((α1417',) -> α1418')
//│ ╟── while constraining:  α238'  <!<  ((α1399'''',) -> α1400'''')
//│ ╟── while constraining:  (α209'' <: List['a1387''''], α209'' <: List['a1388''''], α209'' <: List['a1392''''], α209'' <: List['a1398''''], α238' <: ((α1399'''',) -> α1400'''') => (α1399'''' -> α1404''''))  <!<  ((α1381',) -> α1382')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1381',) -> α1382')
//│ ╟── while constraining:  α238'  <!<  ((α1381',) -> α1382')
//│ ╟── while constraining:  α238'  <!<  ((α1363'''',) -> α1364'''')
//│ ╟── while constraining:  (α209'' <: List['a1351''''], α209'' <: List['a1352''''], α209'' <: List['a1356''''], α209'' <: List['a1362''''], α238' <: ((α1363'''',) -> α1364'''') => (α1363'''' -> α1368''''))  <!<  ((α1345',) -> α1346')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1345',) -> α1346')
//│ ╟── while constraining:  α238'  <!<  ((α1345',) -> α1346')
//│ ╟── while constraining:  α238'  <!<  ((α1327'''',) -> α1328'''')
//│ ╟── while constraining:  (α209'' <: List['a1315''''], α209'' <: List['a1316''''], α209'' <: List['a1320''''], α209'' <: List['a1326''''], α238' <: ((α1327'''',) -> α1328'''') => (α1327'''' -> α1332''''))  <!<  ((α1309',) -> α1310')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1309',) -> α1310')
//│ ╟── while constraining:  α238'  <!<  ((α1309',) -> α1310')
//│ ╟── while constraining:  α238'  <!<  ((α1291'''',) -> α1292'''')
//│ ╟── while constraining:  (α209'' <: List['a1279''''], α209'' <: List['a1280''''], α209'' <: List['a1284''''], α209'' <: List['a1290''''], α238' <: ((α1291'''',) -> α1292'''') => (α1291'''' -> α1296''''))  <!<  ((α1273',) -> α1274')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1273',) -> α1274')
//│ ╟── while constraining:  α238'  <!<  ((α1273',) -> α1274')
//│ ╟── while constraining:  α238'  <!<  ((α1255'''',) -> α1256'''')
//│ ╟── while constraining:  (α209'' <: List['a1243''''], α209'' <: List['a1244''''], α209'' <: List['a1248''''], α209'' <: List['a1254''''], α238' <: ((α1255'''',) -> α1256'''') => (α1255'''' -> α1260''''))  <!<  ((α1237',) -> α1238')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1237',) -> α1238')
//│ ╟── while constraining:  α238'  <!<  ((α1237',) -> α1238')
//│ ╟── while constraining:  α238'  <!<  ((α1219'''',) -> α1220'''')
//│ ╟── while constraining:  (α209'' <: List['a1207''''], α209'' <: List['a1208''''], α209'' <: List['a1212''''], α209'' <: List['a1218''''], α238' <: ((α1219'''',) -> α1220'''') => (α1219'''' -> α1224''''))  <!<  ((α1201',) -> α1202')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1201',) -> α1202')
//│ ╟── while constraining:  α238'  <!<  ((α1201',) -> α1202')
//│ ╟── while constraining:  α238'  <!<  ((α1183'''',) -> α1184'''')
//│ ╟── while constraining:  (α209'' <: List['a1171''''], α209'' <: List['a1172''''], α209'' <: List['a1176''''], α209'' <: List['a1182''''], α238' <: ((α1183'''',) -> α1184'''') => (α1183'''' -> α1188''''))  <!<  ((α1165',) -> α1166')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1165',) -> α1166')
//│ ╟── while constraining:  α238'  <!<  ((α1165',) -> α1166')
//│ ╟── while constraining:  α238'  <!<  ((α1147'''',) -> α1148'''')
//│ ╟── while constraining:  (α209'' <: List['a1135''''], α209'' <: List['a1136''''], α209'' <: List['a1140''''], α209'' <: List['a1146''''], α238' <: ((α1147'''',) -> α1148'''') => (α1147'''' -> α1152''''))  <!<  ((α1129',) -> α1130')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1129',) -> α1130')
//│ ╟── while constraining:  α238'  <!<  ((α1129',) -> α1130')
//│ ╟── while constraining:  α238'  <!<  ((α1111'''',) -> α1112'''')
//│ ╟── while constraining:  (α209'' <: List['a1099''''], α209'' <: List['a1100''''], α209'' <: List['a1104''''], α209'' <: List['a1110''''], α238' <: ((α1111'''',) -> α1112'''') => (α1111'''' -> α1116''''))  <!<  ((α1093',) -> α1094')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1093',) -> α1094')
//│ ╟── while constraining:  α238'  <!<  ((α1093',) -> α1094')
//│ ╟── while constraining:  α238'  <!<  ((α1075'''',) -> α1076'''')
//│ ╟── while constraining:  (α209'' <: List['a1063''''], α209'' <: List['a1064''''], α209'' <: List['a1068''''], α209'' <: List['a1074''''], α238' <: ((α1075'''',) -> α1076'''') => (α1075'''' -> α1080''''))  <!<  ((α1057',) -> α1058')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1057',) -> α1058')
//│ ╟── while constraining:  α238'  <!<  ((α1057',) -> α1058')
//│ ╟── while constraining:  α238'  <!<  ((α1039'''',) -> α1040'''')
//│ ╟── while constraining:  (α209'' <: List['a1027''''], α209'' <: List['a1028''''], α209'' <: List['a1032''''], α209'' <: List['a1038''''], α238' <: ((α1039'''',) -> α1040'''') => (α1039'''' -> α1044''''))  <!<  ((α1021',) -> α1022')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α1021',) -> α1022')
//│ ╟── while constraining:  α238'  <!<  ((α1021',) -> α1022')
//│ ╟── while constraining:  α238'  <!<  ((α1003'''',) -> α1004'''')
//│ ╟── while constraining:  (α209'' <: List['a991''''], α209'' <: List['a992''''], α209'' <: List['a996''''], α209'' <: List['a1002''''], α238' <: ((α1003'''',) -> α1004'''') => (α1003'''' -> α1008''''))  <!<  ((α985',) -> α986')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α985',) -> α986')
//│ ╟── while constraining:  α238'  <!<  ((α985',) -> α986')
//│ ╟── while constraining:  α238'  <!<  ((α967'''',) -> α968'''')
//│ ╟── while constraining:  (α209'' <: List['a955''''], α209'' <: List['a956''''], α209'' <: List['a960''''], α209'' <: List['a966''''], α238' <: ((α967'''',) -> α968'''') => (α967'''' -> α972''''))  <!<  ((α949',) -> α950')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α949',) -> α950')
//│ ╟── while constraining:  α238'  <!<  ((α949',) -> α950')
//│ ╟── while constraining:  α238'  <!<  ((α931'''',) -> α932'''')
//│ ╟── while constraining:  (α209'' <: List['a919''''], α209'' <: List['a920''''], α209'' <: List['a924''''], α209'' <: List['a930''''], α238' <: ((α931'''',) -> α932'''') => (α931'''' -> α936''''))  <!<  ((α913',) -> α914')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α913',) -> α914')
//│ ╟── while constraining:  α238'  <!<  ((α913',) -> α914')
//│ ╟── while constraining:  α238'  <!<  ((α895'''',) -> α896'''')
//│ ╟── while constraining:  (α209'' <: List['a883''''], α209'' <: List['a884''''], α209'' <: List['a888''''], α209'' <: List['a894''''], α238' <: ((α895'''',) -> α896'''') => (α895'''' -> α900''''))  <!<  ((α877',) -> α878')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α877',) -> α878')
//│ ╟── while constraining:  α238'  <!<  ((α877',) -> α878')
//│ ╟── while constraining:  α238'  <!<  ((α859'''',) -> α860'''')
//│ ╟── while constraining:  (α209'' <: List['a847''''], α209'' <: List['a848''''], α209'' <: List['a852''''], α209'' <: List['a858''''], α238' <: ((α859'''',) -> α860'''') => (α859'''' -> α864''''))  <!<  ((α841',) -> α842')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α841',) -> α842')
//│ ╟── while constraining:  α238'  <!<  ((α841',) -> α842')
//│ ╟── while constraining:  α238'  <!<  ((α823'''',) -> α824'''')
//│ ╟── while constraining:  (α209'' <: List['a811''''], α209'' <: List['a812''''], α209'' <: List['a816''''], α209'' <: List['a822''''], α238' <: ((α823'''',) -> α824'''') => (α823'''' -> α828''''))  <!<  ((α805',) -> α806')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α805',) -> α806')
//│ ╟── while constraining:  α238'  <!<  ((α805',) -> α806')
//│ ╟── while constraining:  α238'  <!<  ((α787'''',) -> α788'''')
//│ ╟── while constraining:  (α209'' <: List['a775''''], α209'' <: List['a776''''], α209'' <: List['a780''''], α209'' <: List['a786''''], α238' <: ((α787'''',) -> α788'''') => (α787'''' -> α792''''))  <!<  ((α769',) -> α770')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α769',) -> α770')
//│ ╟── while constraining:  α238'  <!<  ((α769',) -> α770')
//│ ╟── while constraining:  α238'  <!<  ((α751'''',) -> α752'''')
//│ ╟── while constraining:  (α209'' <: List['a739''''], α209'' <: List['a740''''], α209'' <: List['a744''''], α209'' <: List['a750''''], α238' <: ((α751'''',) -> α752'''') => (α751'''' -> α756''''))  <!<  ((α733',) -> α734')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α733',) -> α734')
//│ ╟── while constraining:  α238'  <!<  ((α733',) -> α734')
//│ ╟── while constraining:  α238'  <!<  ((α715'''',) -> α716'''')
//│ ╟── while constraining:  (α209'' <: List['a703''''], α209'' <: List['a704''''], α209'' <: List['a708''''], α209'' <: List['a714''''], α238' <: ((α715'''',) -> α716'''') => (α715'''' -> α720''''))  <!<  ((α697',) -> α698')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α697',) -> α698')
//│ ╟── while constraining:  α238'  <!<  ((α697',) -> α698')
//│ ╟── while constraining:  α238'  <!<  ((α679'''',) -> α680'''')
//│ ╟── while constraining:  (α209'' <: List['a667''''], α209'' <: List['a668''''], α209'' <: List['a672''''], α209'' <: List['a678''''], α238' <: ((α679'''',) -> α680'''') => (α679'''' -> α684''''))  <!<  ((α661',) -> α662')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α661',) -> α662')
//│ ╟── while constraining:  α238'  <!<  ((α661',) -> α662')
//│ ╟── while constraining:  α238'  <!<  ((α643'''',) -> α644'''')
//│ ╟── while constraining:  (α209'' <: List['a631''''], α209'' <: List['a632''''], α209'' <: List['a636''''], α209'' <: List['a642''''], α238' <: ((α643'''',) -> α644'''') => (α643'''' -> α648''''))  <!<  ((α625',) -> α626')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α625',) -> α626')
//│ ╟── while constraining:  α238'  <!<  ((α625',) -> α626')
//│ ╟── while constraining:  α238'  <!<  ((α607'''',) -> α608'''')
//│ ╟── while constraining:  (α209'' <: List['a595''''], α209'' <: List['a596''''], α209'' <: List['a600''''], α209'' <: List['a606''''], α238' <: ((α607'''',) -> α608'''') => (α607'''' -> α612''''))  <!<  ((α589',) -> α590')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α589',) -> α590')
//│ ╟── while constraining:  α238'  <!<  ((α589',) -> α590')
//│ ╟── while constraining:  α238'  <!<  ((α571'''',) -> α572'''')
//│ ╟── while constraining:  (α209'' <: List['a559''''], α209'' <: List['a560''''], α209'' <: List['a564''''], α209'' <: List['a570''''], α238' <: ((α571'''',) -> α572'''') => (α571'''' -> α576''''))  <!<  ((α553',) -> α554')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α553',) -> α554')
//│ ╟── while constraining:  α238'  <!<  ((α553',) -> α554')
//│ ╟── while constraining:  α238'  <!<  ((α535'''',) -> α536'''')
//│ ╟── while constraining:  (α209'' <: List['a523''''], α209'' <: List['a524''''], α209'' <: List['a528''''], α209'' <: List['a534''''], α238' <: ((α535'''',) -> α536'''') => (α535'''' -> α540''''))  <!<  ((α517',) -> α518')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α517',) -> α518')
//│ ╟── while constraining:  α238'  <!<  ((α517',) -> α518')
//│ ╟── while constraining:  α238'  <!<  ((α499'''',) -> α500'''')
//│ ╟── while constraining:  (α209'' <: List['a487''''], α209'' <: List['a488''''], α209'' <: List['a492''''], α209'' <: List['a498''''], α238' <: ((α499'''',) -> α500'''') => (α499'''' -> α504''''))  <!<  ((α481',) -> α482')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α481',) -> α482')
//│ ╟── while constraining:  α238'  <!<  ((α481',) -> α482')
//│ ╟── while constraining:  α238'  <!<  ((α463'''',) -> α464'''')
//│ ╟── while constraining:  (α209'' <: List['a451''''], α209'' <: List['a452''''], α209'' <: List['a456''''], α209'' <: List['a462''''], α238' <: ((α463'''',) -> α464'''') => (α463'''' -> α468''''))  <!<  ((α445',) -> α446')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α445',) -> α446')
//│ ╟── while constraining:  α238'  <!<  ((α445',) -> α446')
//│ ╟── while constraining:  α238'  <!<  ((α427'''',) -> α428'''')
//│ ╟── while constraining:  (α209'' <: List['a415''''], α209'' <: List['a416''''], α209'' <: List['a420''''], α209'' <: List['a426''''], α238' <: ((α427'''',) -> α428'''') => (α427'''' -> α432''''))  <!<  ((α409',) -> α410')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α409',) -> α410')
//│ ╟── while constraining:  α238'  <!<  ((α409',) -> α410')
//│ ╟── while constraining:  α238'  <!<  ((α391'''',) -> α392'''')
//│ ╟── while constraining:  (α209'' <: List['a379''''], α209'' <: List['a380''''], α209'' <: List['a384''''], α209'' <: List['a390''''], α238' <: ((α391'''',) -> α392'''') => (α391'''' -> α396''''))  <!<  ((α373',) -> α374')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α373',) -> α374')
//│ ╟── while constraining:  α238'  <!<  ((α373',) -> α374')
//│ ╟── while constraining:  α238'  <!<  ((α355'''',) -> α356'''')
//│ ╟── while constraining:  (α209'' <: List['a343''''], α209'' <: List['a344''''], α209'' <: List['a348''''], α209'' <: List['a354''''], α238' <: ((α355'''',) -> α356'''') => (α355'''' -> α360''''))  <!<  ((α337',) -> α338')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''], α238' <: ((α210''',) -> α239''') => (α210''' -> α241'''))›  <!<  ((α337',) -> α338')
//│ ╟── while constraining:  α238'  <!<  ((α337',) -> α338')
//│ ╟── while constraining:  α238'  <!<  ((α318'''',) -> α319'''')
//│ ╟── while constraining:  (α209'' <: List['a305''''], α209'' <: List['a306''''], α209'' <: List['a310''''], α209'' <: List['a316''''], α238' <: ((α318'''',) -> α319'''') => (α318'''' -> α323''''))  <!<  ((α277''',) -> α304'''')
//│ ╟── while constraining:  ‹∀ 2. (α209'' <: List['a281'''], α209'' <: List['a282'''], α209'' <: List['a286'''], α209'' <: List['a292'''], α238' <: ((α294''',) -> α295''') => (α294''' -> α299'''))›  <!<  ((α277''',) -> α304'''')
//│ ╙── while constraining:  α278''''  <!<  ((α277''',) -> α304'''')
//│ nfind: anything -> anything -> anything -> (forall 'a. 'a -> 'a)
//│      = [Function: nfind]

// type Int = ['a] ('a -> 'a) -> ('a -> 'a)
type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ Defined type alias ChurchInt

// let succ (n:Int) = fun f x -> f (n f x)
def succ (n: ChurchInt) = fun f -> fun x -> f (n f x)
def succ' n = fun f -> fun x -> f (n f x)
//│ succ: ChurchInt -> (forall 'a. 'a -> (forall 'a, 'b, 'c, 'd. ('b -> 'd
//│   where
//│     'e <: 'a -> 'b -> 'c
//│     'a <: 'c -> 'd)))
//│     = [Function: succ]
//│ succ': 'a -> (forall 'b. 'b -> (forall 'b, 'c, 'd, 'e. ('c -> 'e
//│   where
//│     'a <: 'b -> 'c -> 'd
//│     'b <: 'd -> 'e)))
//│      = [Function: succ]

// let add (n:Int) (m:Int) = n succ m
def add (n: ChurchInt) (m: ChurchInt) = n succ m
def add' n m = n succ' m
//│ add: ChurchInt -> (ChurchInt -> 'a
//│   where
//│     'b <: (ChurchInt -> (forall 'c. 'c -> (forall 'c, 'd, 'e, 'f. ('d -> 'f
//│   where
//│     'g <: 'c -> 'd -> 'e
//│     'c <: 'e -> 'f)))) -> ChurchInt -> 'a)
//│    = [Function: add]
//│ add': 'a -> ('b -> 'c
//│   where
//│     'a <: (forall 'd. 'd -> (forall 'e. 'e -> (forall 'e, 'f, 'g, 'h. ('f -> 'h
//│   where
//│     'd <: 'e -> 'f -> 'g
//│     'e <: 'g -> 'h)))) -> 'b -> 'c)
//│     = [Function: add]

// let printInt (n:Int) = print (n (fun x -> x+1) 0)
def printInt (n: ChurchInt) = toString (n (fun x -> x + 1) 0)
def printInt' n = toString (n (fun x -> x + 1) 0)
//│ printInt: ChurchInt -> string
//│         = [Function: printInt]
//│ printInt': ((int -> int) -> 0 -> anything) -> string
//│          = [Function: printInt]

// let table = create_hashtbl ()
// let table = hashtbl_add table "one" (fun f x -> f x)
// let table = hashtbl_add table "two" (fun f x -> f (f x))
table = create_hashtbl null
table = hashtbl_add table "one" (fun f -> fun x -> f x)
table = hashtbl_add table "two" (fun f -> fun x -> f (f x))
//│ table: List[nothing]
//│      = Nil {}
//│ table: List[("one", forall 'a. 'a -> (forall 'b, 'c. ('b -> 'c
//│   where
//│     'a <: 'b -> 'c)),)]
//│      = Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│ table: List[("two", forall 'a. 'a -> (forall 'b, 'c, 'd. ('b -> 'd
//│   where
//│     'a <: 'b -> 'c & 'c -> 'd)),)]
//│      = Cons {
//│          head: [ 'two', [Function (anonymous)] ],
//│          tail: Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│        }

// let zog =
//   printInt (add (nfind table "one") (nfind table "two"))
zog = printInt (add (nfind table "one") (nfind table "two"))
zog' = printInt' (add' (nfind table "one") (nfind table "two"))
//│ zog: string
//│    = '0'
//│ zog': string
//│     = '0'
