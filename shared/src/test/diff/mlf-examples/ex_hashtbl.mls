:GeneralizeCurriedFunctions

// ============ Dummy classes to represent the types in the examples ============

class List[a]
  method Head: a
  method Tail: List[a]
//│ Defined class List[+a]
//│ Declared List.Head: List['a] -> 'a
//│ Declared List.Tail: List['a] -> List['a]

class Cons[a]: List[a] & { head: a; tail: List[a] }
  method Head = this.head
  method Tail = this.tail
def cons[a]: a -> List[a] -> List[a]
def cons head tail = Cons { head; tail }
//│ Defined class Cons[+a]
//│ Defined Cons.Head: Cons['a] -> 'a
//│ Defined Cons.Tail: Cons['a] -> List['a]
//│ cons: 'a -> List['a] -> List['a]
//│     = <missing implementation>
//│ 'b -> (forall 'a, 'tail. (List['a] & 'tail) -> (Cons['a | 'b] with {head: 'b, tail: 'tail}))
//│   <:  cons:
//│ 'a -> List['a] -> List['a]
//│     = [Function: cons]

class Nil[a]: List[a]
  method Head = error
  method Tail = this
def nil: List['a]
def nil = Nil {}
//│ Defined class Nil[+a]
//│ Defined Nil.Head: Nil[?] -> nothing
//│ Defined Nil.Tail: (Nil['a] & 'this) -> (Nil['a] & 'this)
//│ nil: List[nothing]
//│    = <missing implementation>
//│ Nil[nothing]
//│   <:  nil:
//│ List[nothing]
//│    = Nil {}

// ============ Type signatures for functions used in the examples ============

def head: forall 'a. List['a] -> 'a
def head l = l.Head
//│ head: List['a] -> 'a
//│     = <missing implementation>
//│ List['a] -> 'a
//│   <:  head:
//│ List['a] -> 'a
//│     = [Function: head]

def tail: forall 'a. List['a] -> List['a]
def tail l = l.Tail
//│ tail: List['a] -> List['a]
//│     = <missing implementation>
//│ List['a] -> List['a]
//│   <:  tail:
//│ List['a] -> List['a]
//│     = [Function: tail]

def is_empty: forall 'a. List['a] -> bool
def is_empty l = eq l nil
//│ is_empty: List[?] -> bool
//│         = <missing implementation>
//│ anything -> bool
//│   <:  is_empty:
//│ List[?] -> bool
//│         = [Function: is_empty]



// (* Use the value restriction ! *)

// type option ('a) = None | Some of 'a
class None
class Some[a]: { val: a }
type Option[a] = None | Some[a]
def None = None {}
def Some val = Some { val }
//│ Defined class None
//│ Defined class Some[+a]
//│ Defined type alias Option[+a]
//│ None: None
//│     = None {}
//│ Some: 'val -> Some['val]
//│     = [Function: Some1]

// let create_hashtbl () = []
def create_hashtbl _ = nil
//│ create_hashtbl: anything -> List[nothing]
//│               = [Function: create_hashtbl]

// let hashtbl_add table key element = (key, element) :: table
def hashtbl_add table key element = cons ((key, element)) table
//│ hashtbl_add: 'a -> (forall 'b. 'b -> (forall 'b, 'c, 'd. ('d -> List[('b, 'd,) | 'c]
//│   where
//│     'a <: List['c])))
//│            = [Function: hashtbl_add]

// let rec find table key = 
//   if nil table then None
//   else if fst (car table) = key then Some (snd (car table))
//   else find (cdr table) key
rec def find table key =
  if is_empty table then None
  else if eq (head table)._1 key then Some (head table)._2
  else find (tail table) key
//│ find: 'b -> (forall 'b, 'a, 'c, 'd, 'val. ('c -> (None | Some['val] | 'd)
//│   where
//│     'find <: List['a] -> 'c -> 'd
//│     'b <: List['b] & List[{_1: 'b}] & List[{_2: 'val}] & List['a])) | 'find
//│     = [Function: find]


// let nfind table key =
//   begin match find table key with
//   | None -> fun f x -> x
//   | Some n -> n
//   end
def nfind table key =
  let opt = find table key in
  case opt of
  { None -> fun f -> fun x -> x
  | Some -> opt.val
  }
//│ ╔══[ERROR] Subtyping constraint of the form `?a <: ?b -> ?c` exceeded recursion depth limit (400)
//│ ║  l.117: 	  let opt = find table key in
//│ ║         	            ^^^^^^^^^^^^^^
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1353',) -> α1354')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1352'
//│ ╟── while constraining:  (α1359'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1350',) -> α1352')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1350',) -> α1352')
//│ ╟── while constraining:  find208'  <!<  ((α1350',) -> α1352')
//│ ╟── while constraining:  find208'  <!<  ((α1330'''',) -> α1332'''')
//│ ╟── while constraining:  (find208' <: ((α1330'''',) -> α1332''''), α209'' <: List['a1342''''], α209'' <: List['a1343''''], α209'' <: List['a1346''''], α209'' <: List['a1331''''] => (α1333'''' -> α1341''''))  <!<  ((α1323',) -> α1324')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1323',) -> α1324')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1322'
//│ ╟── while constraining:  (α1329'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1320',) -> α1322')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1320',) -> α1322')
//│ ╟── while constraining:  find208'  <!<  ((α1320',) -> α1322')
//│ ╟── while constraining:  find208'  <!<  ((α1300'''',) -> α1302'''')
//│ ╟── while constraining:  (find208' <: ((α1300'''',) -> α1302''''), α209'' <: List['a1312''''], α209'' <: List['a1313''''], α209'' <: List['a1316''''], α209'' <: List['a1301''''] => (α1303'''' -> α1311''''))  <!<  ((α1293',) -> α1294')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1293',) -> α1294')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1292'
//│ ╟── while constraining:  (α1299'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1290',) -> α1292')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1290',) -> α1292')
//│ ╟── while constraining:  find208'  <!<  ((α1290',) -> α1292')
//│ ╟── while constraining:  find208'  <!<  ((α1270'''',) -> α1272'''')
//│ ╟── while constraining:  (find208' <: ((α1270'''',) -> α1272''''), α209'' <: List['a1282''''], α209'' <: List['a1283''''], α209'' <: List['a1286''''], α209'' <: List['a1271''''] => (α1273'''' -> α1281''''))  <!<  ((α1263',) -> α1264')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1263',) -> α1264')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1262'
//│ ╟── while constraining:  (α1269'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1260',) -> α1262')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1260',) -> α1262')
//│ ╟── while constraining:  find208'  <!<  ((α1260',) -> α1262')
//│ ╟── while constraining:  find208'  <!<  ((α1240'''',) -> α1242'''')
//│ ╟── while constraining:  (find208' <: ((α1240'''',) -> α1242''''), α209'' <: List['a1252''''], α209'' <: List['a1253''''], α209'' <: List['a1256''''], α209'' <: List['a1241''''] => (α1243'''' -> α1251''''))  <!<  ((α1233',) -> α1234')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1233',) -> α1234')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1232'
//│ ╟── while constraining:  (α1239'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1230',) -> α1232')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1230',) -> α1232')
//│ ╟── while constraining:  find208'  <!<  ((α1230',) -> α1232')
//│ ╟── while constraining:  find208'  <!<  ((α1210'''',) -> α1212'''')
//│ ╟── while constraining:  (find208' <: ((α1210'''',) -> α1212''''), α209'' <: List['a1222''''], α209'' <: List['a1223''''], α209'' <: List['a1226''''], α209'' <: List['a1211''''] => (α1213'''' -> α1221''''))  <!<  ((α1203',) -> α1204')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1203',) -> α1204')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1202'
//│ ╟── while constraining:  (α1209'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1200',) -> α1202')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1200',) -> α1202')
//│ ╟── while constraining:  find208'  <!<  ((α1200',) -> α1202')
//│ ╟── while constraining:  find208'  <!<  ((α1180'''',) -> α1182'''')
//│ ╟── while constraining:  (find208' <: ((α1180'''',) -> α1182''''), α209'' <: List['a1192''''], α209'' <: List['a1193''''], α209'' <: List['a1196''''], α209'' <: List['a1181''''] => (α1183'''' -> α1191''''))  <!<  ((α1173',) -> α1174')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1173',) -> α1174')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1172'
//│ ╟── while constraining:  (α1179'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1170',) -> α1172')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1170',) -> α1172')
//│ ╟── while constraining:  find208'  <!<  ((α1170',) -> α1172')
//│ ╟── while constraining:  find208'  <!<  ((α1150'''',) -> α1152'''')
//│ ╟── while constraining:  (find208' <: ((α1150'''',) -> α1152''''), α209'' <: List['a1162''''], α209'' <: List['a1163''''], α209'' <: List['a1166''''], α209'' <: List['a1151''''] => (α1153'''' -> α1161''''))  <!<  ((α1143',) -> α1144')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1143',) -> α1144')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1142'
//│ ╟── while constraining:  (α1149'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1140',) -> α1142')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1140',) -> α1142')
//│ ╟── while constraining:  find208'  <!<  ((α1140',) -> α1142')
//│ ╟── while constraining:  find208'  <!<  ((α1120'''',) -> α1122'''')
//│ ╟── while constraining:  (find208' <: ((α1120'''',) -> α1122''''), α209'' <: List['a1132''''], α209'' <: List['a1133''''], α209'' <: List['a1136''''], α209'' <: List['a1121''''] => (α1123'''' -> α1131''''))  <!<  ((α1113',) -> α1114')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1113',) -> α1114')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1112'
//│ ╟── while constraining:  (α1119'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1110',) -> α1112')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1110',) -> α1112')
//│ ╟── while constraining:  find208'  <!<  ((α1110',) -> α1112')
//│ ╟── while constraining:  find208'  <!<  ((α1090'''',) -> α1092'''')
//│ ╟── while constraining:  (find208' <: ((α1090'''',) -> α1092''''), α209'' <: List['a1102''''], α209'' <: List['a1103''''], α209'' <: List['a1106''''], α209'' <: List['a1091''''] => (α1093'''' -> α1101''''))  <!<  ((α1083',) -> α1084')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1083',) -> α1084')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1082'
//│ ╟── while constraining:  (α1089'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1080',) -> α1082')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1080',) -> α1082')
//│ ╟── while constraining:  find208'  <!<  ((α1080',) -> α1082')
//│ ╟── while constraining:  find208'  <!<  ((α1060'''',) -> α1062'''')
//│ ╟── while constraining:  (find208' <: ((α1060'''',) -> α1062''''), α209'' <: List['a1072''''], α209'' <: List['a1073''''], α209'' <: List['a1076''''], α209'' <: List['a1061''''] => (α1063'''' -> α1071''''))  <!<  ((α1053',) -> α1054')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1053',) -> α1054')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1052'
//│ ╟── while constraining:  (α1059'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1050',) -> α1052')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1050',) -> α1052')
//│ ╟── while constraining:  find208'  <!<  ((α1050',) -> α1052')
//│ ╟── while constraining:  find208'  <!<  ((α1030'''',) -> α1032'''')
//│ ╟── while constraining:  (find208' <: ((α1030'''',) -> α1032''''), α209'' <: List['a1042''''], α209'' <: List['a1043''''], α209'' <: List['a1046''''], α209'' <: List['a1031''''] => (α1033'''' -> α1041''''))  <!<  ((α1023',) -> α1024')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α1023',) -> α1024')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α1022'
//│ ╟── while constraining:  (α1029'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α1020',) -> α1022')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α1020',) -> α1022')
//│ ╟── while constraining:  find208'  <!<  ((α1020',) -> α1022')
//│ ╟── while constraining:  find208'  <!<  ((α1000'''',) -> α1002'''')
//│ ╟── while constraining:  (find208' <: ((α1000'''',) -> α1002''''), α209'' <: List['a1012''''], α209'' <: List['a1013''''], α209'' <: List['a1016''''], α209'' <: List['a1001''''] => (α1003'''' -> α1011''''))  <!<  ((α993',) -> α994')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α993',) -> α994')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α992'
//│ ╟── while constraining:  (α999'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α990',) -> α992')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α990',) -> α992')
//│ ╟── while constraining:  find208'  <!<  ((α990',) -> α992')
//│ ╟── while constraining:  find208'  <!<  ((α970'''',) -> α972'''')
//│ ╟── while constraining:  (find208' <: ((α970'''',) -> α972''''), α209'' <: List['a982''''], α209'' <: List['a983''''], α209'' <: List['a986''''], α209'' <: List['a971''''] => (α973'''' -> α981''''))  <!<  ((α963',) -> α964')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α963',) -> α964')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α962'
//│ ╟── while constraining:  (α969'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α960',) -> α962')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α960',) -> α962')
//│ ╟── while constraining:  find208'  <!<  ((α960',) -> α962')
//│ ╟── while constraining:  find208'  <!<  ((α940'''',) -> α942'''')
//│ ╟── while constraining:  (find208' <: ((α940'''',) -> α942''''), α209'' <: List['a952''''], α209'' <: List['a953''''], α209'' <: List['a956''''], α209'' <: List['a941''''] => (α943'''' -> α951''''))  <!<  ((α933',) -> α934')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α933',) -> α934')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α932'
//│ ╟── while constraining:  (α939'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α930',) -> α932')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α930',) -> α932')
//│ ╟── while constraining:  find208'  <!<  ((α930',) -> α932')
//│ ╟── while constraining:  find208'  <!<  ((α910'''',) -> α912'''')
//│ ╟── while constraining:  (find208' <: ((α910'''',) -> α912''''), α209'' <: List['a922''''], α209'' <: List['a923''''], α209'' <: List['a926''''], α209'' <: List['a911''''] => (α913'''' -> α921''''))  <!<  ((α903',) -> α904')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α903',) -> α904')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α902'
//│ ╟── while constraining:  (α909'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α900',) -> α902')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α900',) -> α902')
//│ ╟── while constraining:  find208'  <!<  ((α900',) -> α902')
//│ ╟── while constraining:  find208'  <!<  ((α880'''',) -> α882'''')
//│ ╟── while constraining:  (find208' <: ((α880'''',) -> α882''''), α209'' <: List['a892''''], α209'' <: List['a893''''], α209'' <: List['a896''''], α209'' <: List['a881''''] => (α883'''' -> α891''''))  <!<  ((α873',) -> α874')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α873',) -> α874')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α872'
//│ ╟── while constraining:  (α879'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α870',) -> α872')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α870',) -> α872')
//│ ╟── while constraining:  find208'  <!<  ((α870',) -> α872')
//│ ╟── while constraining:  find208'  <!<  ((α850'''',) -> α852'''')
//│ ╟── while constraining:  (find208' <: ((α850'''',) -> α852''''), α209'' <: List['a862''''], α209'' <: List['a863''''], α209'' <: List['a866''''], α209'' <: List['a851''''] => (α853'''' -> α861''''))  <!<  ((α843',) -> α844')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α843',) -> α844')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α842'
//│ ╟── while constraining:  (α849'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α840',) -> α842')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α840',) -> α842')
//│ ╟── while constraining:  find208'  <!<  ((α840',) -> α842')
//│ ╟── while constraining:  find208'  <!<  ((α820'''',) -> α822'''')
//│ ╟── while constraining:  (find208' <: ((α820'''',) -> α822''''), α209'' <: List['a832''''], α209'' <: List['a833''''], α209'' <: List['a836''''], α209'' <: List['a821''''] => (α823'''' -> α831''''))  <!<  ((α813',) -> α814')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α813',) -> α814')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α812'
//│ ╟── while constraining:  (α819'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α810',) -> α812')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α810',) -> α812')
//│ ╟── while constraining:  find208'  <!<  ((α810',) -> α812')
//│ ╟── while constraining:  find208'  <!<  ((α790'''',) -> α792'''')
//│ ╟── while constraining:  (find208' <: ((α790'''',) -> α792''''), α209'' <: List['a802''''], α209'' <: List['a803''''], α209'' <: List['a806''''], α209'' <: List['a791''''] => (α793'''' -> α801''''))  <!<  ((α783',) -> α784')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α783',) -> α784')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α782'
//│ ╟── while constraining:  (α789'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α780',) -> α782')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α780',) -> α782')
//│ ╟── while constraining:  find208'  <!<  ((α780',) -> α782')
//│ ╟── while constraining:  find208'  <!<  ((α760'''',) -> α762'''')
//│ ╟── while constraining:  (find208' <: ((α760'''',) -> α762''''), α209'' <: List['a772''''], α209'' <: List['a773''''], α209'' <: List['a776''''], α209'' <: List['a761''''] => (α763'''' -> α771''''))  <!<  ((α753',) -> α754')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α753',) -> α754')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α752'
//│ ╟── while constraining:  (α759'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α750',) -> α752')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α750',) -> α752')
//│ ╟── while constraining:  find208'  <!<  ((α750',) -> α752')
//│ ╟── while constraining:  find208'  <!<  ((α730'''',) -> α732'''')
//│ ╟── while constraining:  (find208' <: ((α730'''',) -> α732''''), α209'' <: List['a742''''], α209'' <: List['a743''''], α209'' <: List['a746''''], α209'' <: List['a731''''] => (α733'''' -> α741''''))  <!<  ((α723',) -> α724')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α723',) -> α724')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α722'
//│ ╟── while constraining:  (α729'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α720',) -> α722')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α720',) -> α722')
//│ ╟── while constraining:  find208'  <!<  ((α720',) -> α722')
//│ ╟── while constraining:  find208'  <!<  ((α700'''',) -> α702'''')
//│ ╟── while constraining:  (find208' <: ((α700'''',) -> α702''''), α209'' <: List['a712''''], α209'' <: List['a713''''], α209'' <: List['a716''''], α209'' <: List['a701''''] => (α703'''' -> α711''''))  <!<  ((α693',) -> α694')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α693',) -> α694')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α692'
//│ ╟── while constraining:  (α699'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α690',) -> α692')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α690',) -> α692')
//│ ╟── while constraining:  find208'  <!<  ((α690',) -> α692')
//│ ╟── while constraining:  find208'  <!<  ((α670'''',) -> α672'''')
//│ ╟── while constraining:  (find208' <: ((α670'''',) -> α672''''), α209'' <: List['a682''''], α209'' <: List['a683''''], α209'' <: List['a686''''], α209'' <: List['a671''''] => (α673'''' -> α681''''))  <!<  ((α663',) -> α664')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α663',) -> α664')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α662'
//│ ╟── while constraining:  (α669'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α660',) -> α662')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α660',) -> α662')
//│ ╟── while constraining:  find208'  <!<  ((α660',) -> α662')
//│ ╟── while constraining:  find208'  <!<  ((α640'''',) -> α642'''')
//│ ╟── while constraining:  (find208' <: ((α640'''',) -> α642''''), α209'' <: List['a652''''], α209'' <: List['a653''''], α209'' <: List['a656''''], α209'' <: List['a641''''] => (α643'''' -> α651''''))  <!<  ((α633',) -> α634')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α633',) -> α634')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α632'
//│ ╟── while constraining:  (α639'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α630',) -> α632')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α630',) -> α632')
//│ ╟── while constraining:  find208'  <!<  ((α630',) -> α632')
//│ ╟── while constraining:  find208'  <!<  ((α610'''',) -> α612'''')
//│ ╟── while constraining:  (find208' <: ((α610'''',) -> α612''''), α209'' <: List['a622''''], α209'' <: List['a623''''], α209'' <: List['a626''''], α209'' <: List['a611''''] => (α613'''' -> α621''''))  <!<  ((α603',) -> α604')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α603',) -> α604')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α602'
//│ ╟── while constraining:  (α609'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α600',) -> α602')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α600',) -> α602')
//│ ╟── while constraining:  find208'  <!<  ((α600',) -> α602')
//│ ╟── while constraining:  find208'  <!<  ((α580'''',) -> α582'''')
//│ ╟── while constraining:  (find208' <: ((α580'''',) -> α582''''), α209'' <: List['a592''''], α209'' <: List['a593''''], α209'' <: List['a596''''], α209'' <: List['a581''''] => (α583'''' -> α591''''))  <!<  ((α573',) -> α574')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α573',) -> α574')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α572'
//│ ╟── while constraining:  (α579'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α570',) -> α572')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α570',) -> α572')
//│ ╟── while constraining:  find208'  <!<  ((α570',) -> α572')
//│ ╟── while constraining:  find208'  <!<  ((α550'''',) -> α552'''')
//│ ╟── while constraining:  (find208' <: ((α550'''',) -> α552''''), α209'' <: List['a562''''], α209'' <: List['a563''''], α209'' <: List['a566''''], α209'' <: List['a551''''] => (α553'''' -> α561''''))  <!<  ((α543',) -> α544')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α543',) -> α544')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α542'
//│ ╟── while constraining:  (α549'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α540',) -> α542')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α540',) -> α542')
//│ ╟── while constraining:  find208'  <!<  ((α540',) -> α542')
//│ ╟── while constraining:  find208'  <!<  ((α520'''',) -> α522'''')
//│ ╟── while constraining:  (find208' <: ((α520'''',) -> α522''''), α209'' <: List['a532''''], α209'' <: List['a533''''], α209'' <: List['a536''''], α209'' <: List['a521''''] => (α523'''' -> α531''''))  <!<  ((α513',) -> α514')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α513',) -> α514')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α512'
//│ ╟── while constraining:  (α519'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α510',) -> α512')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α510',) -> α512')
//│ ╟── while constraining:  find208'  <!<  ((α510',) -> α512')
//│ ╟── while constraining:  find208'  <!<  ((α490'''',) -> α492'''')
//│ ╟── while constraining:  (find208' <: ((α490'''',) -> α492''''), α209'' <: List['a502''''], α209'' <: List['a503''''], α209'' <: List['a506''''], α209'' <: List['a491''''] => (α493'''' -> α501''''))  <!<  ((α483',) -> α484')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α483',) -> α484')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α482'
//│ ╟── while constraining:  (α489'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α480',) -> α482')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α480',) -> α482')
//│ ╟── while constraining:  find208'  <!<  ((α480',) -> α482')
//│ ╟── while constraining:  find208'  <!<  ((α460'''',) -> α462'''')
//│ ╟── while constraining:  (find208' <: ((α460'''',) -> α462''''), α209'' <: List['a472''''], α209'' <: List['a473''''], α209'' <: List['a476''''], α209'' <: List['a461''''] => (α463'''' -> α471''''))  <!<  ((α453',) -> α454')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α453',) -> α454')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α452'
//│ ╟── while constraining:  (α459'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α450',) -> α452')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α450',) -> α452')
//│ ╟── while constraining:  find208'  <!<  ((α450',) -> α452')
//│ ╟── while constraining:  find208'  <!<  ((α430'''',) -> α432'''')
//│ ╟── while constraining:  (find208' <: ((α430'''',) -> α432''''), α209'' <: List['a442''''], α209'' <: List['a443''''], α209'' <: List['a446''''], α209'' <: List['a431''''] => (α433'''' -> α441''''))  <!<  ((α423',) -> α424')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α423',) -> α424')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α422'
//│ ╟── while constraining:  (α429'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α420',) -> α422')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α420',) -> α422')
//│ ╟── while constraining:  find208'  <!<  ((α420',) -> α422')
//│ ╟── while constraining:  find208'  <!<  ((α400'''',) -> α402'''')
//│ ╟── while constraining:  (find208' <: ((α400'''',) -> α402''''), α209'' <: List['a412''''], α209'' <: List['a413''''], α209'' <: List['a416''''], α209'' <: List['a401''''] => (α403'''' -> α411''''))  <!<  ((α393',) -> α394')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α393',) -> α394')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α392'
//│ ╟── while constraining:  (α399'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α390',) -> α392')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α390',) -> α392')
//│ ╟── while constraining:  find208'  <!<  ((α390',) -> α392')
//│ ╟── while constraining:  find208'  <!<  ((α370'''',) -> α372'''')
//│ ╟── while constraining:  (find208' <: ((α370'''',) -> α372''''), α209'' <: List['a382''''], α209'' <: List['a383''''], α209'' <: List['a386''''], α209'' <: List['a371''''] => (α373'''' -> α381''''))  <!<  ((α363',) -> α364')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α363',) -> α364')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α362'
//│ ╟── while constraining:  (α369'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α360',) -> α362')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α360',) -> α362')
//│ ╟── while constraining:  find208'  <!<  ((α360',) -> α362')
//│ ╟── while constraining:  find208'  <!<  ((α340'''',) -> α342'''')
//│ ╟── while constraining:  (find208' <: ((α340'''',) -> α342''''), α209'' <: List['a352''''], α209'' <: List['a353''''], α209'' <: List['a356''''], α209'' <: List['a341''''] => (α343'''' -> α351''''))  <!<  ((α333',) -> α334')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α333',) -> α334')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α332'
//│ ╟── while constraining:  (α339'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α330',) -> α332')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α330',) -> α332')
//│ ╟── while constraining:  find208'  <!<  ((α330',) -> α332')
//│ ╟── while constraining:  find208'  <!<  ((α310'''',) -> α312'''')
//│ ╟── while constraining:  (find208' <: ((α310'''',) -> α312''''), α209'' <: List['a322''''], α209'' <: List['a323''''], α209'' <: List['a326''''], α209'' <: List['a311''''] => (α313'''' -> α321''''))  <!<  ((α303',) -> α304')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α303',) -> α304')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  α302'
//│ ╟── while constraining:  (α309'''' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)  <!<  ((α300',) -> α302')
//│ ╟── while constraining:  ‹∀ 1. (α209'' -> ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›)›  <!<  ((α300',) -> α302')
//│ ╟── while constraining:  find208'  <!<  ((α300',) -> α302')
//│ ╟── while constraining:  find208'  <!<  ((α280'''',) -> α282'''')
//│ ╟── while constraining:  (find208' <: ((α280'''',) -> α282''''), α209'' <: List['a292''''], α209'' <: List['a293''''], α209'' <: List['a296''''], α209'' <: List['a281''''] => (α283'''' -> α291''''))  <!<  ((α275''',) -> α279'''')
//│ ╟── while constraining:  ‹∀ 2. (find208' <: ((α233''',) -> α235'''), α209'' <: List['a212'''], α209'' <: List['a217'''], α209'' <: List['a225'''], α209'' <: List['a234'''] => (α210''' -> α238'''))›  <!<  ((α275''',) -> α279'''')
//│ ╙── while constraining:  α276''''  <!<  ((α275''',) -> α279'''')
//│ nfind: anything -> anything -> anything -> (forall 'a. 'a -> 'a)
//│      = [Function: nfind]

// type Int = ['a] ('a -> 'a) -> ('a -> 'a)
type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ Defined type alias ChurchInt

// let succ (n:Int) = fun f x -> f (n f x)
def succ (n: ChurchInt) = fun f -> fun x -> f (n f x)
def succ' n = fun f -> fun x -> f (n f x)
//│ succ: ChurchInt -> (forall 'a. 'a -> (forall 'a, 'b, 'c, 'd. ('b -> 'd
//│   where
//│     'e <: 'a -> 'b -> 'c
//│     'a <: 'c -> 'd)))
//│     = [Function: succ]
//│ succ': 'a -> (forall 'b. 'b -> (forall 'b, 'c, 'd, 'e. ('c -> 'e
//│   where
//│     'a <: 'b -> 'c -> 'd
//│     'b <: 'd -> 'e)))
//│      = [Function: succ]

// let add (n:Int) (m:Int) = n succ m
def add (n: ChurchInt) (m: ChurchInt) = n succ m
def add' n m = n succ' m
//│ add: ChurchInt -> (ChurchInt -> 'a
//│   where
//│     'b <: (ChurchInt -> (forall 'c. 'c -> (forall 'c, 'd, 'e, 'f. ('d -> 'f
//│   where
//│     'g <: 'c -> 'd -> 'e
//│     'c <: 'e -> 'f)))) -> ChurchInt -> 'a)
//│    = [Function: add]
//│ add': 'a -> ('b -> 'c
//│   where
//│     'a <: (forall 'd. 'd -> (forall 'e. 'e -> (forall 'e, 'f, 'g, 'h. ('f -> 'h
//│   where
//│     'd <: 'e -> 'f -> 'g
//│     'e <: 'g -> 'h)))) -> 'b -> 'c)
//│     = [Function: add]

// let printInt (n:Int) = print (n (fun x -> x+1) 0)
def printInt (n: ChurchInt) = toString (n (fun x -> x + 1) 0)
def printInt' n = toString (n (fun x -> x + 1) 0)
//│ printInt: ChurchInt -> string
//│         = [Function: printInt]
//│ printInt': ((int -> int) -> 0 -> anything) -> string
//│          = [Function: printInt]

// let table = create_hashtbl ()
// let table = hashtbl_add table "one" (fun f x -> f x)
// let table = hashtbl_add table "two" (fun f x -> f (f x))
table = create_hashtbl null
table = hashtbl_add table "one" (fun f -> fun x -> f x)
table = hashtbl_add table "two" (fun f -> fun x -> f (f x))
//│ table: List[nothing]
//│      = Nil {}
//│ table: List[("one", forall 'a. 'a -> (forall 'b, 'c. ('b -> 'c
//│   where
//│     'a <: 'b -> 'c)),)]
//│      = Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│ table: List[("two", forall 'a. 'a -> (forall 'b, 'c, 'd. ('b -> 'd
//│   where
//│     'a <: 'b -> 'c & 'c -> 'd)),)]
//│      = Cons {
//│          head: [ 'two', [Function (anonymous)] ],
//│          tail: Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│        }

// let zog =
//   printInt (add (nfind table "one") (nfind table "two"))
zog = printInt (add (nfind table "one") (nfind table "two"))
zog' = printInt' (add' (nfind table "one") (nfind table "two"))
//│ zog: string
//│    = '0'
//│ zog': string
//│     = '0'
