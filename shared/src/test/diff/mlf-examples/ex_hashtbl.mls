:GeneralizeCurriedFunctions

// ============ Dummy classes to represent the types in the examples ============

class List[a]
  method Head: a
  method Tail: List[a]
//│ Defined class List[+a]
//│ Declared List.Head: List['a] -> 'a
//│ Declared List.Tail: List['a] -> List['a]

class Cons[a]: List[a] & { head: a; tail: List[a] }
  method Head = this.head
  method Tail = this.tail
def cons[a]: a -> List[a] -> List[a]
def cons head tail = Cons { head; tail }
//│ Defined class Cons[+a]
//│ Defined Cons.Head: Cons['a] -> 'a
//│ Defined Cons.Tail: Cons['a] -> List['a]
//│ cons: 'a -> List['a] -> List['a]
//│     = <missing implementation>
//│ 'b -> (forall 'a, 'tail. (List['a] & 'tail) -> (Cons['a | 'b] with {head: 'b, tail: 'tail}))
//│   <:  cons:
//│ 'a -> List['a] -> List['a]
//│     = [Function: cons]

class Nil[a]: List[a]
  method Head = error
  method Tail = this
def nil: List['a]
def nil = Nil {}
//│ Defined class Nil[+a]
//│ Defined Nil.Head: Nil[?] -> nothing
//│ Defined Nil.Tail: (Nil['a] & 'this) -> (Nil['a] & 'this)
//│ nil: List[nothing]
//│    = <missing implementation>
//│ Nil[nothing]
//│   <:  nil:
//│ List[nothing]
//│    = Nil {}

// ============ Type signatures for functions used in the examples ============

def head: forall 'a. List['a] -> 'a
def head l = l.Head
//│ head: List['a] -> 'a
//│     = <missing implementation>
//│ List['a] -> 'a
//│   <:  head:
//│ List['a] -> 'a
//│     = [Function: head]

def tail: forall 'a. List['a] -> List['a]
def tail l = l.Tail
//│ tail: List['a] -> List['a]
//│     = <missing implementation>
//│ List['a] -> List['a]
//│   <:  tail:
//│ List['a] -> List['a]
//│     = [Function: tail]

def is_empty: forall 'a. List['a] -> bool
def is_empty l = eq l nil
//│ is_empty: List[?] -> bool
//│         = <missing implementation>
//│ anything -> bool
//│   <:  is_empty:
//│ List[?] -> bool
//│         = [Function: is_empty]



// (* Use the value restriction ! *)

// type option ('a) = None | Some of 'a
class None
class Some[a]: { val: a }
type Option[a] = None | Some[a]
def None = None {}
def Some val = Some { val }
//│ Defined class None
//│ Defined class Some[+a]
//│ Defined type alias Option[+a]
//│ None: None
//│     = None {}
//│ Some: 'val -> Some['val]
//│     = [Function: Some1]

// let create_hashtbl () = []
def create_hashtbl _ = nil
//│ create_hashtbl: anything -> List[nothing]
//│               = [Function: create_hashtbl]

// let hashtbl_add table key element = (key, element) :: table
def hashtbl_add table key element = cons ((key, element)) table
//│ hashtbl_add: 'a -> (forall 'b. 'b -> (forall 'a, 'b, 'c, 'd. ('d -> List[('b, 'd,) | 'c]
//│   where
//│     'a <: List['c])))
//│            = [Function: hashtbl_add]

// let rec find table key = 
//   if nil table then None
//   else if fst (car table) = key then Some (snd (car table))
//   else find (cdr table) key
rec def find table key =
  if is_empty table then None
  else if eq (head table)._1 key then Some (head table)._2
  else find (tail table) key
//│ find: 'a -> (forall 'a, 'val, 'b, 'c, 'd. ('c -> (None | Some['val] | 'd)
//│   where
//│     'a <: List['a] & List[{_1: 'a}] & List[{_2: 'val}]
//│     'b <: 'c -> 'd))
//│     = [Function: find]


// let nfind table key =
//   begin match find table key with
//   | None -> fun f x -> x
//   | Some n -> n
//   end
def nfind table key =
  let opt = find table key in
  case opt of
  { None -> fun f -> fun x -> x
  | Some -> opt.val
  }
//│ ╔══[ERROR] Subtyping constraint of the form `?a <: ?b -> ?c` exceeded recursion depth limit (400)
//│ ║  l.122: 	  let opt = find table key in
//│ ║         	            ^^^^^^^^^^^^^^
//│ ╟── while constraining:  List['a2013'''']  <!<  List['a2015'''']
//│ ╟── while constraining:  α2012''''  <!<  List['a2015'''']
//│ ╟── while constraining:  {(α2027'''' -> α2032'''') where: α2012'''' <: List['a2015''''], α2012'''' <: List['a2016''''], α2012'''' <: List['a2020''''], α2012'''' <: List['a2026''''], α2014'''' <: ((α2027'''',) -> α2028'''')}  <!<  ((α2006'''',) -> α2007'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α2006'''',) -> α2007'''')
//│ ╟── while constraining:  α1993''''  <!<  ((α2006'''',) -> α2007'''')
//│ ╟── while constraining:  {(α2006'''' -> α2011'''') where: α1991'''' <: List['a1994''''], α1991'''' <: List['a1995''''], α1991'''' <: List['a1999''''], α1991'''' <: List['a2005''''], α1993'''' <: ((α2006'''',) -> α2007'''')}  <!<  ((α1985'''',) -> α1986'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1985'''',) -> α1986'''')
//│ ╟── while constraining:  α1972''''  <!<  ((α1985'''',) -> α1986'''')
//│ ╟── while constraining:  {(α1985'''' -> α1990'''') where: α1970'''' <: List['a1973''''], α1970'''' <: List['a1974''''], α1970'''' <: List['a1978''''], α1970'''' <: List['a1984''''], α1972'''' <: ((α1985'''',) -> α1986'''')}  <!<  ((α1964'''',) -> α1965'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1964'''',) -> α1965'''')
//│ ╟── while constraining:  α1951''''  <!<  ((α1964'''',) -> α1965'''')
//│ ╟── while constraining:  {(α1964'''' -> α1969'''') where: α1949'''' <: List['a1952''''], α1949'''' <: List['a1953''''], α1949'''' <: List['a1957''''], α1949'''' <: List['a1963''''], α1951'''' <: ((α1964'''',) -> α1965'''')}  <!<  ((α1943'''',) -> α1944'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1943'''',) -> α1944'''')
//│ ╟── while constraining:  α1930''''  <!<  ((α1943'''',) -> α1944'''')
//│ ╟── while constraining:  {(α1943'''' -> α1948'''') where: α1928'''' <: List['a1931''''], α1928'''' <: List['a1932''''], α1928'''' <: List['a1936''''], α1928'''' <: List['a1942''''], α1930'''' <: ((α1943'''',) -> α1944'''')}  <!<  ((α1922'''',) -> α1923'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1922'''',) -> α1923'''')
//│ ╟── while constraining:  α1909''''  <!<  ((α1922'''',) -> α1923'''')
//│ ╟── while constraining:  {(α1922'''' -> α1927'''') where: α1907'''' <: List['a1910''''], α1907'''' <: List['a1911''''], α1907'''' <: List['a1915''''], α1907'''' <: List['a1921''''], α1909'''' <: ((α1922'''',) -> α1923'''')}  <!<  ((α1901'''',) -> α1902'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1901'''',) -> α1902'''')
//│ ╟── while constraining:  α1888''''  <!<  ((α1901'''',) -> α1902'''')
//│ ╟── while constraining:  {(α1901'''' -> α1906'''') where: α1886'''' <: List['a1889''''], α1886'''' <: List['a1890''''], α1886'''' <: List['a1894''''], α1886'''' <: List['a1900''''], α1888'''' <: ((α1901'''',) -> α1902'''')}  <!<  ((α1880'''',) -> α1881'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1880'''',) -> α1881'''')
//│ ╟── while constraining:  α1867''''  <!<  ((α1880'''',) -> α1881'''')
//│ ╟── while constraining:  {(α1880'''' -> α1885'''') where: α1865'''' <: List['a1868''''], α1865'''' <: List['a1869''''], α1865'''' <: List['a1873''''], α1865'''' <: List['a1879''''], α1867'''' <: ((α1880'''',) -> α1881'''')}  <!<  ((α1859'''',) -> α1860'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1859'''',) -> α1860'''')
//│ ╟── while constraining:  α1846''''  <!<  ((α1859'''',) -> α1860'''')
//│ ╟── while constraining:  {(α1859'''' -> α1864'''') where: α1844'''' <: List['a1847''''], α1844'''' <: List['a1848''''], α1844'''' <: List['a1852''''], α1844'''' <: List['a1858''''], α1846'''' <: ((α1859'''',) -> α1860'''')}  <!<  ((α1838'''',) -> α1839'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1838'''',) -> α1839'''')
//│ ╟── while constraining:  α1825''''  <!<  ((α1838'''',) -> α1839'''')
//│ ╟── while constraining:  {(α1838'''' -> α1843'''') where: α1823'''' <: List['a1826''''], α1823'''' <: List['a1827''''], α1823'''' <: List['a1831''''], α1823'''' <: List['a1837''''], α1825'''' <: ((α1838'''',) -> α1839'''')}  <!<  ((α1817'''',) -> α1818'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1817'''',) -> α1818'''')
//│ ╟── while constraining:  α1804''''  <!<  ((α1817'''',) -> α1818'''')
//│ ╟── while constraining:  {(α1817'''' -> α1822'''') where: α1802'''' <: List['a1805''''], α1802'''' <: List['a1806''''], α1802'''' <: List['a1810''''], α1802'''' <: List['a1816''''], α1804'''' <: ((α1817'''',) -> α1818'''')}  <!<  ((α1796'''',) -> α1797'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1796'''',) -> α1797'''')
//│ ╟── while constraining:  α1783''''  <!<  ((α1796'''',) -> α1797'''')
//│ ╟── while constraining:  {(α1796'''' -> α1801'''') where: α1781'''' <: List['a1784''''], α1781'''' <: List['a1785''''], α1781'''' <: List['a1789''''], α1781'''' <: List['a1795''''], α1783'''' <: ((α1796'''',) -> α1797'''')}  <!<  ((α1775'''',) -> α1776'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1775'''',) -> α1776'''')
//│ ╟── while constraining:  α1762''''  <!<  ((α1775'''',) -> α1776'''')
//│ ╟── while constraining:  {(α1775'''' -> α1780'''') where: α1760'''' <: List['a1763''''], α1760'''' <: List['a1764''''], α1760'''' <: List['a1768''''], α1760'''' <: List['a1774''''], α1762'''' <: ((α1775'''',) -> α1776'''')}  <!<  ((α1754'''',) -> α1755'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1754'''',) -> α1755'''')
//│ ╟── while constraining:  α1741''''  <!<  ((α1754'''',) -> α1755'''')
//│ ╟── while constraining:  {(α1754'''' -> α1759'''') where: α1739'''' <: List['a1742''''], α1739'''' <: List['a1743''''], α1739'''' <: List['a1747''''], α1739'''' <: List['a1753''''], α1741'''' <: ((α1754'''',) -> α1755'''')}  <!<  ((α1733'''',) -> α1734'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1733'''',) -> α1734'''')
//│ ╟── while constraining:  α1720''''  <!<  ((α1733'''',) -> α1734'''')
//│ ╟── while constraining:  {(α1733'''' -> α1738'''') where: α1718'''' <: List['a1721''''], α1718'''' <: List['a1722''''], α1718'''' <: List['a1726''''], α1718'''' <: List['a1732''''], α1720'''' <: ((α1733'''',) -> α1734'''')}  <!<  ((α1712'''',) -> α1713'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1712'''',) -> α1713'''')
//│ ╟── while constraining:  α1699''''  <!<  ((α1712'''',) -> α1713'''')
//│ ╟── while constraining:  {(α1712'''' -> α1717'''') where: α1697'''' <: List['a1700''''], α1697'''' <: List['a1701''''], α1697'''' <: List['a1705''''], α1697'''' <: List['a1711''''], α1699'''' <: ((α1712'''',) -> α1713'''')}  <!<  ((α1691'''',) -> α1692'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1691'''',) -> α1692'''')
//│ ╟── while constraining:  α1678''''  <!<  ((α1691'''',) -> α1692'''')
//│ ╟── while constraining:  {(α1691'''' -> α1696'''') where: α1676'''' <: List['a1679''''], α1676'''' <: List['a1680''''], α1676'''' <: List['a1684''''], α1676'''' <: List['a1690''''], α1678'''' <: ((α1691'''',) -> α1692'''')}  <!<  ((α1670'''',) -> α1671'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1670'''',) -> α1671'''')
//│ ╟── while constraining:  α1657''''  <!<  ((α1670'''',) -> α1671'''')
//│ ╟── while constraining:  {(α1670'''' -> α1675'''') where: α1655'''' <: List['a1658''''], α1655'''' <: List['a1659''''], α1655'''' <: List['a1663''''], α1655'''' <: List['a1669''''], α1657'''' <: ((α1670'''',) -> α1671'''')}  <!<  ((α1649'''',) -> α1650'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1649'''',) -> α1650'''')
//│ ╟── while constraining:  α1636''''  <!<  ((α1649'''',) -> α1650'''')
//│ ╟── while constraining:  {(α1649'''' -> α1654'''') where: α1634'''' <: List['a1637''''], α1634'''' <: List['a1638''''], α1634'''' <: List['a1642''''], α1634'''' <: List['a1648''''], α1636'''' <: ((α1649'''',) -> α1650'''')}  <!<  ((α1628'''',) -> α1629'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1628'''',) -> α1629'''')
//│ ╟── while constraining:  α1615''''  <!<  ((α1628'''',) -> α1629'''')
//│ ╟── while constraining:  {(α1628'''' -> α1633'''') where: α1613'''' <: List['a1616''''], α1613'''' <: List['a1617''''], α1613'''' <: List['a1621''''], α1613'''' <: List['a1627''''], α1615'''' <: ((α1628'''',) -> α1629'''')}  <!<  ((α1607'''',) -> α1608'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1607'''',) -> α1608'''')
//│ ╟── while constraining:  α1594''''  <!<  ((α1607'''',) -> α1608'''')
//│ ╟── while constraining:  {(α1607'''' -> α1612'''') where: α1592'''' <: List['a1595''''], α1592'''' <: List['a1596''''], α1592'''' <: List['a1600''''], α1592'''' <: List['a1606''''], α1594'''' <: ((α1607'''',) -> α1608'''')}  <!<  ((α1586'''',) -> α1587'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1586'''',) -> α1587'''')
//│ ╟── while constraining:  α1573''''  <!<  ((α1586'''',) -> α1587'''')
//│ ╟── while constraining:  {(α1586'''' -> α1591'''') where: α1571'''' <: List['a1574''''], α1571'''' <: List['a1575''''], α1571'''' <: List['a1579''''], α1571'''' <: List['a1585''''], α1573'''' <: ((α1586'''',) -> α1587'''')}  <!<  ((α1565'''',) -> α1566'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1565'''',) -> α1566'''')
//│ ╟── while constraining:  α1552''''  <!<  ((α1565'''',) -> α1566'''')
//│ ╟── while constraining:  {(α1565'''' -> α1570'''') where: α1550'''' <: List['a1553''''], α1550'''' <: List['a1554''''], α1550'''' <: List['a1558''''], α1550'''' <: List['a1564''''], α1552'''' <: ((α1565'''',) -> α1566'''')}  <!<  ((α1544'''',) -> α1545'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1544'''',) -> α1545'''')
//│ ╟── while constraining:  α1531''''  <!<  ((α1544'''',) -> α1545'''')
//│ ╟── while constraining:  {(α1544'''' -> α1549'''') where: α1529'''' <: List['a1532''''], α1529'''' <: List['a1533''''], α1529'''' <: List['a1537''''], α1529'''' <: List['a1543''''], α1531'''' <: ((α1544'''',) -> α1545'''')}  <!<  ((α1523'''',) -> α1524'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1523'''',) -> α1524'''')
//│ ╟── while constraining:  α1510''''  <!<  ((α1523'''',) -> α1524'''')
//│ ╟── while constraining:  {(α1523'''' -> α1528'''') where: α1508'''' <: List['a1511''''], α1508'''' <: List['a1512''''], α1508'''' <: List['a1516''''], α1508'''' <: List['a1522''''], α1510'''' <: ((α1523'''',) -> α1524'''')}  <!<  ((α1502'''',) -> α1503'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1502'''',) -> α1503'''')
//│ ╟── while constraining:  α1489''''  <!<  ((α1502'''',) -> α1503'''')
//│ ╟── while constraining:  {(α1502'''' -> α1507'''') where: α1487'''' <: List['a1490''''], α1487'''' <: List['a1491''''], α1487'''' <: List['a1495''''], α1487'''' <: List['a1501''''], α1489'''' <: ((α1502'''',) -> α1503'''')}  <!<  ((α1481'''',) -> α1482'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1481'''',) -> α1482'''')
//│ ╟── while constraining:  α1468''''  <!<  ((α1481'''',) -> α1482'''')
//│ ╟── while constraining:  {(α1481'''' -> α1486'''') where: α1466'''' <: List['a1469''''], α1466'''' <: List['a1470''''], α1466'''' <: List['a1474''''], α1466'''' <: List['a1480''''], α1468'''' <: ((α1481'''',) -> α1482'''')}  <!<  ((α1460'''',) -> α1461'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1460'''',) -> α1461'''')
//│ ╟── while constraining:  α1447''''  <!<  ((α1460'''',) -> α1461'''')
//│ ╟── while constraining:  {(α1460'''' -> α1465'''') where: α1445'''' <: List['a1448''''], α1445'''' <: List['a1449''''], α1445'''' <: List['a1453''''], α1445'''' <: List['a1459''''], α1447'''' <: ((α1460'''',) -> α1461'''')}  <!<  ((α1439'''',) -> α1440'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1439'''',) -> α1440'''')
//│ ╟── while constraining:  α1426''''  <!<  ((α1439'''',) -> α1440'''')
//│ ╟── while constraining:  {(α1439'''' -> α1444'''') where: α1424'''' <: List['a1427''''], α1424'''' <: List['a1428''''], α1424'''' <: List['a1432''''], α1424'''' <: List['a1438''''], α1426'''' <: ((α1439'''',) -> α1440'''')}  <!<  ((α1418'''',) -> α1419'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1418'''',) -> α1419'''')
//│ ╟── while constraining:  α1405''''  <!<  ((α1418'''',) -> α1419'''')
//│ ╟── while constraining:  {(α1418'''' -> α1423'''') where: α1403'''' <: List['a1406''''], α1403'''' <: List['a1407''''], α1403'''' <: List['a1411''''], α1403'''' <: List['a1417''''], α1405'''' <: ((α1418'''',) -> α1419'''')}  <!<  ((α1397'''',) -> α1398'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1397'''',) -> α1398'''')
//│ ╟── while constraining:  α1384''''  <!<  ((α1397'''',) -> α1398'''')
//│ ╟── while constraining:  {(α1397'''' -> α1402'''') where: α1382'''' <: List['a1385''''], α1382'''' <: List['a1386''''], α1382'''' <: List['a1390''''], α1382'''' <: List['a1396''''], α1384'''' <: ((α1397'''',) -> α1398'''')}  <!<  ((α1376'''',) -> α1377'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1376'''',) -> α1377'''')
//│ ╟── while constraining:  α1363''''  <!<  ((α1376'''',) -> α1377'''')
//│ ╟── while constraining:  {(α1376'''' -> α1381'''') where: α1361'''' <: List['a1364''''], α1361'''' <: List['a1365''''], α1361'''' <: List['a1369''''], α1361'''' <: List['a1375''''], α1363'''' <: ((α1376'''',) -> α1377'''')}  <!<  ((α1355'''',) -> α1356'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1355'''',) -> α1356'''')
//│ ╟── while constraining:  α1342''''  <!<  ((α1355'''',) -> α1356'''')
//│ ╟── while constraining:  {(α1355'''' -> α1360'''') where: α1340'''' <: List['a1343''''], α1340'''' <: List['a1344''''], α1340'''' <: List['a1348''''], α1340'''' <: List['a1354''''], α1342'''' <: ((α1355'''',) -> α1356'''')}  <!<  ((α1334'''',) -> α1335'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1334'''',) -> α1335'''')
//│ ╟── while constraining:  α1321''''  <!<  ((α1334'''',) -> α1335'''')
//│ ╟── while constraining:  {(α1334'''' -> α1339'''') where: α1319'''' <: List['a1322''''], α1319'''' <: List['a1323''''], α1319'''' <: List['a1327''''], α1319'''' <: List['a1333''''], α1321'''' <: ((α1334'''',) -> α1335'''')}  <!<  ((α1313'''',) -> α1314'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1313'''',) -> α1314'''')
//│ ╟── while constraining:  α1300''''  <!<  ((α1313'''',) -> α1314'''')
//│ ╟── while constraining:  {(α1313'''' -> α1318'''') where: α1298'''' <: List['a1301''''], α1298'''' <: List['a1302''''], α1298'''' <: List['a1306''''], α1298'''' <: List['a1312''''], α1300'''' <: ((α1313'''',) -> α1314'''')}  <!<  ((α1292'''',) -> α1293'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1292'''',) -> α1293'''')
//│ ╟── while constraining:  α1279''''  <!<  ((α1292'''',) -> α1293'''')
//│ ╟── while constraining:  {(α1292'''' -> α1297'''') where: α1277'''' <: List['a1280''''], α1277'''' <: List['a1281''''], α1277'''' <: List['a1285''''], α1277'''' <: List['a1291''''], α1279'''' <: ((α1292'''',) -> α1293'''')}  <!<  ((α1271'''',) -> α1272'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1271'''',) -> α1272'''')
//│ ╟── while constraining:  α1258''''  <!<  ((α1271'''',) -> α1272'''')
//│ ╟── while constraining:  {(α1271'''' -> α1276'''') where: α1256'''' <: List['a1259''''], α1256'''' <: List['a1260''''], α1256'''' <: List['a1264''''], α1256'''' <: List['a1270''''], α1258'''' <: ((α1271'''',) -> α1272'''')}  <!<  ((α1250'''',) -> α1251'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1250'''',) -> α1251'''')
//│ ╟── while constraining:  α1237''''  <!<  ((α1250'''',) -> α1251'''')
//│ ╟── while constraining:  {(α1250'''' -> α1255'''') where: α1235'''' <: List['a1238''''], α1235'''' <: List['a1239''''], α1235'''' <: List['a1243''''], α1235'''' <: List['a1249''''], α1237'''' <: ((α1250'''',) -> α1251'''')}  <!<  ((α1229'''',) -> α1230'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1229'''',) -> α1230'''')
//│ ╟── while constraining:  α1216''''  <!<  ((α1229'''',) -> α1230'''')
//│ ╟── while constraining:  {(α1229'''' -> α1234'''') where: α1214'''' <: List['a1217''''], α1214'''' <: List['a1218''''], α1214'''' <: List['a1222''''], α1214'''' <: List['a1228''''], α1216'''' <: ((α1229'''',) -> α1230'''')}  <!<  ((α1208'''',) -> α1209'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1208'''',) -> α1209'''')
//│ ╟── while constraining:  α1195''''  <!<  ((α1208'''',) -> α1209'''')
//│ ╟── while constraining:  {(α1208'''' -> α1213'''') where: α1193'''' <: List['a1196''''], α1193'''' <: List['a1197''''], α1193'''' <: List['a1201''''], α1193'''' <: List['a1207''''], α1195'''' <: ((α1208'''',) -> α1209'''')}  <!<  ((α1187'''',) -> α1188'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1187'''',) -> α1188'''')
//│ ╟── while constraining:  α1174''''  <!<  ((α1187'''',) -> α1188'''')
//│ ╟── while constraining:  {(α1187'''' -> α1192'''') where: α1172'''' <: List['a1175''''], α1172'''' <: List['a1176''''], α1172'''' <: List['a1180''''], α1172'''' <: List['a1186''''], α1174'''' <: ((α1187'''',) -> α1188'''')}  <!<  ((α1166'''',) -> α1167'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1166'''',) -> α1167'''')
//│ ╟── while constraining:  α1153''''  <!<  ((α1166'''',) -> α1167'''')
//│ ╟── while constraining:  {(α1166'''' -> α1171'''') where: α1151'''' <: List['a1154''''], α1151'''' <: List['a1155''''], α1151'''' <: List['a1159''''], α1151'''' <: List['a1165''''], α1153'''' <: ((α1166'''',) -> α1167'''')}  <!<  ((α1145'''',) -> α1146'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1145'''',) -> α1146'''')
//│ ╟── while constraining:  α1132''''  <!<  ((α1145'''',) -> α1146'''')
//│ ╟── while constraining:  {(α1145'''' -> α1150'''') where: α1130'''' <: List['a1133''''], α1130'''' <: List['a1134''''], α1130'''' <: List['a1138''''], α1130'''' <: List['a1144''''], α1132'''' <: ((α1145'''',) -> α1146'''')}  <!<  ((α1124'''',) -> α1125'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1124'''',) -> α1125'''')
//│ ╟── while constraining:  α1111''''  <!<  ((α1124'''',) -> α1125'''')
//│ ╟── while constraining:  {(α1124'''' -> α1129'''') where: α1109'''' <: List['a1112''''], α1109'''' <: List['a1113''''], α1109'''' <: List['a1117''''], α1109'''' <: List['a1123''''], α1111'''' <: ((α1124'''',) -> α1125'''')}  <!<  ((α1103'''',) -> α1104'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1103'''',) -> α1104'''')
//│ ╟── while constraining:  α1090''''  <!<  ((α1103'''',) -> α1104'''')
//│ ╟── while constraining:  {(α1103'''' -> α1108'''') where: α1088'''' <: List['a1091''''], α1088'''' <: List['a1092''''], α1088'''' <: List['a1096''''], α1088'''' <: List['a1102''''], α1090'''' <: ((α1103'''',) -> α1104'''')}  <!<  ((α1082'''',) -> α1083'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1082'''',) -> α1083'''')
//│ ╟── while constraining:  α1069''''  <!<  ((α1082'''',) -> α1083'''')
//│ ╟── while constraining:  {(α1082'''' -> α1087'''') where: α1067'''' <: List['a1070''''], α1067'''' <: List['a1071''''], α1067'''' <: List['a1075''''], α1067'''' <: List['a1081''''], α1069'''' <: ((α1082'''',) -> α1083'''')}  <!<  ((α1061'''',) -> α1062'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1061'''',) -> α1062'''')
//│ ╟── while constraining:  α1048''''  <!<  ((α1061'''',) -> α1062'''')
//│ ╟── while constraining:  {(α1061'''' -> α1066'''') where: α1046'''' <: List['a1049''''], α1046'''' <: List['a1050''''], α1046'''' <: List['a1054''''], α1046'''' <: List['a1060''''], α1048'''' <: ((α1061'''',) -> α1062'''')}  <!<  ((α1040'''',) -> α1041'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1040'''',) -> α1041'''')
//│ ╟── while constraining:  α1027''''  <!<  ((α1040'''',) -> α1041'''')
//│ ╟── while constraining:  {(α1040'''' -> α1045'''') where: α1025'''' <: List['a1028''''], α1025'''' <: List['a1029''''], α1025'''' <: List['a1033''''], α1025'''' <: List['a1039''''], α1027'''' <: ((α1040'''',) -> α1041'''')}  <!<  ((α1019'''',) -> α1020'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α1019'''',) -> α1020'''')
//│ ╟── while constraining:  α1006''''  <!<  ((α1019'''',) -> α1020'''')
//│ ╟── while constraining:  {(α1019'''' -> α1024'''') where: α1004'''' <: List['a1007''''], α1004'''' <: List['a1008''''], α1004'''' <: List['a1012''''], α1004'''' <: List['a1018''''], α1006'''' <: ((α1019'''',) -> α1020'''')}  <!<  ((α998'''',) -> α999'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α998'''',) -> α999'''')
//│ ╟── while constraining:  α985''''  <!<  ((α998'''',) -> α999'''')
//│ ╟── while constraining:  {(α998'''' -> α1003'''') where: α983'''' <: List['a986''''], α983'''' <: List['a987''''], α983'''' <: List['a991''''], α983'''' <: List['a997''''], α985'''' <: ((α998'''',) -> α999'''')}  <!<  ((α977'''',) -> α978'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α977'''',) -> α978'''')
//│ ╟── while constraining:  α964''''  <!<  ((α977'''',) -> α978'''')
//│ ╟── while constraining:  {(α977'''' -> α982'''') where: α962'''' <: List['a965''''], α962'''' <: List['a966''''], α962'''' <: List['a970''''], α962'''' <: List['a976''''], α964'''' <: ((α977'''',) -> α978'''')}  <!<  ((α956'''',) -> α957'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α956'''',) -> α957'''')
//│ ╟── while constraining:  α943''''  <!<  ((α956'''',) -> α957'''')
//│ ╟── while constraining:  {(α956'''' -> α961'''') where: α941'''' <: List['a944''''], α941'''' <: List['a945''''], α941'''' <: List['a949''''], α941'''' <: List['a955''''], α943'''' <: ((α956'''',) -> α957'''')}  <!<  ((α935'''',) -> α936'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α935'''',) -> α936'''')
//│ ╟── while constraining:  α922''''  <!<  ((α935'''',) -> α936'''')
//│ ╟── while constraining:  {(α935'''' -> α940'''') where: α920'''' <: List['a923''''], α920'''' <: List['a924''''], α920'''' <: List['a928''''], α920'''' <: List['a934''''], α922'''' <: ((α935'''',) -> α936'''')}  <!<  ((α914'''',) -> α915'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α914'''',) -> α915'''')
//│ ╟── while constraining:  α901''''  <!<  ((α914'''',) -> α915'''')
//│ ╟── while constraining:  {(α914'''' -> α919'''') where: α899'''' <: List['a902''''], α899'''' <: List['a903''''], α899'''' <: List['a907''''], α899'''' <: List['a913''''], α901'''' <: ((α914'''',) -> α915'''')}  <!<  ((α893'''',) -> α894'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α893'''',) -> α894'''')
//│ ╟── while constraining:  α880''''  <!<  ((α893'''',) -> α894'''')
//│ ╟── while constraining:  {(α893'''' -> α898'''') where: α878'''' <: List['a881''''], α878'''' <: List['a882''''], α878'''' <: List['a886''''], α878'''' <: List['a892''''], α880'''' <: ((α893'''',) -> α894'''')}  <!<  ((α872'''',) -> α873'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α872'''',) -> α873'''')
//│ ╟── while constraining:  α859''''  <!<  ((α872'''',) -> α873'''')
//│ ╟── while constraining:  {(α872'''' -> α877'''') where: α857'''' <: List['a860''''], α857'''' <: List['a861''''], α857'''' <: List['a865''''], α857'''' <: List['a871''''], α859'''' <: ((α872'''',) -> α873'''')}  <!<  ((α851'''',) -> α852'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α851'''',) -> α852'''')
//│ ╟── while constraining:  α838''''  <!<  ((α851'''',) -> α852'''')
//│ ╟── while constraining:  {(α851'''' -> α856'''') where: α836'''' <: List['a839''''], α836'''' <: List['a840''''], α836'''' <: List['a844''''], α836'''' <: List['a850''''], α838'''' <: ((α851'''',) -> α852'''')}  <!<  ((α830'''',) -> α831'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α830'''',) -> α831'''')
//│ ╟── while constraining:  α817''''  <!<  ((α830'''',) -> α831'''')
//│ ╟── while constraining:  {(α830'''' -> α835'''') where: α815'''' <: List['a818''''], α815'''' <: List['a819''''], α815'''' <: List['a823''''], α815'''' <: List['a829''''], α817'''' <: ((α830'''',) -> α831'''')}  <!<  ((α809'''',) -> α810'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α809'''',) -> α810'''')
//│ ╟── while constraining:  α796''''  <!<  ((α809'''',) -> α810'''')
//│ ╟── while constraining:  {(α809'''' -> α814'''') where: α794'''' <: List['a797''''], α794'''' <: List['a798''''], α794'''' <: List['a802''''], α794'''' <: List['a808''''], α796'''' <: ((α809'''',) -> α810'''')}  <!<  ((α788'''',) -> α789'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α788'''',) -> α789'''')
//│ ╟── while constraining:  α775''''  <!<  ((α788'''',) -> α789'''')
//│ ╟── while constraining:  {(α788'''' -> α793'''') where: α773'''' <: List['a776''''], α773'''' <: List['a777''''], α773'''' <: List['a781''''], α773'''' <: List['a787''''], α775'''' <: ((α788'''',) -> α789'''')}  <!<  ((α767'''',) -> α768'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α767'''',) -> α768'''')
//│ ╟── while constraining:  α754''''  <!<  ((α767'''',) -> α768'''')
//│ ╟── while constraining:  {(α767'''' -> α772'''') where: α752'''' <: List['a755''''], α752'''' <: List['a756''''], α752'''' <: List['a760''''], α752'''' <: List['a766''''], α754'''' <: ((α767'''',) -> α768'''')}  <!<  ((α746'''',) -> α747'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α746'''',) -> α747'''')
//│ ╟── while constraining:  α733''''  <!<  ((α746'''',) -> α747'''')
//│ ╟── while constraining:  {(α746'''' -> α751'''') where: α731'''' <: List['a734''''], α731'''' <: List['a735''''], α731'''' <: List['a739''''], α731'''' <: List['a745''''], α733'''' <: ((α746'''',) -> α747'''')}  <!<  ((α725'''',) -> α726'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α725'''',) -> α726'''')
//│ ╟── while constraining:  α712''''  <!<  ((α725'''',) -> α726'''')
//│ ╟── while constraining:  {(α725'''' -> α730'''') where: α710'''' <: List['a713''''], α710'''' <: List['a714''''], α710'''' <: List['a718''''], α710'''' <: List['a724''''], α712'''' <: ((α725'''',) -> α726'''')}  <!<  ((α704'''',) -> α705'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α704'''',) -> α705'''')
//│ ╟── while constraining:  α691''''  <!<  ((α704'''',) -> α705'''')
//│ ╟── while constraining:  {(α704'''' -> α709'''') where: α689'''' <: List['a692''''], α689'''' <: List['a693''''], α689'''' <: List['a697''''], α689'''' <: List['a703''''], α691'''' <: ((α704'''',) -> α705'''')}  <!<  ((α683'''',) -> α684'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α683'''',) -> α684'''')
//│ ╟── while constraining:  α670''''  <!<  ((α683'''',) -> α684'''')
//│ ╟── while constraining:  {(α683'''' -> α688'''') where: α668'''' <: List['a671''''], α668'''' <: List['a672''''], α668'''' <: List['a676''''], α668'''' <: List['a682''''], α670'''' <: ((α683'''',) -> α684'''')}  <!<  ((α662'''',) -> α663'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α662'''',) -> α663'''')
//│ ╟── while constraining:  α649''''  <!<  ((α662'''',) -> α663'''')
//│ ╟── while constraining:  {(α662'''' -> α667'''') where: α647'''' <: List['a650''''], α647'''' <: List['a651''''], α647'''' <: List['a655''''], α647'''' <: List['a661''''], α649'''' <: ((α662'''',) -> α663'''')}  <!<  ((α641'''',) -> α642'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α641'''',) -> α642'''')
//│ ╟── while constraining:  α628''''  <!<  ((α641'''',) -> α642'''')
//│ ╟── while constraining:  {(α641'''' -> α646'''') where: α626'''' <: List['a629''''], α626'''' <: List['a630''''], α626'''' <: List['a634''''], α626'''' <: List['a640''''], α628'''' <: ((α641'''',) -> α642'''')}  <!<  ((α620'''',) -> α621'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α620'''',) -> α621'''')
//│ ╟── while constraining:  α607''''  <!<  ((α620'''',) -> α621'''')
//│ ╟── while constraining:  {(α620'''' -> α625'''') where: α605'''' <: List['a608''''], α605'''' <: List['a609''''], α605'''' <: List['a613''''], α605'''' <: List['a619''''], α607'''' <: ((α620'''',) -> α621'''')}  <!<  ((α599'''',) -> α600'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α599'''',) -> α600'''')
//│ ╟── while constraining:  α586''''  <!<  ((α599'''',) -> α600'''')
//│ ╟── while constraining:  {(α599'''' -> α604'''') where: α584'''' <: List['a587''''], α584'''' <: List['a588''''], α584'''' <: List['a592''''], α584'''' <: List['a598''''], α586'''' <: ((α599'''',) -> α600'''')}  <!<  ((α578'''',) -> α579'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α578'''',) -> α579'''')
//│ ╟── while constraining:  α565''''  <!<  ((α578'''',) -> α579'''')
//│ ╟── while constraining:  {(α578'''' -> α583'''') where: α563'''' <: List['a566''''], α563'''' <: List['a567''''], α563'''' <: List['a571''''], α563'''' <: List['a577''''], α565'''' <: ((α578'''',) -> α579'''')}  <!<  ((α557'''',) -> α558'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α557'''',) -> α558'''')
//│ ╟── while constraining:  α544''''  <!<  ((α557'''',) -> α558'''')
//│ ╟── while constraining:  {(α557'''' -> α562'''') where: α542'''' <: List['a545''''], α542'''' <: List['a546''''], α542'''' <: List['a550''''], α542'''' <: List['a556''''], α544'''' <: ((α557'''',) -> α558'''')}  <!<  ((α536'''',) -> α537'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α536'''',) -> α537'''')
//│ ╟── while constraining:  α523''''  <!<  ((α536'''',) -> α537'''')
//│ ╟── while constraining:  {(α536'''' -> α541'''') where: α521'''' <: List['a524''''], α521'''' <: List['a525''''], α521'''' <: List['a529''''], α521'''' <: List['a535''''], α523'''' <: ((α536'''',) -> α537'''')}  <!<  ((α515'''',) -> α516'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α515'''',) -> α516'''')
//│ ╟── while constraining:  α502''''  <!<  ((α515'''',) -> α516'''')
//│ ╟── while constraining:  {(α515'''' -> α520'''') where: α500'''' <: List['a503''''], α500'''' <: List['a504''''], α500'''' <: List['a508''''], α500'''' <: List['a514''''], α502'''' <: ((α515'''',) -> α516'''')}  <!<  ((α494'''',) -> α495'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α494'''',) -> α495'''')
//│ ╟── while constraining:  α481''''  <!<  ((α494'''',) -> α495'''')
//│ ╟── while constraining:  {(α494'''' -> α499'''') where: α479'''' <: List['a482''''], α479'''' <: List['a483''''], α479'''' <: List['a487''''], α479'''' <: List['a493''''], α481'''' <: ((α494'''',) -> α495'''')}  <!<  ((α473'''',) -> α474'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α473'''',) -> α474'''')
//│ ╟── while constraining:  α460''''  <!<  ((α473'''',) -> α474'''')
//│ ╟── while constraining:  {(α473'''' -> α478'''') where: α458'''' <: List['a461''''], α458'''' <: List['a462''''], α458'''' <: List['a466''''], α458'''' <: List['a472''''], α460'''' <: ((α473'''',) -> α474'''')}  <!<  ((α452'''',) -> α453'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α452'''',) -> α453'''')
//│ ╟── while constraining:  α439''''  <!<  ((α452'''',) -> α453'''')
//│ ╟── while constraining:  {(α452'''' -> α457'''') where: α437'''' <: List['a440''''], α437'''' <: List['a441''''], α437'''' <: List['a445''''], α437'''' <: List['a451''''], α439'''' <: ((α452'''',) -> α453'''')}  <!<  ((α431'''',) -> α432'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α431'''',) -> α432'''')
//│ ╟── while constraining:  α418''''  <!<  ((α431'''',) -> α432'''')
//│ ╟── while constraining:  {(α431'''' -> α436'''') where: α416'''' <: List['a419''''], α416'''' <: List['a420''''], α416'''' <: List['a424''''], α416'''' <: List['a430''''], α418'''' <: ((α431'''',) -> α432'''')}  <!<  ((α410'''',) -> α411'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α410'''',) -> α411'''')
//│ ╟── while constraining:  α397''''  <!<  ((α410'''',) -> α411'''')
//│ ╟── while constraining:  {(α410'''' -> α415'''') where: α395'''' <: List['a398''''], α395'''' <: List['a399''''], α395'''' <: List['a403''''], α395'''' <: List['a409''''], α397'''' <: ((α410'''',) -> α411'''')}  <!<  ((α376'''',) -> α377'''')
//│ ╟── while constraining:  ‹∀ 2. {(α314''' -> α319''') where: α300'''' <: List['a302'''], α300'''' <: List['a303'''], α300'''' <: List['a307'''], α300'''' <: List['a313'''], α299'''' <: ((α314''',) -> α315''')}›  <!<  ((α376'''',) -> α377'''')
//│ ╟── while constraining:  α362''''  <!<  ((α376'''',) -> α377'''')
//│ ╟── while constraining:  {(α376'''' -> α381'''') where: α361'''' <: List['a363''''], α361'''' <: List['a364''''], α361'''' <: List['a368''''], α361'''' <: List['a374''''], α362'''' <: ((α376'''',) -> α377'''')}  <!<  ((α295''',) -> α360'''')
//│ ╟── while constraining:  ‹∀ 2. {(α354''' -> α359''') where: α339'''' <: List['a341'''], α339'''' <: List['a342'''], α339'''' <: List['a346'''], α339'''' <: List['a352'''], α340'''' <: ((α354''',) -> α355''')}›  <!<  ((α295''',) -> α360'''')
//│ ╙── while constraining:  α296''''  <!<  ((α295''',) -> α360'''')
//│ nfind: List[?] -> anything -> anything -> (forall 'a. 'a -> 'a)
//│      = [Function: nfind]

// type Int = ['a] ('a -> 'a) -> ('a -> 'a)
type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ Defined type alias ChurchInt

// let succ (n:Int) = fun f x -> f (n f x)
def succ (n: ChurchInt) = fun f -> fun x -> f (n f x)
def succ' n = fun f -> fun x -> f (n f x)
//│ succ: ChurchInt -> (forall 'a. 'a -> (forall 'a, 'b, 'c, 'd, 'e. ('c -> 'e
//│   where
//│     'b <: 'a -> 'c -> 'd
//│     'a <: 'd -> 'e)))
//│     = [Function: succ]
//│ succ': 'a -> (forall 'b. 'b -> (forall 'a, 'b, 'c, 'd, 'e. ('c -> 'e
//│   where
//│     'a <: 'b -> 'c -> 'd
//│     'b <: 'd -> 'e)))
//│      = [Function: succ]

// let add (n:Int) (m:Int) = n succ m
def add (n: ChurchInt) (m: ChurchInt) = n succ m
def add' n m = n succ' m
//│ add: ChurchInt -> (forall 'a. (ChurchInt -> 'b
//│   where
//│     'a <: (ChurchInt -> (forall 'c. 'c -> (forall 'c, 'd, 'e, 'f, 'g. ('e -> 'g
//│   where
//│     'd <: 'c -> 'e -> 'f
//│     'c <: 'f -> 'g)))) -> ChurchInt -> 'b))
//│    = [Function: add]
//│ add': 'a -> (forall 'a. ('b -> 'c
//│   where
//│     'a <: (forall 'd. 'd -> (forall 'e. 'e -> (forall 'd, 'e, 'f, 'g, 'h. ('f -> 'h
//│   where
//│     'd <: 'e -> 'f -> 'g
//│     'e <: 'g -> 'h)))) -> 'b -> 'c))
//│     = [Function: add]

// let printInt (n:Int) = print (n (fun x -> x+1) 0)
def printInt (n: ChurchInt) = toString (n (fun x -> x + 1) 0)
def printInt' n = toString (n (fun x -> x + 1) 0)
//│ printInt: ChurchInt -> string
//│         = [Function: printInt]
//│ printInt': ((int -> int) -> 0 -> anything) -> string
//│          = [Function: printInt]

// let table = create_hashtbl ()
// let table = hashtbl_add table "one" (fun f x -> f x)
// let table = hashtbl_add table "two" (fun f x -> f (f x))
table = create_hashtbl null
table = hashtbl_add table "one" (fun f -> fun x -> f x)
table = hashtbl_add table "two" (fun f -> fun x -> f (f x))
//│ table: List[nothing]
//│      = Nil {}
//│ table: List[("one", forall 'a. 'a -> (forall 'a, 'b, 'c. ('b -> 'c
//│   where
//│     'a <: 'b -> 'c)),)]
//│      = Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│ table: List[("one" | "two", forall 'a, 'b. ('a & 'b) -> (forall 'a, 'b, 'c, 'd, 'e. ('c -> 'd
//│   where
//│     'a <: 'c -> 'd
//│     'b <: 'c -> 'e & 'e -> 'd)),)]
//│      = Cons {
//│          head: [ 'two', [Function (anonymous)] ],
//│          tail: Cons { head: [ 'one', [Function (anonymous)] ], tail: Nil {} }
//│        }

// let zog =
//   printInt (add (nfind table "one") (nfind table "two"))
zog = printInt (add (nfind table "one") (nfind table "two"))
zog' = printInt' (add' (nfind table "one") (nfind table "two"))
//│ ╔══[ERROR] Type mismatch in application:
//│ ║  l.439: 	zog = printInt (add (nfind table "one") (nfind table "two"))
//│ ║         	                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── type `anything` does not match type `nothing`
//│ ║  l.373: 	type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ ║         	                        ^^
//│ ╟── Note: constraint arises from quantified type variable:
//│ ║  l.373: 	type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ ╙──       	                        ^^
//│ ╔══[ERROR] Type mismatch in application:
//│ ║  l.439: 	zog = printInt (add (nfind table "one") (nfind table "two"))
//│ ║         	      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── type `anything` does not match type `nothing`
//│ ║  l.373: 	type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ ║         	                        ^^
//│ ╟── Note: constraint arises from quantified type variable:
//│ ║  l.373: 	type ChurchInt = forall 'a. ('a -> 'a) -> ('a -> 'a)
//│ ╙──       	                        ^^
//│ zog: error | string
//│    = '0'
//│ zog': string
//│     = '0'
