:NewParser
:NewDefs



// FIXME `let` fields should not be getters
:js
mixin Foo0 {
  let foo0 = 0
}
//│ mixin Foo0() {
//│   let foo0: 0
//│ }
//│ // Prelude
//│ let res;
//│ let typing_unit = {
//│   cache: {},
//│   Foo0(base) {
//│     return (class Foo0 extends base {
//│       constructor(...rest) {
//│         super(...rest);
//│       }
//│       get foo0() {
//│         return 0;
//│       }
//│     });
//│   }
//│ };
//│ globalThis.Foo0 = typing_unit.Foo0;
//│ // End of generated code

:js
mixin Foo1 {
  let foo0 = 1
  let foo1 = super.foo0
}
//│ mixin Foo1() {
//│   super: {foo0: 'foo0}
//│   let foo0: 1
//│   let foo1: 'foo0
//│ }
//│ // Prelude
//│ let typing_unit1 = {
//│   cache: {},
//│   Foo1(base) {
//│     return (class Foo1 extends base {
//│       constructor(...rest) {
//│         super(...rest);
//│       }
//│       get foo0() {
//│         return 1;
//│       }
//│       get foo1() {
//│         return super.foo0;
//│       }
//│     });
//│   }
//│ };
//│ globalThis.Foo1 = typing_unit1.Foo1;
//│ // End of generated code

module Test0 extends Foo0, Foo1
//│ module Test0() {
//│   let foo0: 1
//│   let foo1: 0
//│ }

[Test0.foo0, Test0.foo1]
//│ (1, 0,)
//│ res
//│     = [ 1, 0 ]


:ShowRepl
:js
// FIXME prevent misuse of `super` using the type system
mixin Foo2 {
  fun foo2 = super
}
//│ mixin Foo2() {
//│   super: 'super
//│   fun foo2: 'super
//│ }
//│ // Prelude
//│ let typing_unit4 = {
//│   cache: {},
//│   Foo2(base) {
//│     return (class Foo2 extends base {
//│       constructor(...rest) {
//│         super(...rest);
//│       }
//│       get foo2() {
//│         return super;
//│       }
//│     });
//│   }
//│ };
//│ globalThis.Foo2 = typing_unit4.Foo2;
//│ // End of generated code
//│ Syntax error:
//│   'super' keyword unexpected here

:ShowRepl
:js
module Test0 extends Foo2
//│ module Test0() {
//│   fun foo2: anything
//│ }
//│ // Prelude
//│ let typing_unit5 = {
//│   cache: {},
//│   get Test01() {
//│     if (this.cache.Test01 === undefined) {
//│       class Test01 extends Foo2(Object) {
//│         constructor() {
//│           super();
//│         }
//│       }
//│       this.cache.Test01 = new Test01();
//│       this.cache.Test01["class"] = Test01;
//│     }
//│     return this.cache.Test01;
//│   }
//│ };
//│ globalThis.Test01 = typing_unit5.Test01;
//│ // End of generated code
//│ ┌ Block at Super.mls:105
//│ ├─┬ Prelude
//│ │ ├── Code
//│ │ │   let typing_unit5 = {
//│ │ │     cache: {},
//│ │ │     get Test01() {
//│ │ │       if (this.cache.Test01 === undefined) {
//│ │ │         class Test01 extends Foo2(Object) {
//│ │ │           constructor() {
//│ │ │             super();
//│ │ │           }
//│ │ │         }
//│ │ │         this.cache.Test01 = new Test01();
//│ │ │         this.cache.Test01["class"] = Test01;
//│ │ │       }
//│ │ │       return this.cache.Test01;
//│ │ │     }
//│ │ │   };
//│ │ │   globalThis.Test01 = typing_unit5.Test01;
//│ │ └── Reply
//│ │     Uncaught ReferenceError: Foo2 is not defined
//│ │         at Object.get Test01 [as Test01] (REPL9:1:78)
//│ └── No queries

:re
Test0
//│ Test0
//│ res
//│ Runtime error:
//│   ReferenceError: Test01 is not defined

:re
Test0.foo2
//│ anything
//│ res
//│ Runtime error:
//│   ReferenceError: Test01 is not defined


