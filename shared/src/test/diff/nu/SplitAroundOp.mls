:NewParser

if x
  ==
    0 and b then "n0"
    1 and b then "n1"
    2 then "n2"
  ==
    "0" then "s0"
    "1" then "s1"
    "2" then "s2"
//│ /!!!\ Uncaught error: scala.NotImplementedError: an implementation is missing
//│ 	at: scala.Predef$.$qmark$qmark$qmark(Predef.scala:344)
//│ 	at: mlscript.MutCaseOf$IfThenElse.merge(helpers.scala:949)
//│ 	at: mlscript.MutCaseOf$.$anonfun$build$1(helpers.scala:1060)
//│ 	at: mlscript.MutCaseOf$.$anonfun$build$1$adapted(helpers.scala:1060)
//│ 	at: scala.collection.immutable.List.foreach(List.scala:333)
//│ 	at: mlscript.MutCaseOf$.build(helpers.scala:1060)
//│ 	at: mlscript.Typer.$anonfun$typeTerm$2(Typer.scala:727)
//│ 	at: mlscript.TyperHelpers.trace(TyperHelpers.scala:30)
//│ 	at: mlscript.Typer.typeTerm(Typer.scala:744)
//│ 	at: mlscript.Typer.typeStatement(Typer.scala:376)

if x == 0
  and
    y == 0 then "x, y"
    a == 0 then "x, a"
    b == 0 then "x, b"
//│ /!!!\ Uncaught error: scala.NotImplementedError: an implementation is missing
//│ 	at: scala.Predef$.$qmark$qmark$qmark(Predef.scala:344)
//│ 	at: mlscript.MutCaseOf$IfThenElse.merge(helpers.scala:949)
//│ 	at: mlscript.MutCaseOf$IfThenElse.merge(helpers.scala:946)
//│ 	at: mlscript.MutCaseOf$.$anonfun$build$1(helpers.scala:1060)
//│ 	at: mlscript.MutCaseOf$.$anonfun$build$1$adapted(helpers.scala:1060)
//│ 	at: scala.collection.immutable.List.foreach(List.scala:333)
//│ 	at: mlscript.MutCaseOf$.build(helpers.scala:1060)
//│ 	at: mlscript.Typer.$anonfun$typeTerm$2(Typer.scala:727)
//│ 	at: mlscript.TyperHelpers.trace(TyperHelpers.scala:30)
//│ 	at: mlscript.Typer.typeTerm(Typer.scala:744)

if x
  is
    A() then 0
    B() then 1
//│ ╔══[ERROR] class A not found
//│ ║  l.41: 	if x
//│ ║        	   ^
//│ ║  l.42: 	  is
//│ ║        	^^^^
//│ ║  l.43: 	    A() then 0
//│ ║        	^^^^^^^^^^^^^^
//│ ║  l.44: 	    B() then 1
//│ ╙──      	^^^^^^^^^^^^^^
//│ res: error
//│ Code generation encountered an error:
//│   if expression has not been not desugared

if x is
  A()
    == 0 then 0
    > 0 then 1
    < 0 then 2
//│ /!!!\ Uncaught error: scala.NotImplementedError: an implementation is missing
//│ 	at: scala.Predef$.$qmark$qmark$qmark(Predef.scala:344)
//│ 	at: mlscript.Typer.desugarMatchBranch$1(Typer.scala:1188)
//│ 	at: mlscript.Typer.$anonfun$desugarIf$7(Typer.scala:1227)
//│ 	at: mlscript.Typer.$anonfun$desugarIf$7$adapted(Typer.scala:1227)
//│ 	at: scala.collection.immutable.List.foreach(List.scala:333)
//│ 	at: mlscript.Typer.desugarIfBody$1(Typer.scala:1227)
//│ 	at: mlscript.Typer.desugarIf(Typer.scala:1254)
//│ 	at: mlscript.Typer.$anonfun$typeTerm$2(Typer.scala:725)
//│ 	at: mlscript.TyperHelpers.trace(TyperHelpers.scala:30)
//│ 	at: mlscript.Typer.typeTerm(Typer.scala:744)
