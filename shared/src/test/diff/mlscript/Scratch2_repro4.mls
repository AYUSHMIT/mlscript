:GeneralizeCurriedFunctions

// type ChurchInt = forall 'N. ('N -> 'N) -> ('N -> 'N)

// :ArgGen

// :d
// :ns
// def s n = fun f -> fun x -> f (n f x)
def s n = fun f -> fun x -> (n f x)
// def s n = fun f -> n f
// def s n = n
//│ s: 'a -> (forall 'b. 'b -> (forall 'a, 'b, 'c, 'd. ('c -> 'd
//│   where
//│     'a <: 'b -> 'c -> 'd)))
//│  = [Function: s]

def succ: (forall 'N. ('N -> 'N) -> ('N -> 'N)) -> (forall 'M. ('M -> 'M) -> ('M -> 'M))
//│ succ: (forall 'N. ('N -> 'N) -> 'N -> 'N) -> (forall 'M. ('M -> 'M) -> 'M -> 'M)
//│     = <missing implementation>

// :DistributeForalls

// :ns
:e // * Needs distrib (see below)
// :d
succ = s
//│ 'a -> (forall 'b. 'b -> (forall 'a, 'b, 'c, 'd. ('c -> 'd
//│   where
//│     'a <: 'b -> 'c -> 'd)))
//│   <:  succ:
//│ (forall 'N. ('N -> 'N) -> 'N -> 'N) -> (forall 'M. ('M -> 'M) -> 'M -> 'M)
//│ ╔══[ERROR] Type mismatch in def definition:
//│ ║  l.27: 	succ = s
//│ ║        	^^^^^^^^
//│ ╟── type `‘M89` is not an instance of type `'M`
//│ ║  l.18: 	def succ: (forall 'N. ('N -> 'N) -> ('N -> 'N)) -> (forall 'M. ('M -> 'M) -> ('M -> 'M))
//│ ║        	                                                           ^^
//│ ╟── Note: constraint arises from quantified type variable:
//│ ║  l.18: 	def succ: (forall 'N. ('N -> 'N) -> ('N -> 'N)) -> (forall 'M. ('M -> 'M) -> ('M -> 'M))
//│ ╙──      	                                                           ^^
//│     = [Function: s]



// ==========================================================================


def s n = fun f -> n f
//│ s: 'a -> (forall 'a, 'b, 'c. ('b -> 'c
//│   where
//│     'a <: 'b -> 'c))
//│  = [Function: s1]

// def succ: (forall 'N. ('N -> 'N) -> ('N -> 'N)) -> (forall 'M. ('M -> 'M) -> ('M -> 'M))
def succ: (forall 'N. ('N -> 'N)) -> (forall 'M. ('M -> 'M))
//│ succ: (forall 'N. 'N -> 'N) -> (forall 'M. 'M -> 'M)
//│     = <missing implementation>

// :DistributeForalls

// :ns
// :e // * Needs distrib (see below)
:d
succ = s
// succ n = s n
// s id : (forall 'M. ('M -> 'M))
//│ 1. Typing term s   None
//│ 1. : ‹∀ 0. ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)››
//│ ⬤ Typed as: ‹∀ 0. ‹∀ 0. ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)›››
//│  where: 
//│ ⬤ Typed as: ‹∀ 0. (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)›
//│  where: 
//│ 'a -> (forall 'a, 'b, 'c. ('b -> 'c
//│   where
//│     'a <: 'b -> 'c))
//│   <:  succ:
//│ (forall 'N. 'N -> 'N) -> (forall 'M. 'M -> 'M)
//│ CHECKING SUBSUMPTION...
//│ CONSTRAIN ‹∀ 0. ‹∀ 0. ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)››› <! ‹∀ 0. (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)›
//│   where 
//│ 0. C ‹∀ 0. ‹∀ 0. ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)››› <! ‹∀ 0. (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)›
//│ | BUMP TO LEVEL 1  -->  (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)
//│ | where 
//│ | 1. C ‹∀ 0. ‹∀ 0. ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)››› <! (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)
//│ | | 1. C ‹∀ 0. ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)›› <! (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)
//│ | | | 1. C ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)› <! (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)
//│ | | | | INST [1]   ‹∀ 1. (α91'' -> ‹∀ 2. {(α92''' -> α93''') where: α91'' <: ((α92''',) -> α93''')}›)›
//│ | | | |   where  
//│ | | | | TO [1] ~>  (α91_126' -> ‹∀ 2. {(α92_127''' -> α93_128''') where: α91_126' <: ((α92_127''',) -> α93_128''')}›)
//│ | | | |   where  
//│ | | | | 1. C (α91_126' -> ‹∀ 2. {(α92_127''' -> α93_128''') where: α91_126' <: ((α92_127''',) -> α93_128''')}›) <! (‹∀ 1. ('N103'' -> 'N103'')› -> ‹∀ 1. ('M104'' -> 'M104'')›)
//│ | | | | | 1. C (‹∀ 1. ('N103'' -> 'N103'')›,) <! (α91_126',)
//│ | | | | | | 1. C ‹∀ 1. ('N103'' -> 'N103'')› <! α91_126'
//│ | | | | | | | NEW α91_126' LB (0)
//│ | | | | | 1. C ‹∀ 2. {(α92_127''' -> α93_128''') where: α91_126' <: ((α92_127''',) -> α93_128''')}› <! ‹∀ 1. ('M104'' -> 'M104'')›
//│ | | | | | | BUMP TO LEVEL 2  -->  (‘M'' -> ‘M'')
//│ | | | | | | where 
//│ | | | | | | 2. C ‹∀ 2. {(α92_127''' -> α93_128''') where: α91_126' <: ((α92_127''',) -> α93_128''')}› <! (‘M'' -> ‘M'')
//│ | | | | | | | INST [2]   ‹∀ 2. {(α92_127''' -> α93_128''') where: α91_126' <: ((α92_127''',) -> α93_128''')}›
//│ | | | | | | |   where  
//│ 		α91_126' :> ‹∀ 1. ('N103'' -> 'N103'')›
//│ | | | | | | | TO [2] ~>  {(α92_129'' -> α93_130'') where: α91_126' <: ((α92_129'',) -> α93_130'')}
//│ | | | | | | |   where  
//│ 		α91_126' :> ‹∀ 1. ('N103'' -> 'N103'')›
//│ | | | | | | | 2. C {(α92_129'' -> α93_130'') where: α91_126' <: ((α92_129'',) -> α93_130'')} <! (‘M'' -> ‘M'')
//│ | | | | | | | | DISCHARGE CONSTRAINTS
//│ | | | | | | | | | 2. C α91_126' <! ((α92_129'',) -> α93_130'')
//│ | | | | | | | | | | EXTR RHS  ~>  ((α131',) -> α132')  to 1
//│ | | | | | | | | | |  where 
//│ | | | | | | | | | |    and 
//│ 		α92_129'' <: α131'
//│ 		α93_130'' :> α132'
//│ | | | | | | | | | | 2. C α91_126' <! ((α131',) -> α132')
//│ | | | | | | | | | | | NEW α91_126' UB (1)
//│ | | | | | | | | | | | 2. C ‹∀ 1. ('N103'' -> 'N103'')› <! ((α131',) -> α132')
//│ | | | | | | | | | | | | INST [1]   ‹∀ 1. ('N103'' -> 'N103'')›
//│ | | | | | | | | | | | |   where  
//│ | | | | | | | | | | | | TO [2] ~>  ('N103_133'' -> 'N103_133'')
//│ | | | | | | | | | | | |   where  
//│ | | | | | | | | | | | | 2. C ('N103_133'' -> 'N103_133'') <! ((α131',) -> α132')
//│ | | | | | | | | | | | | | 2. C (α131',) <! ('N103_133'',)
//│ | | | | | | | | | | | | | | 2. C (α131',) <! ('N103_133'',)
//│ | | | | | | | | | | | | | | | 2. C α131' <! 'N103_133''
//│ | | | | | | | | | | | | | | | | 2. C α131' <! 'N103_133''
//│ | | | | | | | | | | | | | | | | | NEW 'N103_133'' LB (1)
//│ | | | | | | | | | | | | | 2. C 'N103_133'' <! α132'
//│ | | | | | | | | | | | | | | NEW 'N103_133'' UB (1)
//│ | | | | | | | | | | | | | | 2. C α131' <! α132'
//│ | | | | | | | | | | | | | | | NEW α131' UB (1)
//│ | | | | | | | | 2. C (α92_129'' -> α93_130'') <! (‘M'' -> ‘M'')
//│ | | | | | | | | | 2. C (‘M'',) <! (α92_129'',)
//│ | | | | | | | | | | 2. C ‘M'' <! α92_129''
//│ | | | | | | | | | | | NEW α92_129'' LB (2)
//│ | | | | | | | | | | | 2. C ‘M'' <! α131'
//│ | | | | | | | | | | | | EXTR LHS  ~>  ‘M134'  to 1
//│ | | | | | | | | | | | |  where 
//│ | | | | | | | | | | | |    and 
//│ | | | | | | | | | | | | 2. C ‘M134' <! α131'
//│ | | | | | | | | | | | | | NEW α131' LB (1)
//│ | | | | | | | | | | | | | 2. C ‘M134' <! α132'
//│ | | | | | | | | | | | | | | NEW α132' LB (1)
//│ | | | | | | | | | 2. C α93_130'' <! ‘M''
//│ | | | | | | | | | | NEW α93_130'' UB (2)
//│ | | | | | | | | | | 2. C α132' <! ‘M''
//│ | | | | | | | | | | | EXTR RHS  ~>  ‹∀ 1. 'M135''›  to 1
//│ | | | | | | | | | | |  where 
//│ | | | | | | | | | | |    and 
//│ | | | | | | | | | | | 2. C α132' <! ‹∀ 1. 'M135''›
//│ | | | | | | | | | | | | NEW α132' UB (0)
//│ | | | | | | | | | | | | 2. C ‘M134' <! ‹∀ 1. 'M135''›
//│ | | | | | | | | | | | | | BUMP TO LEVEL 3  -->  ‘M'''
//│ | | | | | | | | | | | | | where 
//│ | | | | | | | | | | | | | 3. C ‘M134' <! ‘M'''
//│ | | | | | | | | | | | | | | CONSTRAINT FAILURE: ‘M134' <: ‘M'''
//│ | | | | | | | | | | | | | | allVarPols: 
//│ | | | | | | | | | | | | | | norm[+] ‘M134'
//│ | | | | | | | | | | | | | | | DNF: DNF(1024, {}∧‘M134')
//│ | | | | | | | | | | | | | | ~> ‘M134'
//│ ╔══[ERROR] Type mismatch in def definition:
//│ ║  l.65: 	succ = s
//│ ║        	^^^^^^^^
//│ ╟── type `‘M134` is not an instance of type `'M`
//│ ║  l.56: 	def succ: (forall 'N. ('N -> 'N)) -> (forall 'M. ('M -> 'M))
//│ ║        	                                             ^^
//│ ╟── Note: constraint arises from quantified type variable:
//│ ║  l.56: 	def succ: (forall 'N. ('N -> 'N)) -> (forall 'M. ('M -> 'M))
//│ ╙──      	                                             ^^
//│     = [Function: s1]



