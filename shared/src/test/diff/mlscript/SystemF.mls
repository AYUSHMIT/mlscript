// * From https://crypto.stanford.edu/~blynn/lambda/systemf.html

:NoRecursiveTypes
:GeneralizeCurriedFunctions
:NoConstrainedTypes
:DontDistributeForalls


def succ: int -> int
//│ succ: int -> int
//│     = <missing implementation>


(fun f -> f succ(f 0)) (fun x -> x)
//│ res: int
//│    = <no result>
//│      succ is not implemented

// Note: does not type check without precise function type intersections
(fun f -> f succ (f 0)) (fun x -> x)
//│ res: int
//│    = <no result>
//│      succ is not implemented


// [Reset]

// Polymorphic identity.
id x = x
def id_ty: forall 'A. 'A -> 'A
//│ id: 'a -> 'a
//│   = [Function: id]
//│ id_ty: 'A -> 'A
//│      = <missing implementation>

id_ty = id
//│ 'a -> 'a
//│   <:  id_ty:
//│ 'A -> 'A
//│      = [Function: id]

// Self-application.
xx = fun x -> x x
def xx_ty: (forall 'X. 'X -> 'X) -> (forall 'X. 'X -> 'X)
//│ xx: ('a -> 'b & 'a) -> 'b
//│   = [Function: xx]
//│ xx_ty: (forall 'X. 'X -> 'X) -> (forall 'X0. 'X0 -> 'X0)
//│      = <missing implementation>

xx_ty = xx
//│ ('a -> 'b & 'a) -> 'b
//│   <:  xx_ty:
//│ (forall 'X. 'X -> 'X) -> (forall 'X0. 'X0 -> 'X0)
//│      = [Function: xx]

xx id
iter2 f x = f(f x)
def iter2_ty: forall 'X. ('X -> 'X) -> 'X -> 'X
//│ res: 'a -> 'a
//│    = [Function: id]
//│ iter2: (('a | 'b) -> 'c & 'd -> 'a & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│      = [Function: iter2]
//│ iter2_ty: ('X -> 'X) -> 'X -> 'X
//│         = <missing implementation>

iter2_ty = iter2
//│ (('a | 'b) -> 'c & 'd -> 'a & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│   <:  iter2_ty:
//│ ('X -> 'X) -> 'X -> 'X
//│         = [Function: iter2]

iter4() = iter2 iter2
//│ iter4: () -> (forall 'a. (('b | 'c) -> ('d & 'e & 'f & 'g & 'h) & 'g -> 'b & 'a & 'i & 'j) -> (forall 'k, 'l, 'm. ('g & 'k & 'n & 'o) -> ('l | 'h) | 'm | 'p) | 'q)
//│      = [Function: iter4]

def iter4_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│ iter4_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│         = <missing implementation>

// * Needs distributivity or constrained types
:e
iter4_ty() = iter2_ty iter2_ty
iter4_ty = iter4
//│ () -> (('X -> 'X & 'X0) -> ('X0 | 'X -> 'X) | 'a)
//│   <:  iter4_ty:
//│ () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│ ╔══[ERROR] Type mismatch in def definition:
//│ ║  l.82: 	iter4_ty() = iter2_ty iter2_ty
//│ ║        	^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── type `‘X_317_319` is not an instance of type `'X_317_318`
//│ ║  l.76: 	def iter4_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│ ║        	                            ^^
//│ ╟── Note: constraint arises from quantified type variable:
//│ ║  l.76: 	def iter4_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│ ╙──      	                            ^^
//│         = [Function: iter4_ty]
//│ () -> (forall 'a. (('b | 'c) -> ('d & 'e & 'f & 'g & 'h) & 'g -> 'b & 'a & 'i & 'j) -> (forall 'k, 'l, 'm. ('g & 'k & 'n & 'o) -> ('l | 'h) | 'm | 'p) | 'q)
//│   <:  iter4_ty:
//│ () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│ ╔══[ERROR] Type mismatch in def definition:
//│ ║  l.83: 	iter4_ty = iter4
//│ ║        	^^^^^^^^^^^^^^^^
//│ ╟── type `‘X_391_395` is not an instance of type `'X_391_394`
//│ ║  l.76: 	def iter4_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│ ║        	                            ^^
//│ ╟── Note: constraint arises from quantified type variable:
//│ ║  l.76: 	def iter4_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│ ║        	                            ^^
//│ ╟── from reference:
//│ ║  l.57: 	iter2 f x = f(f x)
//│ ╙──      	                ^
//│         = [Function: iter4]

:DistributeForalls

iter4_ty = iter4
//│ () -> (forall 'a. (('b | 'c) -> ('d & 'e & 'f & 'g & 'h) & 'g -> 'b & 'a & 'i & 'j) -> (forall 'k, 'l, 'm. ('g & 'k & 'n & 'o) -> ('l | 'h) | 'm | 'p) | 'q)
//│   <:  iter4_ty:
//│ () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│         = [Function: iter4]

iter4_ty() = iter2_ty iter2_ty
//│ () -> (('X -> 'X & 'X0) -> ('X0 | 'X -> 'X) | 'a)
//│   <:  iter4_ty:
//│ () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│         = [Function: iter4_ty3]


// 4^4 = 256.
iter256() = iter4() (iter4())
def iter256_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
iter256_ty() = iter4_ty() (iter4_ty())
iter256_ty = iter256
//│ iter256: () -> (forall 'a. (('b | 'c) -> 'd & 'e -> ('b & 'e & 'f) & 'a & 'g & 'h & 'i & 'j & 'k & 'l) -> (forall 'm, 'n, 'o. ('e & 'm) -> ('n | 'p) | 'o | 'q) | 'r)
//│   where
//│     'd <: 's & 't & 'e & 'u
//│     'u <: 'e & 'v & 'w & 'x
//│     'x <: 'e & 'y & 'z & 'p
//│     'p <: 'b & 'd & 'e & 'f
//│        = [Function: iter256]
//│ iter256_ty: () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│           = <missing implementation>
//│ () -> (('X -> 'X & 'X0) -> ('X0 | 'X -> 'X) | 'a)
//│   <:  iter256_ty:
//│ () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│           = [Function: iter256_ty]
//│ () -> (forall 'a. (('b | 'c) -> 'd & 'e -> ('b & 'e & 'f) & 'a & 'g & 'h & 'i & 'j & 'k & 'l) -> (forall 'm, 'n, 'o. ('e & 'm) -> ('n | 'p) | 'o | 'q) | 'r)
//│   where
//│     'd <: 's & 't & 'e & 'u
//│     'u <: 'e & 'v & 'w & 'x
//│     'x <: 'e & 'y & 'z & 'p
//│     'p <: 'b & 'd & 'e & 'f
//│   <:  iter256_ty:
//│ () -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
//│           = [Function: iter256]

// Church numerals.
Z s z = z
def Z_ty: forall 'X. ('X -> 'X) -> 'X -> 'X
Z_ty = Z
//│ Z: 'a -> (forall 'b. 'b -> 'b)
//│  = [Function: Z]
//│ Z_ty: ('X -> 'X) -> 'X -> 'X
//│     = <missing implementation>
//│ 'a -> (forall 'b. 'b -> 'b)
//│   <:  Z_ty:
//│ ('X -> 'X) -> 'X -> 'X
//│     = [Function: Z]

S n s z = s (n s z)
def S_ty: (forall 'X. ('X -> 'X) -> 'X -> 'X) -> (forall 'X. ('X -> 'X) -> 'X -> 'X)
S_ty = S
//│ S: ('a -> ('b -> 'c & 'd) & 'e) -> (forall 'f, 'g, 'h. (('c | 'f) -> 'g & 'a & 'h) -> (forall 'i, 'j. ('b & 'i) -> ('j | 'g)))
//│  = [Function: S]
//│ S_ty: (forall 'X. ('X -> 'X) -> 'X -> 'X) -> (forall 'X0. ('X0 -> 'X0) -> 'X0 -> 'X0)
//│     = <missing implementation>
//│ ('a -> ('b -> 'c & 'd) & 'e) -> (forall 'f, 'g, 'h. (('c | 'f) -> 'g & 'a & 'h) -> (forall 'i, 'j. ('b & 'i) -> ('j | 'g)))
//│   <:  S_ty:
//│ (forall 'X. ('X -> 'X) -> 'X -> 'X) -> (forall 'X0. ('X0 -> 'X0) -> 'X0 -> 'X0)
//│     = [Function: S]

res1() = iter4() S Z
res2() = iter256() S Z
//│ res1: () -> (forall 'a, 'b, 'c. (('d | 'a) -> 'b & 'c & 'e) -> (forall 'f, 'g. ('f & 'h) -> ('g | 'b)) | 'i)
//│   where
//│     'h <: 'j & 'k
//│     'e <: ('j | 'l) -> ('d & 'm) & 'n
//│     'n <: 'o & 'p
//│     'p <: ('d | 'q) -> ('j & 'r) & 'e
//│     = [Function: res1]
//│ res2: () -> (forall 'a, 'b, 'c. (('d | 'a) -> 'b & 'c & 'e) -> (forall 'f, 'g. ('f & 'h) -> ('g | 'b)) | 'i)
//│   where
//│     'h <: 'j & 'k
//│     'e <: 'l & 'm
//│     'm <: ('d | 'n) -> ('d & 'o) & 'e
//│     'l <: ('j | 'p) -> ('d & 'q) & 'r
//│     'r <: 's & 't & 'u & 'v & 'w & 'x
//│     'x <: ('d | 'y) -> ('j & 'z) & 'e
//│     'w <: ('d | 'a1) -> ('j & 'b1) & 'e
//│     'v <: ('d | 'c1) -> ('j & 'd1) & 'e
//│     'u <: ('d | 'e1) -> ('j & 'f1) & 'e
//│     't <: ('j | 'g1) -> ('j & 'h1) & 'r
//│     = [Function: res2]

res1_ty() = iter4_ty() S_ty Z_ty
res2_ty() = iter256_ty() S_ty Z_ty
//│ res1_ty: () -> (forall 'X, 'X0, 'a. ('X -> 'X & 'X0 -> 'X0) -> ('X & 'X0) -> ('X0 | 'X) | 'a)
//│        = [Function: res1_ty]
//│ res2_ty: () -> (forall 'X, 'X0, 'a. ('X -> 'X & 'X0 -> 'X0) -> ('X & 'X0) -> ('X0 | 'X) | 'a)
//│        = [Function: res2_ty]


S (S Z)
//│ res: (('a | 'b) -> 'c & 'd -> 'a & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│    = [Function (anonymous)]


// [Pair]

pair x y f = f x y
def pair_ty: forall 'X. forall 'Y. 'X -> 'Y -> (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z)
pair_ty = pair
fst p = p (fun x -> fun y -> x)
def fst_ty: forall 'X. forall 'Y. (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'X
fst_ty = fst
snd p = p (fun x -> fun y -> y)
def snd_ty: forall 'X. forall 'Y. (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'Y
snd_ty = snd
//│ pair: 'a -> (forall 'b. 'b -> (forall 'c, 'd, 'e. ('a -> ('b -> 'c & 'd) & 'e) -> 'c))
//│     = [Function: pair]
//│ pair_ty: 'X -> 'Y -> (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z)
//│        = <missing implementation>
//│ 'a -> (forall 'b. 'b -> (forall 'c, 'd, 'e. ('a -> ('b -> 'c & 'd) & 'e) -> 'c))
//│   <:  pair_ty:
//│ 'X -> 'Y -> (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z)
//│        = [Function: pair]
//│ fst: ((forall 'a. 'a -> (forall 'b. 'b -> 'a)) -> 'c & 'd) -> 'c
//│    = [Function: fst]
//│ fst_ty: (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'X
//│       = <missing implementation>
//│ ((forall 'a. 'a -> (forall 'b. 'b -> 'a)) -> 'c & 'd) -> 'c
//│   <:  fst_ty:
//│ (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'X
//│       = [Function: fst]
//│ snd: ((forall 'a. 'a -> (forall 'b. 'b -> 'b)) -> 'c & 'd) -> 'c
//│    = [Function: snd]
//│ snd_ty: (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'Y
//│       = <missing implementation>
//│ ((forall 'a. 'a -> (forall 'b. 'b -> 'b)) -> 'c & 'd) -> 'c
//│   <:  snd_ty:
//│ (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'Y
//│       = [Function: snd]

p02 = pair Z (S (S Z))
//│ p02: ((forall 'a. 'a -> (forall 'b. 'b -> 'b)) -> ((forall 'c, 'd, 'e. (('f | 'c) -> 'd & 'g -> 'f & 'e) -> (forall 'h, 'i. ('g & 'h) -> ('i | 'd))) -> 'j & 'k) & 'l) -> 'j
//│    = [Function (anonymous)]

p02_ty = pair_ty Z_ty (S_ty (S_ty Z_ty))
//│ p02_ty: ((forall 'X. ('X -> 'X) -> 'X -> 'X) -> (forall 'X0. ('X0 -> 'X0) -> 'X0 -> 'X0) -> 'Z) -> 'Z
//│       = [Function (anonymous)]

fp = fst p02
sp = snd p02
//│ fp: 'a -> (forall 'b. 'b -> 'b)
//│   = [Function: Z]
//│ sp: (('a | 'b) -> 'c & 'd -> 'a & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│   = [Function (anonymous)]


def fp_ty: forall 'a. ('a -> 'a) -> 'a -> 'a
fp_ty = fst_ty p02_ty
fp_ty = fp
def sp_ty: forall 'a. ('a -> 'a) -> 'a -> 'a
sp_ty = snd_ty p02_ty
sp_ty = sp
//│ fp_ty: ('a -> 'a) -> 'a -> 'a
//│      = <missing implementation>
//│ ('X -> 'X) -> 'X -> 'X
//│   <:  fp_ty:
//│ ('a -> 'a) -> 'a -> 'a
//│      = [Function: Z]
//│ 'a -> (forall 'b. 'b -> 'b)
//│   <:  fp_ty:
//│ ('a -> 'a) -> 'a -> 'a
//│      = [Function: Z]
//│ sp_ty: ('a -> 'a) -> 'a -> 'a
//│      = <missing implementation>
//│ ('X -> 'X) -> 'X -> 'X
//│   <:  sp_ty:
//│ ('a -> 'a) -> 'a -> 'a
//│      = [Function (anonymous)]
//│ (('a | 'b) -> 'c & 'd -> 'a & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│   <:  sp_ty:
//│ ('a -> 'a) -> 'a -> 'a
//│      = [Function (anonymous)]

p01 = pair (()) Z
//│ p01: (() -> ((forall 'a. 'a -> (forall 'b. 'b -> 'b)) -> 'c & 'd) & 'e) -> 'c
//│    = [Function (anonymous)]

p = pair (())
//│ p: 'a -> (forall 'b, 'c, 'd. (() -> ('a -> 'b & 'c) & 'd) -> 'b)
//│  = [Function (anonymous)]

p01 = p Z
//│ p01: (() -> ((forall 'a. 'a -> (forall 'b. 'b -> 'b)) -> 'c & 'd) & 'e) -> 'c
//│    = [Function (anonymous)]


(fun p -> p (fun x -> fun y -> x)) : forall 'X. forall 'Y. (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'X
//│ res: (forall 'Z. ('X -> 'Y -> 'Z) -> 'Z) -> 'X
//│    = [Function: res]


p02 = pair Z (S (S Z))
p02_ty = pair_ty Z_ty (S_ty (S_ty Z_ty))
p02_ty = p02
//│ p02: ((forall 'a. 'a -> (forall 'b. 'b -> 'b)) -> ((forall 'c, 'd, 'e. (('f | 'c) -> 'd & 'g -> 'f & 'e) -> (forall 'h, 'i. ('g & 'h) -> ('i | 'd))) -> 'j & 'k) & 'l) -> 'j
//│    = [Function (anonymous)]
//│ p02_ty: ((forall 'X. ('X -> 'X) -> 'X -> 'X) -> (forall 'X0. ('X0 -> 'X0) -> 'X0 -> 'X0) -> 'Z) -> 'Z
//│       = [Function (anonymous)]
//│ p02_ty: ((forall 'a. 'a -> (forall 'b. 'b -> 'b)) -> ((forall 'c, 'd, 'e. (('f | 'c) -> 'd & 'g -> 'f & 'e) -> (forall 'h, 'i. ('g & 'h) -> ('i | 'd))) -> 'j & 'k) & 'l) -> 'j
//│       = [Function (anonymous)]

fp02 = fst p02
def fp02_ty: forall 'X. ('X -> 'X) -> 'X -> 'X
fp02_ty = fst_ty p02_ty
fp02_ty = fp02
//│ fp02: 'a -> (forall 'b. 'b -> 'b)
//│     = [Function: Z]
//│ fp02_ty: ('X -> 'X) -> 'X -> 'X
//│        = <missing implementation>
//│ 'a -> (forall 'b. 'b -> 'b)
//│   <:  fp02_ty:
//│ ('X -> 'X) -> 'X -> 'X
//│        = [Function: Z]
//│ 'a -> (forall 'b. 'b -> 'b)
//│   <:  fp02_ty:
//│ ('X -> 'X) -> 'X -> 'X
//│        = [Function: Z]

:ns
fp02
//│ res: forall 'a. 'a
//│   where
//│     'a :> forall 'b. 'b -> (forall 'c. 'c -> 'c)
//│    = [Function: Z]

sp02 = snd p02
def sp02_ty: forall 'X. ('X -> 'X) -> 'X -> 'X
sp02_ty = snd_ty p02_ty
sp02_ty = sp02
//│ sp02: (('a | 'b) -> 'c & 'd -> 'a & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│     = [Function (anonymous)]
//│ sp02_ty: ('X -> 'X) -> 'X -> 'X
//│        = <missing implementation>
//│ (('a | 'b) -> 'c & 'd -> 'b & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│   <:  sp02_ty:
//│ ('X -> 'X) -> 'X -> 'X
//│        = [Function (anonymous)]
//│ (('a | 'b) -> 'c & 'd -> 'a & 'e) -> (forall 'f, 'g. ('d & 'f) -> ('g | 'c))
//│   <:  sp02_ty:
//│ ('X -> 'X) -> 'X -> 'X
//│        = [Function (anonymous)]


// * TODO try:

// [Booleans, Integers, Pairs, Lists]
// true  = \X x:X y:X.x
// false = \X x:X y:X.y
// not   = \b:forall X.X->X->X X t:X f:X.b [X] f t
// 0    = \X s:X->X z:X.z
// succ = \n:(forall X.(X->X)->X->X) X s:X->X z:X.s(n[X] s z)
// pair = \X Y x:X y:Y Z f:X->Y->Z.f x y
// fst  = \X Y p:forall Z.(X->Y->Z)->Z.p [X] (\x:X y:Y.x)
// snd  = \X Y p:forall Z.(X->Y->Z)->Z.p [Y] (\x:X y:Y.y)
// nil  = \X.(\R.\c:X->R->R.\n:R.n)
// cons = \X h:X t:forall R.(X->R->R)->R->R.(\R c:X->R->R n:R.c h (t [R] c n))


// [Surprise!]
// -- See Brown and Palsberg, "Breaking Through the Normalization Barrier:
// -- A Self-Interpreter for F-omega": "Several books, papers, and web pages"
// -- claim the following program cannot exist! That is, self-interpreters are
// -- supposedly impossible in strongly normalizing languages.

// id=\X x:X.x -- Polymorphic identity.
// true  = \X x:X y:X.x  -- Church booleans.
// false = \X x:X y:X.y
// not   = \b:forall X.X->X->X X t:X f:X.b [X] f t
tru x y = x
fls x y = y
not b t f = b f t
//│ tru: 'a -> (forall 'b. 'b -> 'a)
//│    = [Function: tru]
//│ fls: 'a -> (forall 'b. 'b -> 'b)
//│    = [Function: fls]
//│ not: ('a -> ('b -> 'c & 'd) & 'e) -> (forall 'f. ('b & 'f) -> (forall 'g, 'h. ('a & 'g) -> ('h | 'c)))
//│    = [Function: not]

// E=\T q:(forall X.X->X)->T.q id  -- Self-interpreter.
E q = q id
//│ E: ((forall 'a. 'a -> 'a) -> 'b & 'c) -> 'b
//│  = [Function: E]

// shallow (not (not true))        -- Shallow encoding.
// λid.id(λb t f.b f t)(id(λb t f.b f t)(λx y.x))
sh id = (id not) ((id not) tru)
//│ sh: ((forall 'a, 'b, 'c, 'd, 'e. ('a -> ('b -> 'c & 'd) & 'e) -> (forall 'f. ('b & 'f) -> (forall 'g, 'h. ('a & 'g) -> ('h | 'c)))) -> ((forall 'i. 'i -> (forall 'j. 'j -> 'i)) -> 'k & 'l) & (forall 'a, 'b, 'c, 'd, 'e. ('a -> ('b -> 'c & 'd) & 'e) -> (forall 'f. ('b & 'f) -> (forall 'g, 'h. ('a & 'g) -> ('h | 'c)))) -> ('k -> 'm & 'n) & 'o) -> 'm
//│   = [Function: sh]

// E[forall X.X->X->X](shallow (not( not true)))
E sh
//│ res: ('a & 'b) -> (forall 'c, 'd. 'c -> ('d | 'b))
//│    = [Function (anonymous)]

u = E
pu x y = (u x) x
sh_pu id x y = id (id u x) x
//│ u: ((forall 'a. 'a -> 'a) -> 'b & 'c) -> 'b
//│  = [Function: E]
//│ pu: ((forall 'a. 'a -> 'a) -> ('b -> 'c & 'd) & 'b) -> (forall 'e, 'f. 'e -> ('f | 'c))
//│   = [Function: pu]
//│ sh_pu: (('a | 'b) -> ('c -> 'd & 'e) & (((forall 'f. 'f -> 'f) -> 'g & 'h) -> 'g) -> ('i -> 'a & 'j) & 'k) -> (forall 'l. ('c & 'i & 'l) -> (forall 'm, 'n. 'm -> ('n | 'd)))
//│      = [Function: sh_pu]

:e
pu sh_pu
//│ ╔══[ERROR] Cyclic-looking constraint while typing application; a type annotation may be required
//│ ║  l.429: 	pu sh_pu
//│ ║         	^^^^^^^^
//│ ╟── ————————— Additional debugging info: —————————
//│ ╟── this constraint:  ‹∀ 0. ‹∀ 1. (α2955_2972'' -> ‹∀ 2. (α2956_2980''' -> ‹∀ 3. (α2957_2981'''' -> α2966_2982'''')›)›)››  <:  α2961_3054    PolymorphicType  TypeVariable
//│ ╙──  ... looks like:  ‹∀ 0. ‹∀ 1. (α2955_2972'' -> ‹∀ 2. (α2956_2980''' -> ‹∀ 3. (α2957_2981'''' -> α2966_2982'''')›)›)››  <:  α2961_2979''
//│ res: error
//│    = [Function (anonymous)]

// * "Of course, self-application of self-application ((\x.x x)(\x.x x)) remains untypable, because it has no normal form."
:e
(fun x -> x x) (fun x -> x x)
//│ ╔══[ERROR] Cyclic-looking constraint while typing application; a type annotation may be required
//│ ║  l.441: 	(fun x -> x x) (fun x -> x x)
//│ ║         	^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── ————————— Additional debugging info: —————————
//│ ╟── this constraint:  ‹∀ 0. (α3068_3070' -> α3069_3071')›  <:  α3068_3077    PolymorphicType  TypeVariable
//│ ╙──  ... looks like:  ‹∀ 0. (α3068_3070' -> α3069_3071')›  <:  α3068_3070'
//│ res: error
//│ Runtime error:
//│   RangeError: Maximum call stack size exceeded


