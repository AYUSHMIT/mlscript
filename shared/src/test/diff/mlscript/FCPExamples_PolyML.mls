:GeneralizeCurriedFunctions

// ============ Sec 1.1 ============

// i.e. auto
g = fun (f: forall 'a. 'a -> 'a) -> f f
g' = fun f -> f f
//│ g: (forall 'a. 'a -> 'a) -> (forall 'a. 'a -> 'a)
//│  = [Function: g]
//│ g': ('a -> 'b & 'a) -> 'b
//│   = [Function: g]

// i.e. auto id (FreezeML F5)
(fun (f: forall 'a. 'a -> 'a) -> f f) (fun x -> x)
(fun f -> f f) (fun x -> x)
//│ res: 'a -> 'a
//│    = [Function (anonymous)]
//│ res: 'a -> 'a
//│    = [Function (anonymous)]

// i.e. (fun auto -> auto id) auto
(fun g -> g (fun x -> x)) (fun f -> f f)
(fun g -> g (fun x -> x)) (fun (f: forall 'a. 'a -> 'a) -> f f)
//│ res: 'a -> 'a
//│    = [Function (anonymous)]
//│ res: 'a -> 'a
//│    = [Function (anonymous)]

// ============ Sec 1.2 ============

fun f -> f (g f)
fun f -> f (g' f)
//│ res: ((forall 'a. 'a -> 'a) -> 'b & 'a -> 'a) -> 'b
//│    = [Function: res]
//│ res: ('a -> 'b & 'c -> 'a & 'c) -> 'b
//│    = [Function: res]

// ============ Sec 4.1 ============

let f = fun x -> x in 
  let g = (fun x -> x) f in
    g g
//│ res: 'a -> 'a
//│    = [Function (anonymous)]

:NoJS

// ============ Sec 4.2 ============
// using FCP to solve method typing issues,
// which is overkill since it can be solved with subtyping and two levels of polymorphism...
// all of the following are typable in the main branch

// ------------ Dummy classes to represent the types in the examples ------------

class List[a]
  method Get: a
//│ Defined class List[+a]
//│ Declared List.Get: List['a] -> 'a

// Used to represent `::` in the papers
def cons[a]: a -> List[a] -> List[a]
//│ cons: 'a -> List['a] -> List['a]

// Used to represent `[]` in the papers
def nil: List['a]
//│ nil: List[nothing]

def match_list: forall 'a 'b. List['a] -> 'b -> ('a -> List['a] -> 'b) -> 'b
//│ match_list: List['a] -> 'b -> ('a -> List['a] -> 'b) -> 'b

// ------------ Type signatures for functions used in the examples ------------
// (I guess)

def mem[a]: a -> List[a] -> bool
rec def mem x l = match_list l false (fun head -> fun tail -> if eq head x then true else mem x tail)
//│ mem: anything -> List[?] -> bool
//│ anything -> (forall 'b, 'a, 'c. (List['a] -> (false | true | 'c)
//│   where
//│     'b <: List['a] -> 'c))
//│   <:  mem:
//│ anything -> List[?] -> bool
//│ ╔══[ERROR] Subtyping constraint of the form `forall ?a, ?mem, ?b, ?c, ?d. ?mem <: forall ?e. ?e -> List[?e] -> bool` exceeded recursion depth limit (400)
//│ ║  l.75: 	rec def mem x l = match_list l false (fun head -> fun tail -> if eq head x then true else mem x tail)
//│ ║        	^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α920',) -> α923')
//│ ╟── while constraining:  α207'  <!<  ((α920',) -> α923')
//│ ╟── while constraining:  {(α928' -> α927') where: α207' <: ((α920',) -> α923')}  <!<  ((α911',) -> α914')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α911',) -> α914')
//│ ╟── while constraining:  α207'  <!<  ((α911',) -> α914')
//│ ╟── while constraining:  {(α919' -> α918') where: α207' <: ((α911',) -> α914')}  <!<  ((α902',) -> α905')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α902',) -> α905')
//│ ╟── while constraining:  α207'  <!<  ((α902',) -> α905')
//│ ╟── while constraining:  {(α910' -> α909') where: α207' <: ((α902',) -> α905')}  <!<  ((α893',) -> α896')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α893',) -> α896')
//│ ╟── while constraining:  α207'  <!<  ((α893',) -> α896')
//│ ╟── while constraining:  {(α901' -> α900') where: α207' <: ((α893',) -> α896')}  <!<  ((α884',) -> α887')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α884',) -> α887')
//│ ╟── while constraining:  α207'  <!<  ((α884',) -> α887')
//│ ╟── while constraining:  {(α892' -> α891') where: α207' <: ((α884',) -> α887')}  <!<  ((α875',) -> α878')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α875',) -> α878')
//│ ╟── while constraining:  α207'  <!<  ((α875',) -> α878')
//│ ╟── while constraining:  {(α883' -> α882') where: α207' <: ((α875',) -> α878')}  <!<  ((α866',) -> α869')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α866',) -> α869')
//│ ╟── while constraining:  α207'  <!<  ((α866',) -> α869')
//│ ╟── while constraining:  {(α874' -> α873') where: α207' <: ((α866',) -> α869')}  <!<  ((α857',) -> α860')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α857',) -> α860')
//│ ╟── while constraining:  α207'  <!<  ((α857',) -> α860')
//│ ╟── while constraining:  {(α865' -> α864') where: α207' <: ((α857',) -> α860')}  <!<  ((α848',) -> α851')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α848',) -> α851')
//│ ╟── while constraining:  α207'  <!<  ((α848',) -> α851')
//│ ╟── while constraining:  {(α856' -> α855') where: α207' <: ((α848',) -> α851')}  <!<  ((α839',) -> α842')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α839',) -> α842')
//│ ╟── while constraining:  α207'  <!<  ((α839',) -> α842')
//│ ╟── while constraining:  {(α847' -> α846') where: α207' <: ((α839',) -> α842')}  <!<  ((α830',) -> α833')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α830',) -> α833')
//│ ╟── while constraining:  α207'  <!<  ((α830',) -> α833')
//│ ╟── while constraining:  {(α838' -> α837') where: α207' <: ((α830',) -> α833')}  <!<  ((α821',) -> α824')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α821',) -> α824')
//│ ╟── while constraining:  α207'  <!<  ((α821',) -> α824')
//│ ╟── while constraining:  {(α829' -> α828') where: α207' <: ((α821',) -> α824')}  <!<  ((α812',) -> α815')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α812',) -> α815')
//│ ╟── while constraining:  α207'  <!<  ((α812',) -> α815')
//│ ╟── while constraining:  {(α820' -> α819') where: α207' <: ((α812',) -> α815')}  <!<  ((α803',) -> α806')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α803',) -> α806')
//│ ╟── while constraining:  α207'  <!<  ((α803',) -> α806')
//│ ╟── while constraining:  {(α811' -> α810') where: α207' <: ((α803',) -> α806')}  <!<  ((α794',) -> α797')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α794',) -> α797')
//│ ╟── while constraining:  α207'  <!<  ((α794',) -> α797')
//│ ╟── while constraining:  {(α802' -> α801') where: α207' <: ((α794',) -> α797')}  <!<  ((α785',) -> α788')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α785',) -> α788')
//│ ╟── while constraining:  α207'  <!<  ((α785',) -> α788')
//│ ╟── while constraining:  {(α793' -> α792') where: α207' <: ((α785',) -> α788')}  <!<  ((α776',) -> α779')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α776',) -> α779')
//│ ╟── while constraining:  α207'  <!<  ((α776',) -> α779')
//│ ╟── while constraining:  {(α784' -> α783') where: α207' <: ((α776',) -> α779')}  <!<  ((α767',) -> α770')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α767',) -> α770')
//│ ╟── while constraining:  α207'  <!<  ((α767',) -> α770')
//│ ╟── while constraining:  {(α775' -> α774') where: α207' <: ((α767',) -> α770')}  <!<  ((α758',) -> α761')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α758',) -> α761')
//│ ╟── while constraining:  α207'  <!<  ((α758',) -> α761')
//│ ╟── while constraining:  {(α766' -> α765') where: α207' <: ((α758',) -> α761')}  <!<  ((α749',) -> α752')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α749',) -> α752')
//│ ╟── while constraining:  α207'  <!<  ((α749',) -> α752')
//│ ╟── while constraining:  {(α757' -> α756') where: α207' <: ((α749',) -> α752')}  <!<  ((α740',) -> α743')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α740',) -> α743')
//│ ╟── while constraining:  α207'  <!<  ((α740',) -> α743')
//│ ╟── while constraining:  {(α748' -> α747') where: α207' <: ((α740',) -> α743')}  <!<  ((α731',) -> α734')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α731',) -> α734')
//│ ╟── while constraining:  α207'  <!<  ((α731',) -> α734')
//│ ╟── while constraining:  {(α739' -> α738') where: α207' <: ((α731',) -> α734')}  <!<  ((α722',) -> α725')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α722',) -> α725')
//│ ╟── while constraining:  α207'  <!<  ((α722',) -> α725')
//│ ╟── while constraining:  {(α730' -> α729') where: α207' <: ((α722',) -> α725')}  <!<  ((α713',) -> α716')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α713',) -> α716')
//│ ╟── while constraining:  α207'  <!<  ((α713',) -> α716')
//│ ╟── while constraining:  {(α721' -> α720') where: α207' <: ((α713',) -> α716')}  <!<  ((α704',) -> α707')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α704',) -> α707')
//│ ╟── while constraining:  α207'  <!<  ((α704',) -> α707')
//│ ╟── while constraining:  {(α712' -> α711') where: α207' <: ((α704',) -> α707')}  <!<  ((α695',) -> α698')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α695',) -> α698')
//│ ╟── while constraining:  α207'  <!<  ((α695',) -> α698')
//│ ╟── while constraining:  {(α703' -> α702') where: α207' <: ((α695',) -> α698')}  <!<  ((α686',) -> α689')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α686',) -> α689')
//│ ╟── while constraining:  α207'  <!<  ((α686',) -> α689')
//│ ╟── while constraining:  {(α694' -> α693') where: α207' <: ((α686',) -> α689')}  <!<  ((α677',) -> α680')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α677',) -> α680')
//│ ╟── while constraining:  α207'  <!<  ((α677',) -> α680')
//│ ╟── while constraining:  {(α685' -> α684') where: α207' <: ((α677',) -> α680')}  <!<  ((α668',) -> α671')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α668',) -> α671')
//│ ╟── while constraining:  α207'  <!<  ((α668',) -> α671')
//│ ╟── while constraining:  {(α676' -> α675') where: α207' <: ((α668',) -> α671')}  <!<  ((α659',) -> α662')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α659',) -> α662')
//│ ╟── while constraining:  α207'  <!<  ((α659',) -> α662')
//│ ╟── while constraining:  {(α667' -> α666') where: α207' <: ((α659',) -> α662')}  <!<  ((α650',) -> α653')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α650',) -> α653')
//│ ╟── while constraining:  α207'  <!<  ((α650',) -> α653')
//│ ╟── while constraining:  {(α658' -> α657') where: α207' <: ((α650',) -> α653')}  <!<  ((α641',) -> α644')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α641',) -> α644')
//│ ╟── while constraining:  α207'  <!<  ((α641',) -> α644')
//│ ╟── while constraining:  {(α649' -> α648') where: α207' <: ((α641',) -> α644')}  <!<  ((α632',) -> α635')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α632',) -> α635')
//│ ╟── while constraining:  α207'  <!<  ((α632',) -> α635')
//│ ╟── while constraining:  {(α640' -> α639') where: α207' <: ((α632',) -> α635')}  <!<  ((α623',) -> α626')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α623',) -> α626')
//│ ╟── while constraining:  α207'  <!<  ((α623',) -> α626')
//│ ╟── while constraining:  {(α631' -> α630') where: α207' <: ((α623',) -> α626')}  <!<  ((α614',) -> α617')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α614',) -> α617')
//│ ╟── while constraining:  α207'  <!<  ((α614',) -> α617')
//│ ╟── while constraining:  {(α622' -> α621') where: α207' <: ((α614',) -> α617')}  <!<  ((α605',) -> α608')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α605',) -> α608')
//│ ╟── while constraining:  α207'  <!<  ((α605',) -> α608')
//│ ╟── while constraining:  {(α613' -> α612') where: α207' <: ((α605',) -> α608')}  <!<  ((α596',) -> α599')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α596',) -> α599')
//│ ╟── while constraining:  α207'  <!<  ((α596',) -> α599')
//│ ╟── while constraining:  {(α604' -> α603') where: α207' <: ((α596',) -> α599')}  <!<  ((α587',) -> α590')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α587',) -> α590')
//│ ╟── while constraining:  α207'  <!<  ((α587',) -> α590')
//│ ╟── while constraining:  {(α595' -> α594') where: α207' <: ((α587',) -> α590')}  <!<  ((α578',) -> α581')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α578',) -> α581')
//│ ╟── while constraining:  α207'  <!<  ((α578',) -> α581')
//│ ╟── while constraining:  {(α586' -> α585') where: α207' <: ((α578',) -> α581')}  <!<  ((α569',) -> α572')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α569',) -> α572')
//│ ╟── while constraining:  α207'  <!<  ((α569',) -> α572')
//│ ╟── while constraining:  {(α577' -> α576') where: α207' <: ((α569',) -> α572')}  <!<  ((α560',) -> α563')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α560',) -> α563')
//│ ╟── while constraining:  α207'  <!<  ((α560',) -> α563')
//│ ╟── while constraining:  {(α568' -> α567') where: α207' <: ((α560',) -> α563')}  <!<  ((α551',) -> α554')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α551',) -> α554')
//│ ╟── while constraining:  α207'  <!<  ((α551',) -> α554')
//│ ╟── while constraining:  {(α559' -> α558') where: α207' <: ((α551',) -> α554')}  <!<  ((α542',) -> α545')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α542',) -> α545')
//│ ╟── while constraining:  α207'  <!<  ((α542',) -> α545')
//│ ╟── while constraining:  {(α550' -> α549') where: α207' <: ((α542',) -> α545')}  <!<  ((α533',) -> α536')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α533',) -> α536')
//│ ╟── while constraining:  α207'  <!<  ((α533',) -> α536')
//│ ╟── while constraining:  {(α541' -> α540') where: α207' <: ((α533',) -> α536')}  <!<  ((α524',) -> α527')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α524',) -> α527')
//│ ╟── while constraining:  α207'  <!<  ((α524',) -> α527')
//│ ╟── while constraining:  {(α532' -> α531') where: α207' <: ((α524',) -> α527')}  <!<  ((α515',) -> α518')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α515',) -> α518')
//│ ╟── while constraining:  α207'  <!<  ((α515',) -> α518')
//│ ╟── while constraining:  {(α523' -> α522') where: α207' <: ((α515',) -> α518')}  <!<  ((α506',) -> α509')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α506',) -> α509')
//│ ╟── while constraining:  α207'  <!<  ((α506',) -> α509')
//│ ╟── while constraining:  {(α514' -> α513') where: α207' <: ((α506',) -> α509')}  <!<  ((α497',) -> α500')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α497',) -> α500')
//│ ╟── while constraining:  α207'  <!<  ((α497',) -> α500')
//│ ╟── while constraining:  {(α505' -> α504') where: α207' <: ((α497',) -> α500')}  <!<  ((α488',) -> α491')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α488',) -> α491')
//│ ╟── while constraining:  α207'  <!<  ((α488',) -> α491')
//│ ╟── while constraining:  {(α496' -> α495') where: α207' <: ((α488',) -> α491')}  <!<  ((α479',) -> α482')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α479',) -> α482')
//│ ╟── while constraining:  α207'  <!<  ((α479',) -> α482')
//│ ╟── while constraining:  {(α487' -> α486') where: α207' <: ((α479',) -> α482')}  <!<  ((α470',) -> α473')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α470',) -> α473')
//│ ╟── while constraining:  α207'  <!<  ((α470',) -> α473')
//│ ╟── while constraining:  {(α478' -> α477') where: α207' <: ((α470',) -> α473')}  <!<  ((α461',) -> α464')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α461',) -> α464')
//│ ╟── while constraining:  α207'  <!<  ((α461',) -> α464')
//│ ╟── while constraining:  {(α469' -> α468') where: α207' <: ((α461',) -> α464')}  <!<  ((α452',) -> α455')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α452',) -> α455')
//│ ╟── while constraining:  α207'  <!<  ((α452',) -> α455')
//│ ╟── while constraining:  {(α460' -> α459') where: α207' <: ((α452',) -> α455')}  <!<  ((α443',) -> α446')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α443',) -> α446')
//│ ╟── while constraining:  α207'  <!<  ((α443',) -> α446')
//│ ╟── while constraining:  {(α451' -> α450') where: α207' <: ((α443',) -> α446')}  <!<  ((α434',) -> α437')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α434',) -> α437')
//│ ╟── while constraining:  α207'  <!<  ((α434',) -> α437')
//│ ╟── while constraining:  {(α442' -> α441') where: α207' <: ((α434',) -> α437')}  <!<  ((α425',) -> α428')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α425',) -> α428')
//│ ╟── while constraining:  α207'  <!<  ((α425',) -> α428')
//│ ╟── while constraining:  {(α433' -> α432') where: α207' <: ((α425',) -> α428')}  <!<  ((α416',) -> α419')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α416',) -> α419')
//│ ╟── while constraining:  α207'  <!<  ((α416',) -> α419')
//│ ╟── while constraining:  {(α424' -> α423') where: α207' <: ((α416',) -> α419')}  <!<  ((α407',) -> α410')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α407',) -> α410')
//│ ╟── while constraining:  α207'  <!<  ((α407',) -> α410')
//│ ╟── while constraining:  {(α415' -> α414') where: α207' <: ((α407',) -> α410')}  <!<  ((α398',) -> α401')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α398',) -> α401')
//│ ╟── while constraining:  α207'  <!<  ((α398',) -> α401')
//│ ╟── while constraining:  {(α406' -> α405') where: α207' <: ((α398',) -> α401')}  <!<  ((α389',) -> α392')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α389',) -> α392')
//│ ╟── while constraining:  α207'  <!<  ((α389',) -> α392')
//│ ╟── while constraining:  {(α397' -> α396') where: α207' <: ((α389',) -> α392')}  <!<  ((α380',) -> α383')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α380',) -> α383')
//│ ╟── while constraining:  α207'  <!<  ((α380',) -> α383')
//│ ╟── while constraining:  {(α388' -> α387') where: α207' <: ((α380',) -> α383')}  <!<  ((α371',) -> α374')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α371',) -> α374')
//│ ╟── while constraining:  α207'  <!<  ((α371',) -> α374')
//│ ╟── while constraining:  {(α379' -> α378') where: α207' <: ((α371',) -> α374')}  <!<  ((α362',) -> α365')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α362',) -> α365')
//│ ╟── while constraining:  α207'  <!<  ((α362',) -> α365')
//│ ╟── while constraining:  {(α370' -> α369') where: α207' <: ((α362',) -> α365')}  <!<  ((α353',) -> α356')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α353',) -> α356')
//│ ╟── while constraining:  α207'  <!<  ((α353',) -> α356')
//│ ╟── while constraining:  {(α361' -> α360') where: α207' <: ((α353',) -> α356')}  <!<  ((α344',) -> α347')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α344',) -> α347')
//│ ╟── while constraining:  α207'  <!<  ((α344',) -> α347')
//│ ╟── while constraining:  {(α352' -> α351') where: α207' <: ((α344',) -> α347')}  <!<  ((α335',) -> α338')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α335',) -> α338')
//│ ╟── while constraining:  α207'  <!<  ((α335',) -> α338')
//│ ╟── while constraining:  {(α343' -> α342') where: α207' <: ((α335',) -> α338')}  <!<  ((α326',) -> α329')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α326',) -> α329')
//│ ╟── while constraining:  α207'  <!<  ((α326',) -> α329')
//│ ╟── while constraining:  {(α334' -> α333') where: α207' <: ((α326',) -> α329')}  <!<  ((α317',) -> α320')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α317',) -> α320')
//│ ╟── while constraining:  α207'  <!<  ((α317',) -> α320')
//│ ╟── while constraining:  {(α325' -> α324') where: α207' <: ((α317',) -> α320')}  <!<  ((α308',) -> α311')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α308',) -> α311')
//│ ╟── while constraining:  α207'  <!<  ((α308',) -> α311')
//│ ╟── while constraining:  {(α316' -> α315') where: α207' <: ((α308',) -> α311')}  <!<  ((α299',) -> α302')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α299',) -> α302')
//│ ╟── while constraining:  α207'  <!<  ((α299',) -> α302')
//│ ╟── while constraining:  {(α307' -> α306') where: α207' <: ((α299',) -> α302')}  <!<  ((α290',) -> α293')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α290',) -> α293')
//│ ╟── while constraining:  α207'  <!<  ((α290',) -> α293')
//│ ╟── while constraining:  {(α298' -> α297') where: α207' <: ((α290',) -> α293')}  <!<  ((α281',) -> α284')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α281',) -> α284')
//│ ╟── while constraining:  α207'  <!<  ((α281',) -> α284')
//│ ╟── while constraining:  {(α289' -> α288') where: α207' <: ((α281',) -> α284')}  <!<  ((α272',) -> α275')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α272',) -> α275')
//│ ╟── while constraining:  α207'  <!<  ((α272',) -> α275')
//│ ╟── while constraining:  {(α280' -> α279') where: α207' <: ((α272',) -> α275')}  <!<  ((α263',) -> α266')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α263',) -> α266')
//│ ╟── while constraining:  α207'  <!<  ((α263',) -> α266')
//│ ╟── while constraining:  {(α271' -> α270') where: α207' <: ((α263',) -> α266')}  <!<  ((α254',) -> α257')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α254',) -> α257')
//│ ╟── while constraining:  α207'  <!<  ((α254',) -> α257')
//│ ╟── while constraining:  {(α262' -> α261') where: α207' <: ((α254',) -> α257')}  <!<  ((α245',) -> α248')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α245',) -> α248')
//│ ╟── while constraining:  α207'  <!<  ((α245',) -> α248')
//│ ╟── while constraining:  {(α253' -> α252') where: α207' <: ((α245',) -> α248')}  <!<  ((α236',) -> α239')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α236',) -> α239')
//│ ╟── while constraining:  α207'  <!<  ((α236',) -> α239')
//│ ╟── while constraining:  {(α244' -> α243') where: α207' <: ((α236',) -> α239')}  <!<  ((α227',) -> α230')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α227',) -> α230')
//│ ╟── while constraining:  α207'  <!<  ((α227',) -> α230')
//│ ╟── while constraining:  {(α235' -> α234') where: α207' <: ((α227',) -> α230')}  <!<  ((α218',) -> α221')
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  ((α218',) -> α221')
//│ ╟── while constraining:  α207'  <!<  ((α218',) -> α221')
//│ ╟── while constraining:  {(α226' -> α225') where: α207' <: ((α218',) -> α221')}  <!<  (List[_α202''] -> Bool)
//│ ╟── while constraining:  ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›  <!<  (List[_α202''] -> Bool)
//│ ╟── while constraining:  (α217' -> ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›)  <!<  (_α202'' -> (List[_α202''] -> Bool))
//│ ╟── while constraining:  ‹∀ 1. (α204'' -> ‹∀ 2. {(α216''' -> α215''') where: α207' <: ((α208''',) -> α211''')}›)›  <!<  (_α202'' -> (List[_α202''] -> Bool))
//│ ╟── while constraining:  mem203'  <!<  (_α202'' -> (List[_α202''] -> Bool))
//│ ╟── while constraining:  ‹∀ 0. mem153'›  <!<  (_α202'' -> (List[_α202''] -> Bool))
//│ ╙── while constraining:  ‹∀ 0. mem153'›  <!<  ‹∀ 0. (α151' -> (List[α151'] -> Bool))›




// def fold_left[a, b]: (a -> b -> a) -> a -> List[b] -> a
def fold_left: forall 'a 'b. ('a -> 'b -> 'a) -> 'a -> List['b] -> 'a
//│ fold_left: ('a -> 'b -> 'a) -> 'a -> List['b] -> 'a

rec def fl f x l = match_list l x (fun head -> fun tail -> fl f (f x head) tail)
//│ fl: 'b -> (forall 'c. 'c -> (forall 'b, 'c, 'd, 'e, 'a, 'f. (List['a] -> ('c | 'f)
//│   where
//│     'd <: 'e -> List['a] -> 'f
//│     'b <: 'c -> 'a -> 'e)))

rec def fl2 f x l = match_list l x (fun head -> fun tail -> fold_left f (f x head) tail)
//│ fl2: 'c -> (forall 'd. 'd -> (forall 'c, 'd, 'a, 'b. (List['b] -> ('a | 'd)
//│   where
//│     'c <: ('a | 'd) -> 'b -> 'a & 'd -> 'b -> 'a)))

// :d
def fold_left = fl
//│ 'b -> (forall 'c. 'c -> (forall 'b, 'c, 'd, 'e, 'a, 'f. (List['a] -> ('c | 'f)
//│   where
//│     'd <: 'e -> List['a] -> 'f
//│     'b <: 'c -> 'a -> 'e)))
//│   <:  fold_left:
//│ ('a -> 'b -> 'a) -> 'a -> List['b] -> 'a
//│ ╔══[ERROR] Subtyping constraint of the form `forall ?c, ?d, ?e, ?f, ?fl, ?g, ?h, ?i. ?fl <: forall ?a, ?b. (?a -> ?b -> ?a) -> ?a -> List[?b] -> ?a` exceeded recursion depth limit (400)
//│ ║  l.348: 	def fold_left = fl
//│ ║         	^^^^^^^^^^^^^^^^^^
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1906'',) -> α1907'')
//│ ╟── while constraining:  α1138''  <!<  ((α1906'',) -> α1907'')
//│ ╟── while constraining:  {(α1915'' -> α1913'') where: α1138'' <: ((α1906'',) -> α1907''), α1136'' <: ((α1895'',) -> α1914'')}  <!<  ((α1887'',) -> α1890'')
//│ ╟── while constraining:  ‹∀ 3. {(α1905'''' -> α1903'''') where: α1138'' <: ((α1896'''',) -> α1897''''), α1136'' <: ((α1895'',) -> α1904'''')}›  <!<  ((α1887'',) -> α1890'')
//│ ╟── while constraining:  ‹∀ 3. {(α1905'''' -> α1903'''') where: α1138'' <: ((α1896'''',) -> α1897''''), α1136'' <: ((α1895'',) -> α1904'''')}›  <!<  α1886''
//│ ╟── while constraining:  (α1895'' -> ‹∀ 3. {(α1905'''' -> α1903'''') where: α1138'' <: ((α1896'''',) -> α1897''''), α1136'' <: ((α1895'',) -> α1904'''')}›)  <!<  ((α1885'',) -> α1886'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1885'',) -> α1886'')
//│ ╟── while constraining:  α1138''  <!<  ((α1885'',) -> α1886'')
//│ ╟── while constraining:  {(α1894'' -> α1892'') where: α1138'' <: ((α1885'',) -> α1886''), α1136'' <: ((α1874'',) -> α1893'')}  <!<  ((α1866'',) -> α1869'')
//│ ╟── while constraining:  ‹∀ 3. {(α1884'''' -> α1882'''') where: α1138'' <: ((α1875'''',) -> α1876''''), α1136'' <: ((α1874'',) -> α1883'''')}›  <!<  ((α1866'',) -> α1869'')
//│ ╟── while constraining:  ‹∀ 3. {(α1884'''' -> α1882'''') where: α1138'' <: ((α1875'''',) -> α1876''''), α1136'' <: ((α1874'',) -> α1883'''')}›  <!<  α1865''
//│ ╟── while constraining:  (α1874'' -> ‹∀ 3. {(α1884'''' -> α1882'''') where: α1138'' <: ((α1875'''',) -> α1876''''), α1136'' <: ((α1874'',) -> α1883'''')}›)  <!<  ((α1864'',) -> α1865'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1864'',) -> α1865'')
//│ ╟── while constraining:  α1138''  <!<  ((α1864'',) -> α1865'')
//│ ╟── while constraining:  {(α1873'' -> α1871'') where: α1138'' <: ((α1864'',) -> α1865''), α1136'' <: ((α1853'',) -> α1872'')}  <!<  ((α1845'',) -> α1848'')
//│ ╟── while constraining:  ‹∀ 3. {(α1863'''' -> α1861'''') where: α1138'' <: ((α1854'''',) -> α1855''''), α1136'' <: ((α1853'',) -> α1862'''')}›  <!<  ((α1845'',) -> α1848'')
//│ ╟── while constraining:  ‹∀ 3. {(α1863'''' -> α1861'''') where: α1138'' <: ((α1854'''',) -> α1855''''), α1136'' <: ((α1853'',) -> α1862'''')}›  <!<  α1844''
//│ ╟── while constraining:  (α1853'' -> ‹∀ 3. {(α1863'''' -> α1861'''') where: α1138'' <: ((α1854'''',) -> α1855''''), α1136'' <: ((α1853'',) -> α1862'''')}›)  <!<  ((α1843'',) -> α1844'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1843'',) -> α1844'')
//│ ╟── while constraining:  α1138''  <!<  ((α1843'',) -> α1844'')
//│ ╟── while constraining:  {(α1852'' -> α1850'') where: α1138'' <: ((α1843'',) -> α1844''), α1136'' <: ((α1832'',) -> α1851'')}  <!<  ((α1824'',) -> α1827'')
//│ ╟── while constraining:  ‹∀ 3. {(α1842'''' -> α1840'''') where: α1138'' <: ((α1833'''',) -> α1834''''), α1136'' <: ((α1832'',) -> α1841'''')}›  <!<  ((α1824'',) -> α1827'')
//│ ╟── while constraining:  ‹∀ 3. {(α1842'''' -> α1840'''') where: α1138'' <: ((α1833'''',) -> α1834''''), α1136'' <: ((α1832'',) -> α1841'''')}›  <!<  α1823''
//│ ╟── while constraining:  (α1832'' -> ‹∀ 3. {(α1842'''' -> α1840'''') where: α1138'' <: ((α1833'''',) -> α1834''''), α1136'' <: ((α1832'',) -> α1841'''')}›)  <!<  ((α1822'',) -> α1823'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1822'',) -> α1823'')
//│ ╟── while constraining:  α1138''  <!<  ((α1822'',) -> α1823'')
//│ ╟── while constraining:  {(α1831'' -> α1829'') where: α1138'' <: ((α1822'',) -> α1823''), α1136'' <: ((α1811'',) -> α1830'')}  <!<  ((α1803'',) -> α1806'')
//│ ╟── while constraining:  ‹∀ 3. {(α1821'''' -> α1819'''') where: α1138'' <: ((α1812'''',) -> α1813''''), α1136'' <: ((α1811'',) -> α1820'''')}›  <!<  ((α1803'',) -> α1806'')
//│ ╟── while constraining:  ‹∀ 3. {(α1821'''' -> α1819'''') where: α1138'' <: ((α1812'''',) -> α1813''''), α1136'' <: ((α1811'',) -> α1820'''')}›  <!<  α1802''
//│ ╟── while constraining:  (α1811'' -> ‹∀ 3. {(α1821'''' -> α1819'''') where: α1138'' <: ((α1812'''',) -> α1813''''), α1136'' <: ((α1811'',) -> α1820'''')}›)  <!<  ((α1801'',) -> α1802'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1801'',) -> α1802'')
//│ ╟── while constraining:  α1138''  <!<  ((α1801'',) -> α1802'')
//│ ╟── while constraining:  {(α1810'' -> α1808'') where: α1138'' <: ((α1801'',) -> α1802''), α1136'' <: ((α1790'',) -> α1809'')}  <!<  ((α1782'',) -> α1785'')
//│ ╟── while constraining:  ‹∀ 3. {(α1800'''' -> α1798'''') where: α1138'' <: ((α1791'''',) -> α1792''''), α1136'' <: ((α1790'',) -> α1799'''')}›  <!<  ((α1782'',) -> α1785'')
//│ ╟── while constraining:  ‹∀ 3. {(α1800'''' -> α1798'''') where: α1138'' <: ((α1791'''',) -> α1792''''), α1136'' <: ((α1790'',) -> α1799'''')}›  <!<  α1781''
//│ ╟── while constraining:  (α1790'' -> ‹∀ 3. {(α1800'''' -> α1798'''') where: α1138'' <: ((α1791'''',) -> α1792''''), α1136'' <: ((α1790'',) -> α1799'''')}›)  <!<  ((α1780'',) -> α1781'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1780'',) -> α1781'')
//│ ╟── while constraining:  α1138''  <!<  ((α1780'',) -> α1781'')
//│ ╟── while constraining:  {(α1789'' -> α1787'') where: α1138'' <: ((α1780'',) -> α1781''), α1136'' <: ((α1769'',) -> α1788'')}  <!<  ((α1761'',) -> α1764'')
//│ ╟── while constraining:  ‹∀ 3. {(α1779'''' -> α1777'''') where: α1138'' <: ((α1770'''',) -> α1771''''), α1136'' <: ((α1769'',) -> α1778'''')}›  <!<  ((α1761'',) -> α1764'')
//│ ╟── while constraining:  ‹∀ 3. {(α1779'''' -> α1777'''') where: α1138'' <: ((α1770'''',) -> α1771''''), α1136'' <: ((α1769'',) -> α1778'''')}›  <!<  α1760''
//│ ╟── while constraining:  (α1769'' -> ‹∀ 3. {(α1779'''' -> α1777'''') where: α1138'' <: ((α1770'''',) -> α1771''''), α1136'' <: ((α1769'',) -> α1778'''')}›)  <!<  ((α1759'',) -> α1760'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1759'',) -> α1760'')
//│ ╟── while constraining:  α1138''  <!<  ((α1759'',) -> α1760'')
//│ ╟── while constraining:  {(α1768'' -> α1766'') where: α1138'' <: ((α1759'',) -> α1760''), α1136'' <: ((α1748'',) -> α1767'')}  <!<  ((α1740'',) -> α1743'')
//│ ╟── while constraining:  ‹∀ 3. {(α1758'''' -> α1756'''') where: α1138'' <: ((α1749'''',) -> α1750''''), α1136'' <: ((α1748'',) -> α1757'''')}›  <!<  ((α1740'',) -> α1743'')
//│ ╟── while constraining:  ‹∀ 3. {(α1758'''' -> α1756'''') where: α1138'' <: ((α1749'''',) -> α1750''''), α1136'' <: ((α1748'',) -> α1757'''')}›  <!<  α1739''
//│ ╟── while constraining:  (α1748'' -> ‹∀ 3. {(α1758'''' -> α1756'''') where: α1138'' <: ((α1749'''',) -> α1750''''), α1136'' <: ((α1748'',) -> α1757'''')}›)  <!<  ((α1738'',) -> α1739'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1738'',) -> α1739'')
//│ ╟── while constraining:  α1138''  <!<  ((α1738'',) -> α1739'')
//│ ╟── while constraining:  {(α1747'' -> α1745'') where: α1138'' <: ((α1738'',) -> α1739''), α1136'' <: ((α1727'',) -> α1746'')}  <!<  ((α1719'',) -> α1722'')
//│ ╟── while constraining:  ‹∀ 3. {(α1737'''' -> α1735'''') where: α1138'' <: ((α1728'''',) -> α1729''''), α1136'' <: ((α1727'',) -> α1736'''')}›  <!<  ((α1719'',) -> α1722'')
//│ ╟── while constraining:  ‹∀ 3. {(α1737'''' -> α1735'''') where: α1138'' <: ((α1728'''',) -> α1729''''), α1136'' <: ((α1727'',) -> α1736'''')}›  <!<  α1718''
//│ ╟── while constraining:  (α1727'' -> ‹∀ 3. {(α1737'''' -> α1735'''') where: α1138'' <: ((α1728'''',) -> α1729''''), α1136'' <: ((α1727'',) -> α1736'''')}›)  <!<  ((α1717'',) -> α1718'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1717'',) -> α1718'')
//│ ╟── while constraining:  α1138''  <!<  ((α1717'',) -> α1718'')
//│ ╟── while constraining:  {(α1726'' -> α1724'') where: α1138'' <: ((α1717'',) -> α1718''), α1136'' <: ((α1706'',) -> α1725'')}  <!<  ((α1698'',) -> α1701'')
//│ ╟── while constraining:  ‹∀ 3. {(α1716'''' -> α1714'''') where: α1138'' <: ((α1707'''',) -> α1708''''), α1136'' <: ((α1706'',) -> α1715'''')}›  <!<  ((α1698'',) -> α1701'')
//│ ╟── while constraining:  ‹∀ 3. {(α1716'''' -> α1714'''') where: α1138'' <: ((α1707'''',) -> α1708''''), α1136'' <: ((α1706'',) -> α1715'''')}›  <!<  α1697''
//│ ╟── while constraining:  (α1706'' -> ‹∀ 3. {(α1716'''' -> α1714'''') where: α1138'' <: ((α1707'''',) -> α1708''''), α1136'' <: ((α1706'',) -> α1715'''')}›)  <!<  ((α1696'',) -> α1697'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1696'',) -> α1697'')
//│ ╟── while constraining:  α1138''  <!<  ((α1696'',) -> α1697'')
//│ ╟── while constraining:  {(α1705'' -> α1703'') where: α1138'' <: ((α1696'',) -> α1697''), α1136'' <: ((α1685'',) -> α1704'')}  <!<  ((α1677'',) -> α1680'')
//│ ╟── while constraining:  ‹∀ 3. {(α1695'''' -> α1693'''') where: α1138'' <: ((α1686'''',) -> α1687''''), α1136'' <: ((α1685'',) -> α1694'''')}›  <!<  ((α1677'',) -> α1680'')
//│ ╟── while constraining:  ‹∀ 3. {(α1695'''' -> α1693'''') where: α1138'' <: ((α1686'''',) -> α1687''''), α1136'' <: ((α1685'',) -> α1694'''')}›  <!<  α1676''
//│ ╟── while constraining:  (α1685'' -> ‹∀ 3. {(α1695'''' -> α1693'''') where: α1138'' <: ((α1686'''',) -> α1687''''), α1136'' <: ((α1685'',) -> α1694'''')}›)  <!<  ((α1675'',) -> α1676'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1675'',) -> α1676'')
//│ ╟── while constraining:  α1138''  <!<  ((α1675'',) -> α1676'')
//│ ╟── while constraining:  {(α1684'' -> α1682'') where: α1138'' <: ((α1675'',) -> α1676''), α1136'' <: ((α1664'',) -> α1683'')}  <!<  ((α1656'',) -> α1659'')
//│ ╟── while constraining:  ‹∀ 3. {(α1674'''' -> α1672'''') where: α1138'' <: ((α1665'''',) -> α1666''''), α1136'' <: ((α1664'',) -> α1673'''')}›  <!<  ((α1656'',) -> α1659'')
//│ ╟── while constraining:  ‹∀ 3. {(α1674'''' -> α1672'''') where: α1138'' <: ((α1665'''',) -> α1666''''), α1136'' <: ((α1664'',) -> α1673'''')}›  <!<  α1655''
//│ ╟── while constraining:  (α1664'' -> ‹∀ 3. {(α1674'''' -> α1672'''') where: α1138'' <: ((α1665'''',) -> α1666''''), α1136'' <: ((α1664'',) -> α1673'''')}›)  <!<  ((α1654'',) -> α1655'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1654'',) -> α1655'')
//│ ╟── while constraining:  α1138''  <!<  ((α1654'',) -> α1655'')
//│ ╟── while constraining:  {(α1663'' -> α1661'') where: α1138'' <: ((α1654'',) -> α1655''), α1136'' <: ((α1643'',) -> α1662'')}  <!<  ((α1635'',) -> α1638'')
//│ ╟── while constraining:  ‹∀ 3. {(α1653'''' -> α1651'''') where: α1138'' <: ((α1644'''',) -> α1645''''), α1136'' <: ((α1643'',) -> α1652'''')}›  <!<  ((α1635'',) -> α1638'')
//│ ╟── while constraining:  ‹∀ 3. {(α1653'''' -> α1651'''') where: α1138'' <: ((α1644'''',) -> α1645''''), α1136'' <: ((α1643'',) -> α1652'''')}›  <!<  α1634''
//│ ╟── while constraining:  (α1643'' -> ‹∀ 3. {(α1653'''' -> α1651'''') where: α1138'' <: ((α1644'''',) -> α1645''''), α1136'' <: ((α1643'',) -> α1652'''')}›)  <!<  ((α1633'',) -> α1634'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1633'',) -> α1634'')
//│ ╟── while constraining:  α1138''  <!<  ((α1633'',) -> α1634'')
//│ ╟── while constraining:  {(α1642'' -> α1640'') where: α1138'' <: ((α1633'',) -> α1634''), α1136'' <: ((α1622'',) -> α1641'')}  <!<  ((α1614'',) -> α1617'')
//│ ╟── while constraining:  ‹∀ 3. {(α1632'''' -> α1630'''') where: α1138'' <: ((α1623'''',) -> α1624''''), α1136'' <: ((α1622'',) -> α1631'''')}›  <!<  ((α1614'',) -> α1617'')
//│ ╟── while constraining:  ‹∀ 3. {(α1632'''' -> α1630'''') where: α1138'' <: ((α1623'''',) -> α1624''''), α1136'' <: ((α1622'',) -> α1631'''')}›  <!<  α1613''
//│ ╟── while constraining:  (α1622'' -> ‹∀ 3. {(α1632'''' -> α1630'''') where: α1138'' <: ((α1623'''',) -> α1624''''), α1136'' <: ((α1622'',) -> α1631'''')}›)  <!<  ((α1612'',) -> α1613'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1612'',) -> α1613'')
//│ ╟── while constraining:  α1138''  <!<  ((α1612'',) -> α1613'')
//│ ╟── while constraining:  {(α1621'' -> α1619'') where: α1138'' <: ((α1612'',) -> α1613''), α1136'' <: ((α1601'',) -> α1620'')}  <!<  ((α1593'',) -> α1596'')
//│ ╟── while constraining:  ‹∀ 3. {(α1611'''' -> α1609'''') where: α1138'' <: ((α1602'''',) -> α1603''''), α1136'' <: ((α1601'',) -> α1610'''')}›  <!<  ((α1593'',) -> α1596'')
//│ ╟── while constraining:  ‹∀ 3. {(α1611'''' -> α1609'''') where: α1138'' <: ((α1602'''',) -> α1603''''), α1136'' <: ((α1601'',) -> α1610'''')}›  <!<  α1592''
//│ ╟── while constraining:  (α1601'' -> ‹∀ 3. {(α1611'''' -> α1609'''') where: α1138'' <: ((α1602'''',) -> α1603''''), α1136'' <: ((α1601'',) -> α1610'''')}›)  <!<  ((α1591'',) -> α1592'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1591'',) -> α1592'')
//│ ╟── while constraining:  α1138''  <!<  ((α1591'',) -> α1592'')
//│ ╟── while constraining:  {(α1600'' -> α1598'') where: α1138'' <: ((α1591'',) -> α1592''), α1136'' <: ((α1580'',) -> α1599'')}  <!<  ((α1572'',) -> α1575'')
//│ ╟── while constraining:  ‹∀ 3. {(α1590'''' -> α1588'''') where: α1138'' <: ((α1581'''',) -> α1582''''), α1136'' <: ((α1580'',) -> α1589'''')}›  <!<  ((α1572'',) -> α1575'')
//│ ╟── while constraining:  ‹∀ 3. {(α1590'''' -> α1588'''') where: α1138'' <: ((α1581'''',) -> α1582''''), α1136'' <: ((α1580'',) -> α1589'''')}›  <!<  α1571''
//│ ╟── while constraining:  (α1580'' -> ‹∀ 3. {(α1590'''' -> α1588'''') where: α1138'' <: ((α1581'''',) -> α1582''''), α1136'' <: ((α1580'',) -> α1589'''')}›)  <!<  ((α1570'',) -> α1571'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1570'',) -> α1571'')
//│ ╟── while constraining:  α1138''  <!<  ((α1570'',) -> α1571'')
//│ ╟── while constraining:  {(α1579'' -> α1577'') where: α1138'' <: ((α1570'',) -> α1571''), α1136'' <: ((α1559'',) -> α1578'')}  <!<  ((α1551'',) -> α1554'')
//│ ╟── while constraining:  ‹∀ 3. {(α1569'''' -> α1567'''') where: α1138'' <: ((α1560'''',) -> α1561''''), α1136'' <: ((α1559'',) -> α1568'''')}›  <!<  ((α1551'',) -> α1554'')
//│ ╟── while constraining:  ‹∀ 3. {(α1569'''' -> α1567'''') where: α1138'' <: ((α1560'''',) -> α1561''''), α1136'' <: ((α1559'',) -> α1568'''')}›  <!<  α1550''
//│ ╟── while constraining:  (α1559'' -> ‹∀ 3. {(α1569'''' -> α1567'''') where: α1138'' <: ((α1560'''',) -> α1561''''), α1136'' <: ((α1559'',) -> α1568'''')}›)  <!<  ((α1549'',) -> α1550'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1549'',) -> α1550'')
//│ ╟── while constraining:  α1138''  <!<  ((α1549'',) -> α1550'')
//│ ╟── while constraining:  {(α1558'' -> α1556'') where: α1138'' <: ((α1549'',) -> α1550''), α1136'' <: ((α1538'',) -> α1557'')}  <!<  ((α1530'',) -> α1533'')
//│ ╟── while constraining:  ‹∀ 3. {(α1548'''' -> α1546'''') where: α1138'' <: ((α1539'''',) -> α1540''''), α1136'' <: ((α1538'',) -> α1547'''')}›  <!<  ((α1530'',) -> α1533'')
//│ ╟── while constraining:  ‹∀ 3. {(α1548'''' -> α1546'''') where: α1138'' <: ((α1539'''',) -> α1540''''), α1136'' <: ((α1538'',) -> α1547'''')}›  <!<  α1529''
//│ ╟── while constraining:  (α1538'' -> ‹∀ 3. {(α1548'''' -> α1546'''') where: α1138'' <: ((α1539'''',) -> α1540''''), α1136'' <: ((α1538'',) -> α1547'''')}›)  <!<  ((α1528'',) -> α1529'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1528'',) -> α1529'')
//│ ╟── while constraining:  α1138''  <!<  ((α1528'',) -> α1529'')
//│ ╟── while constraining:  {(α1537'' -> α1535'') where: α1138'' <: ((α1528'',) -> α1529''), α1136'' <: ((α1517'',) -> α1536'')}  <!<  ((α1509'',) -> α1512'')
//│ ╟── while constraining:  ‹∀ 3. {(α1527'''' -> α1525'''') where: α1138'' <: ((α1518'''',) -> α1519''''), α1136'' <: ((α1517'',) -> α1526'''')}›  <!<  ((α1509'',) -> α1512'')
//│ ╟── while constraining:  ‹∀ 3. {(α1527'''' -> α1525'''') where: α1138'' <: ((α1518'''',) -> α1519''''), α1136'' <: ((α1517'',) -> α1526'''')}›  <!<  α1508''
//│ ╟── while constraining:  (α1517'' -> ‹∀ 3. {(α1527'''' -> α1525'''') where: α1138'' <: ((α1518'''',) -> α1519''''), α1136'' <: ((α1517'',) -> α1526'''')}›)  <!<  ((α1507'',) -> α1508'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1507'',) -> α1508'')
//│ ╟── while constraining:  α1138''  <!<  ((α1507'',) -> α1508'')
//│ ╟── while constraining:  {(α1516'' -> α1514'') where: α1138'' <: ((α1507'',) -> α1508''), α1136'' <: ((α1496'',) -> α1515'')}  <!<  ((α1488'',) -> α1491'')
//│ ╟── while constraining:  ‹∀ 3. {(α1506'''' -> α1504'''') where: α1138'' <: ((α1497'''',) -> α1498''''), α1136'' <: ((α1496'',) -> α1505'''')}›  <!<  ((α1488'',) -> α1491'')
//│ ╟── while constraining:  ‹∀ 3. {(α1506'''' -> α1504'''') where: α1138'' <: ((α1497'''',) -> α1498''''), α1136'' <: ((α1496'',) -> α1505'''')}›  <!<  α1487''
//│ ╟── while constraining:  (α1496'' -> ‹∀ 3. {(α1506'''' -> α1504'''') where: α1138'' <: ((α1497'''',) -> α1498''''), α1136'' <: ((α1496'',) -> α1505'''')}›)  <!<  ((α1486'',) -> α1487'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1486'',) -> α1487'')
//│ ╟── while constraining:  α1138''  <!<  ((α1486'',) -> α1487'')
//│ ╟── while constraining:  {(α1495'' -> α1493'') where: α1138'' <: ((α1486'',) -> α1487''), α1136'' <: ((α1475'',) -> α1494'')}  <!<  ((α1467'',) -> α1470'')
//│ ╟── while constraining:  ‹∀ 3. {(α1485'''' -> α1483'''') where: α1138'' <: ((α1476'''',) -> α1477''''), α1136'' <: ((α1475'',) -> α1484'''')}›  <!<  ((α1467'',) -> α1470'')
//│ ╟── while constraining:  ‹∀ 3. {(α1485'''' -> α1483'''') where: α1138'' <: ((α1476'''',) -> α1477''''), α1136'' <: ((α1475'',) -> α1484'''')}›  <!<  α1466''
//│ ╟── while constraining:  (α1475'' -> ‹∀ 3. {(α1485'''' -> α1483'''') where: α1138'' <: ((α1476'''',) -> α1477''''), α1136'' <: ((α1475'',) -> α1484'''')}›)  <!<  ((α1465'',) -> α1466'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1465'',) -> α1466'')
//│ ╟── while constraining:  α1138''  <!<  ((α1465'',) -> α1466'')
//│ ╟── while constraining:  {(α1474'' -> α1472'') where: α1138'' <: ((α1465'',) -> α1466''), α1136'' <: ((α1454'',) -> α1473'')}  <!<  ((α1446'',) -> α1449'')
//│ ╟── while constraining:  ‹∀ 3. {(α1464'''' -> α1462'''') where: α1138'' <: ((α1455'''',) -> α1456''''), α1136'' <: ((α1454'',) -> α1463'''')}›  <!<  ((α1446'',) -> α1449'')
//│ ╟── while constraining:  ‹∀ 3. {(α1464'''' -> α1462'''') where: α1138'' <: ((α1455'''',) -> α1456''''), α1136'' <: ((α1454'',) -> α1463'''')}›  <!<  α1445''
//│ ╟── while constraining:  (α1454'' -> ‹∀ 3. {(α1464'''' -> α1462'''') where: α1138'' <: ((α1455'''',) -> α1456''''), α1136'' <: ((α1454'',) -> α1463'''')}›)  <!<  ((α1444'',) -> α1445'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1444'',) -> α1445'')
//│ ╟── while constraining:  α1138''  <!<  ((α1444'',) -> α1445'')
//│ ╟── while constraining:  {(α1453'' -> α1451'') where: α1138'' <: ((α1444'',) -> α1445''), α1136'' <: ((α1433'',) -> α1452'')}  <!<  ((α1425'',) -> α1428'')
//│ ╟── while constraining:  ‹∀ 3. {(α1443'''' -> α1441'''') where: α1138'' <: ((α1434'''',) -> α1435''''), α1136'' <: ((α1433'',) -> α1442'''')}›  <!<  ((α1425'',) -> α1428'')
//│ ╟── while constraining:  ‹∀ 3. {(α1443'''' -> α1441'''') where: α1138'' <: ((α1434'''',) -> α1435''''), α1136'' <: ((α1433'',) -> α1442'''')}›  <!<  α1424''
//│ ╟── while constraining:  (α1433'' -> ‹∀ 3. {(α1443'''' -> α1441'''') where: α1138'' <: ((α1434'''',) -> α1435''''), α1136'' <: ((α1433'',) -> α1442'''')}›)  <!<  ((α1423'',) -> α1424'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1423'',) -> α1424'')
//│ ╟── while constraining:  α1138''  <!<  ((α1423'',) -> α1424'')
//│ ╟── while constraining:  {(α1432'' -> α1430'') where: α1138'' <: ((α1423'',) -> α1424''), α1136'' <: ((α1412'',) -> α1431'')}  <!<  ((α1404'',) -> α1407'')
//│ ╟── while constraining:  ‹∀ 3. {(α1422'''' -> α1420'''') where: α1138'' <: ((α1413'''',) -> α1414''''), α1136'' <: ((α1412'',) -> α1421'''')}›  <!<  ((α1404'',) -> α1407'')
//│ ╟── while constraining:  ‹∀ 3. {(α1422'''' -> α1420'''') where: α1138'' <: ((α1413'''',) -> α1414''''), α1136'' <: ((α1412'',) -> α1421'''')}›  <!<  α1403''
//│ ╟── while constraining:  (α1412'' -> ‹∀ 3. {(α1422'''' -> α1420'''') where: α1138'' <: ((α1413'''',) -> α1414''''), α1136'' <: ((α1412'',) -> α1421'''')}›)  <!<  ((α1402'',) -> α1403'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1402'',) -> α1403'')
//│ ╟── while constraining:  α1138''  <!<  ((α1402'',) -> α1403'')
//│ ╟── while constraining:  {(α1411'' -> α1409'') where: α1138'' <: ((α1402'',) -> α1403''), α1136'' <: ((α1391'',) -> α1410'')}  <!<  ((α1383'',) -> α1386'')
//│ ╟── while constraining:  ‹∀ 3. {(α1401'''' -> α1399'''') where: α1138'' <: ((α1392'''',) -> α1393''''), α1136'' <: ((α1391'',) -> α1400'''')}›  <!<  ((α1383'',) -> α1386'')
//│ ╟── while constraining:  ‹∀ 3. {(α1401'''' -> α1399'''') where: α1138'' <: ((α1392'''',) -> α1393''''), α1136'' <: ((α1391'',) -> α1400'''')}›  <!<  α1382''
//│ ╟── while constraining:  (α1391'' -> ‹∀ 3. {(α1401'''' -> α1399'''') where: α1138'' <: ((α1392'''',) -> α1393''''), α1136'' <: ((α1391'',) -> α1400'''')}›)  <!<  ((α1381'',) -> α1382'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1381'',) -> α1382'')
//│ ╟── while constraining:  α1138''  <!<  ((α1381'',) -> α1382'')
//│ ╟── while constraining:  {(α1390'' -> α1388'') where: α1138'' <: ((α1381'',) -> α1382''), α1136'' <: ((α1370'',) -> α1389'')}  <!<  ((α1362'',) -> α1365'')
//│ ╟── while constraining:  ‹∀ 3. {(α1380'''' -> α1378'''') where: α1138'' <: ((α1371'''',) -> α1372''''), α1136'' <: ((α1370'',) -> α1379'''')}›  <!<  ((α1362'',) -> α1365'')
//│ ╟── while constraining:  ‹∀ 3. {(α1380'''' -> α1378'''') where: α1138'' <: ((α1371'''',) -> α1372''''), α1136'' <: ((α1370'',) -> α1379'''')}›  <!<  α1361''
//│ ╟── while constraining:  (α1370'' -> ‹∀ 3. {(α1380'''' -> α1378'''') where: α1138'' <: ((α1371'''',) -> α1372''''), α1136'' <: ((α1370'',) -> α1379'''')}›)  <!<  ((α1360'',) -> α1361'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1360'',) -> α1361'')
//│ ╟── while constraining:  α1138''  <!<  ((α1360'',) -> α1361'')
//│ ╟── while constraining:  {(α1369'' -> α1367'') where: α1138'' <: ((α1360'',) -> α1361''), α1136'' <: ((α1349'',) -> α1368'')}  <!<  ((α1341'',) -> α1344'')
//│ ╟── while constraining:  ‹∀ 3. {(α1359'''' -> α1357'''') where: α1138'' <: ((α1350'''',) -> α1351''''), α1136'' <: ((α1349'',) -> α1358'''')}›  <!<  ((α1341'',) -> α1344'')
//│ ╟── while constraining:  ‹∀ 3. {(α1359'''' -> α1357'''') where: α1138'' <: ((α1350'''',) -> α1351''''), α1136'' <: ((α1349'',) -> α1358'''')}›  <!<  α1340''
//│ ╟── while constraining:  (α1349'' -> ‹∀ 3. {(α1359'''' -> α1357'''') where: α1138'' <: ((α1350'''',) -> α1351''''), α1136'' <: ((α1349'',) -> α1358'''')}›)  <!<  ((α1339'',) -> α1340'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1339'',) -> α1340'')
//│ ╟── while constraining:  α1138''  <!<  ((α1339'',) -> α1340'')
//│ ╟── while constraining:  {(α1348'' -> α1346'') where: α1138'' <: ((α1339'',) -> α1340''), α1136'' <: ((α1328'',) -> α1347'')}  <!<  ((α1320'',) -> α1323'')
//│ ╟── while constraining:  ‹∀ 3. {(α1338'''' -> α1336'''') where: α1138'' <: ((α1329'''',) -> α1330''''), α1136'' <: ((α1328'',) -> α1337'''')}›  <!<  ((α1320'',) -> α1323'')
//│ ╟── while constraining:  ‹∀ 3. {(α1338'''' -> α1336'''') where: α1138'' <: ((α1329'''',) -> α1330''''), α1136'' <: ((α1328'',) -> α1337'''')}›  <!<  α1319''
//│ ╟── while constraining:  (α1328'' -> ‹∀ 3. {(α1338'''' -> α1336'''') where: α1138'' <: ((α1329'''',) -> α1330''''), α1136'' <: ((α1328'',) -> α1337'''')}›)  <!<  ((α1318'',) -> α1319'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1318'',) -> α1319'')
//│ ╟── while constraining:  α1138''  <!<  ((α1318'',) -> α1319'')
//│ ╟── while constraining:  {(α1327'' -> α1325'') where: α1138'' <: ((α1318'',) -> α1319''), α1136'' <: ((α1307'',) -> α1326'')}  <!<  ((α1299'',) -> α1302'')
//│ ╟── while constraining:  ‹∀ 3. {(α1317'''' -> α1315'''') where: α1138'' <: ((α1308'''',) -> α1309''''), α1136'' <: ((α1307'',) -> α1316'''')}›  <!<  ((α1299'',) -> α1302'')
//│ ╟── while constraining:  ‹∀ 3. {(α1317'''' -> α1315'''') where: α1138'' <: ((α1308'''',) -> α1309''''), α1136'' <: ((α1307'',) -> α1316'''')}›  <!<  α1298''
//│ ╟── while constraining:  (α1307'' -> ‹∀ 3. {(α1317'''' -> α1315'''') where: α1138'' <: ((α1308'''',) -> α1309''''), α1136'' <: ((α1307'',) -> α1316'''')}›)  <!<  ((α1297'',) -> α1298'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1297'',) -> α1298'')
//│ ╟── while constraining:  α1138''  <!<  ((α1297'',) -> α1298'')
//│ ╟── while constraining:  {(α1306'' -> α1304'') where: α1138'' <: ((α1297'',) -> α1298''), α1136'' <: ((α1286'',) -> α1305'')}  <!<  ((α1278'',) -> α1281'')
//│ ╟── while constraining:  ‹∀ 3. {(α1296'''' -> α1294'''') where: α1138'' <: ((α1287'''',) -> α1288''''), α1136'' <: ((α1286'',) -> α1295'''')}›  <!<  ((α1278'',) -> α1281'')
//│ ╟── while constraining:  ‹∀ 3. {(α1296'''' -> α1294'''') where: α1138'' <: ((α1287'''',) -> α1288''''), α1136'' <: ((α1286'',) -> α1295'''')}›  <!<  α1277''
//│ ╟── while constraining:  (α1286'' -> ‹∀ 3. {(α1296'''' -> α1294'''') where: α1138'' <: ((α1287'''',) -> α1288''''), α1136'' <: ((α1286'',) -> α1295'''')}›)  <!<  ((α1276'',) -> α1277'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1276'',) -> α1277'')
//│ ╟── while constraining:  α1138''  <!<  ((α1276'',) -> α1277'')
//│ ╟── while constraining:  {(α1285'' -> α1283'') where: α1138'' <: ((α1276'',) -> α1277''), α1136'' <: ((α1265'',) -> α1284'')}  <!<  ((α1257'',) -> α1260'')
//│ ╟── while constraining:  ‹∀ 3. {(α1275'''' -> α1273'''') where: α1138'' <: ((α1266'''',) -> α1267''''), α1136'' <: ((α1265'',) -> α1274'''')}›  <!<  ((α1257'',) -> α1260'')
//│ ╟── while constraining:  ‹∀ 3. {(α1275'''' -> α1273'''') where: α1138'' <: ((α1266'''',) -> α1267''''), α1136'' <: ((α1265'',) -> α1274'''')}›  <!<  α1256''
//│ ╟── while constraining:  (α1265'' -> ‹∀ 3. {(α1275'''' -> α1273'''') where: α1138'' <: ((α1266'''',) -> α1267''''), α1136'' <: ((α1265'',) -> α1274'''')}›)  <!<  ((α1255'',) -> α1256'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1255'',) -> α1256'')
//│ ╟── while constraining:  α1138''  <!<  ((α1255'',) -> α1256'')
//│ ╟── while constraining:  {(α1264'' -> α1262'') where: α1138'' <: ((α1255'',) -> α1256''), α1136'' <: ((α1244'',) -> α1263'')}  <!<  ((α1236'',) -> α1239'')
//│ ╟── while constraining:  ‹∀ 3. {(α1254'''' -> α1252'''') where: α1138'' <: ((α1245'''',) -> α1246''''), α1136'' <: ((α1244'',) -> α1253'''')}›  <!<  ((α1236'',) -> α1239'')
//│ ╟── while constraining:  ‹∀ 3. {(α1254'''' -> α1252'''') where: α1138'' <: ((α1245'''',) -> α1246''''), α1136'' <: ((α1244'',) -> α1253'''')}›  <!<  α1235''
//│ ╟── while constraining:  (α1244'' -> ‹∀ 3. {(α1254'''' -> α1252'''') where: α1138'' <: ((α1245'''',) -> α1246''''), α1136'' <: ((α1244'',) -> α1253'''')}›)  <!<  ((α1234'',) -> α1235'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1234'',) -> α1235'')
//│ ╟── while constraining:  α1138''  <!<  ((α1234'',) -> α1235'')
//│ ╟── while constraining:  {(α1243'' -> α1241'') where: α1138'' <: ((α1234'',) -> α1235''), α1136'' <: ((α1223'',) -> α1242'')}  <!<  ((α1215'',) -> α1218'')
//│ ╟── while constraining:  ‹∀ 3. {(α1233'''' -> α1231'''') where: α1138'' <: ((α1224'''',) -> α1225''''), α1136'' <: ((α1223'',) -> α1232'''')}›  <!<  ((α1215'',) -> α1218'')
//│ ╟── while constraining:  ‹∀ 3. {(α1233'''' -> α1231'''') where: α1138'' <: ((α1224'''',) -> α1225''''), α1136'' <: ((α1223'',) -> α1232'''')}›  <!<  α1214''
//│ ╟── while constraining:  (α1223'' -> ‹∀ 3. {(α1233'''' -> α1231'''') where: α1138'' <: ((α1224'''',) -> α1225''''), α1136'' <: ((α1223'',) -> α1232'''')}›)  <!<  ((α1213'',) -> α1214'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1213'',) -> α1214'')
//│ ╟── while constraining:  α1138''  <!<  ((α1213'',) -> α1214'')
//│ ╟── while constraining:  {(α1222'' -> α1220'') where: α1138'' <: ((α1213'',) -> α1214''), α1136'' <: ((α1202'',) -> α1221'')}  <!<  ((α1194'',) -> α1197'')
//│ ╟── while constraining:  ‹∀ 3. {(α1212'''' -> α1210'''') where: α1138'' <: ((α1203'''',) -> α1204''''), α1136'' <: ((α1202'',) -> α1211'''')}›  <!<  ((α1194'',) -> α1197'')
//│ ╟── while constraining:  ‹∀ 3. {(α1212'''' -> α1210'''') where: α1138'' <: ((α1203'''',) -> α1204''''), α1136'' <: ((α1202'',) -> α1211'''')}›  <!<  α1193''
//│ ╟── while constraining:  (α1202'' -> ‹∀ 3. {(α1212'''' -> α1210'''') where: α1138'' <: ((α1203'''',) -> α1204''''), α1136'' <: ((α1202'',) -> α1211'''')}›)  <!<  ((α1192'',) -> α1193'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1192'',) -> α1193'')
//│ ╟── while constraining:  α1138''  <!<  ((α1192'',) -> α1193'')
//│ ╟── while constraining:  {(α1201'' -> α1199'') where: α1138'' <: ((α1192'',) -> α1193''), α1136'' <: ((α1181'',) -> α1200'')}  <!<  ((α1173'',) -> α1176'')
//│ ╟── while constraining:  ‹∀ 3. {(α1191'''' -> α1189'''') where: α1138'' <: ((α1182'''',) -> α1183''''), α1136'' <: ((α1181'',) -> α1190'''')}›  <!<  ((α1173'',) -> α1176'')
//│ ╟── while constraining:  ‹∀ 3. {(α1191'''' -> α1189'''') where: α1138'' <: ((α1182'''',) -> α1183''''), α1136'' <: ((α1181'',) -> α1190'''')}›  <!<  α1172''
//│ ╟── while constraining:  (α1181'' -> ‹∀ 3. {(α1191'''' -> α1189'''') where: α1138'' <: ((α1182'''',) -> α1183''''), α1136'' <: ((α1181'',) -> α1190'''')}›)  <!<  ((α1171'',) -> α1172'')
//│ ╟── while constraining:  ‹∀ 2. (α1139''' -> ‹∀ 3. {(α1149'''' -> α1147'''') where: α1138'' <: ((α1140'''',) -> α1141''''), α1136'' <: ((α1139''',) -> α1148'''')}›)›  <!<  ((α1171'',) -> α1172'')
//│ ╟── while constraining:  α1138''  <!<  ((α1171'',) -> α1172'')
//│ ╟── while constraining:  {(α1180'' -> α1178'') where: α1138'' <: ((α1171'',) -> α1172''), α1134'' <: ((α1160'',) -> α1179'')}  <!<  (List[‘b''] -> ‘a'')
//│ ╟── while constraining:  ‹∀ 3. {(α1170'''' -> α1168'''') where: α1138'' <: ((α1161'''',) -> α1162''''), α1134'' <: ((α1160'',) -> α1169'''')}›  <!<  (List[‘b''] -> ‘a'')
//│ ╟── while constraining:  (α1160'' -> ‹∀ 3. {(α1170'''' -> α1168'''') where: α1138'' <: ((α1161'''',) -> α1162''''), α1134'' <: ((α1160'',) -> α1169'''')}›)  <!<  (‘a'' -> (List[‘b''] -> ‘a''))
//│ ╟── while constraining:  ‹∀ 2. (α1137''' -> ‹∀ 3. {(α1159'''' -> α1157'''') where: α1138'' <: ((α1150'''',) -> α1151''''), α1134'' <: ((α1137''',) -> α1158'''')}›)›  <!<  (‘a'' -> (List[‘b''] -> ‘a''))
//│ ╟── while constraining:  (α1134'' -> ‹∀ 2. (α1137''' -> ‹∀ 3. {(α1159'''' -> α1157'''') where: α1138'' <: ((α1150'''',) -> α1151''''), α1134'' <: ((α1137''',) -> α1158'''')}›)›)  <!<  ((‘a'' -> (‘b'' -> ‘a'')) -> (‘a'' -> (List[‘b''] -> ‘a'')))
//│ ╟── while constraining:  ‹∀ 1. (α1108'' -> ‹∀ 2. (α1111''' -> ‹∀ 3. {(α1133'''' -> α1131'''') where: α1112'' <: ((α1124'''',) -> α1125''''), α1108'' <: ((α1111''',) -> α1132'''')}›)›)›  <!<  ((‘a'' -> (‘b'' -> ‘a'')) -> (‘a'' -> (List[‘b''] -> ‘a'')))
//│ ╟── while constraining:  fl1107''  <!<  ((‘a'' -> (‘b'' -> ‘a'')) -> (‘a'' -> (List[‘b''] -> ‘a'')))
//│ ╟── while constraining:  ‹∀ 0. fl950'›  <!<  ((‘a'' -> (‘b'' -> ‘a'')) -> (‘a'' -> (List[‘b''] -> ‘a'')))
//│ ╟── while constraining:  ‹∀ 0. ‹∀ 0. fl950'››  <!<  ((‘a'' -> (‘b'' -> ‘a'')) -> (‘a'' -> (List[‘b''] -> ‘a'')))
//│ ╟── while constraining:  ‹∀ 0. ‹∀ 0. fl950'››  <!<  ‹∀ 1. (('a942'' -> ('b943'' -> 'a942'')) -> ('a942'' -> (List['b943''] -> 'a942'')))›
//│ ╙── while constraining:  ‹∀ 0. ‹∀ 0. fl950'››  <!<  ‹∀ 0. ‹∀ 1. (('a942'' -> ('b943'' -> 'a942'')) -> ('a942'' -> (List['b943''] -> 'a942'')))››

def fold_left = fl2
//│ 'c -> (forall 'd. 'd -> (forall 'c, 'd, 'a, 'b. (List['b] -> ('a | 'd)
//│   where
//│     'c <: ('a | 'd) -> 'b -> 'a & 'd -> 'b -> 'a)))
//│   <:  fold_left:
//│ ('a -> 'b -> 'a) -> 'a -> List['b] -> 'a

// :d
// rec def fold_left f x l = match_list l x (fun head -> fun tail -> fold_left f (f x head) tail)

// ------------ polymorphic methods ------------

class Collection[a]: { l: List[a] }
  method Mem x = mem x this.l
  method Fold f x = fold_left f x this.l
//│ Defined class Collection[+a]
//│ Defined Collection.Mem: Collection[?] -> anything -> bool
//│ Defined Collection.Fold: Collection['a] -> (forall 'b. 'b -> (forall 'a, 'b, 'a0. ('a0 -> 'a0
//│   where
//│     'b <: 'a0 -> 'a -> 'a0)))

def coll_mem c x = c.Mem x
//│ coll_mem: 'a -> (forall 'a. ('a -> bool
//│   where
//│     'a <: Collection['a]))

// typo in the paper? it was `fun x -> fun y -> ...`
def simple_and_double c =
  let l1 = c.Fold (fun y -> fun x -> cons x y) nil in
  let l2 = c.Fold (fun y -> fun x -> cons ((x, x),) y) nil in
  (l1, l2)
//│ simple_and_double: Collection[?] -> (List[nothing], List[(nothing, nothing,)],)

simple_and_double (Collection{l = cons 1 nil})
//│ res: (List[nothing], List[(nothing, nothing,)],)

// ------------ subtyping & methods ------------

class Float
class Color
class Point: { x: Float; y: Float }
class ColorPoint: Point & { c: Color }
class Circle: { x: Float; y: Float; r: Float }
  method Distance: Point -> Float
//│ Defined class Float
//│ Defined class Color
//│ Defined class Point
//│ Defined class ColorPoint
//│ Defined class Circle
//│ Declared Circle.Distance: Circle -> Point -> Float

c = error : Circle
cp = error : ColorPoint
c.Distance cp
//│ c: Circle
//│ cp: ColorPoint
//│ res: Float
